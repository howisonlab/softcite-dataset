<!DOCTYPE article PUBLIC "-//NLM//DTD Journal Archiving and Interchange DTD v2.3 20070202//EN" "archivearticle.dtd">
<article xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:mml="http://www.w3.org/1998/Math/MathML" article-type="research-article"><?properties open_access?><front><journal-meta><journal-id journal-id-type="nlm-ta">Nucleic Acids Res</journal-id><journal-id journal-id-type="publisher-id">Nucleic Acids Research</journal-id><journal-title>Nucleic Acids Research</journal-title><issn pub-type="ppub">0305-1048</issn><issn pub-type="epub">1362-4962</issn><publisher><publisher-name>Oxford University Press</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="pmid">16936316</article-id><article-id pub-id-type="pmc">1636350</article-id><article-id pub-id-type="doi">10.1093/nar/gkl514</article-id><article-categories><subj-group subj-group-type="heading"><subject>Computational Biology</subject></subj-group></article-categories><title-group><article-title>MUMMALS: multiple sequence alignment improved by using hidden Markov models with local structural information</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Pei</surname><given-names>Jimin</given-names></name><xref rid="au1" ref-type="aff">1</xref><xref ref-type="corresp" rid="cor1">*</xref></contrib><contrib contrib-type="author"><name><surname>Grishin</surname><given-names>Nick V.</given-names></name><xref rid="au1" ref-type="aff">1</xref><xref rid="au2" ref-type="aff">2</xref></contrib><aff id="au1"><sup>1</sup><institution>Howard Hughes Medical Institute, University of Texas Southwestern Medical Center at Dallas</institution><addr-line>5323 Harry Hines Boulevard, Dallas, TX 75390-9050, USA</addr-line></aff><aff id="au2"><sup>2</sup><institution>Department of Biochemistry, University of Texas Southwestern Medical Center at Dallas</institution><addr-line>5323 Harry Hines Boulevard, Dallas, TX 75390-9050, USA</addr-line></aff></contrib-group><author-notes><corresp id="cor1"><sup>*</sup>To whom correspondence should be addressed. Tel: +1 214 645 5951; Fax: +1 214 645 5948; Email: <email>jpei@chop.swmed.edu</email></corresp></author-notes><!--For NAR: both ppub and collection dates generated for PMC processing 1/27/05 beck--><pub-date pub-type="collection"><month>9</month><year>2006</year></pub-date><pub-date pub-type="ppub"><month>9</month><year>2006</year></pub-date><pub-date pub-type="epub"><day>26</day><month>8</month><year>2006</year></pub-date><volume>34</volume><issue>16</issue><fpage>4364</fpage><lpage>4374</lpage><history><date date-type="received"><day>10</day><month>5</month><year>2006</year></date><date date-type="rev-recd"><day>26</day><month>6</month><year>2006</year></date><date date-type="accepted"><day>05</day><month>7</month><year>2006</year></date></history><copyright-statement>&#x000a9; 2006 The Author(s)</copyright-statement><copyright-year>2006</copyright-year><license license-type="openaccess"><p>This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc/2.0/uk/"/>) which permits unrestricted non-commercial use, distribution, and reproduction in any medium, provided the original work is properly cited.</p></license><abstract><p>We have developed MUMMALS, a program to construct multiple protein sequence alignment using probabilistic consistency. MUMMALS improves alignment quality by using pairwise alignment hidden Markov models (HMMs) with multiple match states that describe local structural information without exploiting explicit structure predictions. Parameters for such models have been estimated from a large library of structure-based alignments. We show that (i) on remote homologs, MUMMALS achieves statistically best accuracy among several leading aligners, such as ProbCons, MAFFT and MUSCLE, albeit the average improvement is small, in the order of several percent; (ii) a large collection (&#x0003e;10&#x02009;000) of automatically computed pairwise structure alignments of divergent protein domains is superior to smaller but carefully curated datasets for estimation of alignment parameters and performance tests; (iii) reference-independent evaluation of alignment quality using sequence alignment-dependent structure superpositions correlates well with reference-dependent evaluation that compares sequence-based alignments to structure-based reference alignments.</p></abstract></article-meta></front><body><sec><title>INTRODUCTION</title><p>Genome sequencing events have resulted in a rapid accumulation of protein sequences in public databases. As an essential tool in computational sequence analysis, sequence alignment is widely used in similarity searches, structure modeling, functional prediction and phylogenetic analysis (<xref ref-type="bibr" rid="b1">1</xref>&#x02013;<xref ref-type="bibr" rid="b5">5</xref>). Construction of a multiple sequence alignment aims at arranging residues with inferred common evolutionary origin in the same position for a set of sequences (<xref ref-type="bibr" rid="b6">6</xref>). Valuable information regarding position-specific residue usage and conservation can be extracted numerically from a multiple sequence alignment for various applications.</p><p>A classical method for constructing a multiple alignment aligns sequences progressively, as exemplified by the program ClustalW (<xref ref-type="bibr" rid="b7">7</xref>). Guided by a tree or a dendrogram that reflects the similarities among sequences, a progressive method makes a series of pairwise alignments for neighboring sequences or pre-aligned sequence groups. In this way, similar sequences are aligned prior to divergent sequences. However, progressive methods do not correct errors made in each pairwise alignment step. While similar sequences can be aligned with acceptable quality, progressive methods using general amino acid substitution matrices have limited success in obtaining high-quality alignments for divergent sequences (<xref ref-type="bibr" rid="b8">8</xref>).</p><p>Two main techniques are utilized to correct or minimize mistakes made in the progressive alignment process. One is iterative refinement of the alignment after the progressive steps (<xref ref-type="bibr" rid="b9">9</xref>&#x02013;<xref ref-type="bibr" rid="b11">11</xref>), e.g. by repeatedly dividing the aligned sequences into two groups and realigning the groups. The other technique, pioneered by the program T-COFFEE (<xref ref-type="bibr" rid="b12">12</xref>), makes a consistency measure among a set of pairwise sequence alignments before the progressive alignment steps. Such consistency-based scoring functions are superior to scoring functions based on general amino acid substitution matrices (<xref ref-type="bibr" rid="b12">12</xref>).</p><p>Improving pairwise sequence alignments is a key to provide high-quality starting materials for a consistency measure. The most common technique of constructing a protein pairwise alignment utilizes a substitution matrix of amino acids and a dynamic programming algorithm with gap penalties (<xref ref-type="bibr" rid="b13">13</xref>,<xref ref-type="bibr" rid="b14">14</xref>). Commonly used substitution matrices, such as the BLOSUM or PAM series matrices (<xref ref-type="bibr" rid="b15">15</xref>,<xref ref-type="bibr" rid="b16">16</xref>) are derived from large-scale analysis of relatively similar sequences. Other matrices have been derived from distant homologs based on structural alignments (<xref ref-type="bibr" rid="b17">17</xref>,<xref ref-type="bibr" rid="b18">18</xref>), and they are more suitable for aligning divergent sequences. Several studies have also shown that real or predicted local structural information can be used to improve pairwise alignment quality (<xref ref-type="bibr" rid="b19">19</xref>,<xref ref-type="bibr" rid="b20">20</xref>).</p><p>Another approach to constructing a pairwise alignment relies on a hidden Markov model (HMM) (<xref ref-type="bibr" rid="b21">21</xref>,<xref ref-type="bibr" rid="b22">22</xref>). In a simple HMM for global pairwise alignment, aligned residue pairs are modeled by a hidden match state, while insertions and deletions are modeled by two hidden states that generate unmatched residues in either of the two sequences (<xref ref-type="bibr" rid="b22">22</xref>). In addition to being able to find an optimal alignment, a pairwise alignment HMM can be used to estimate the posterior probability of any residue in the first sequence being aligned to any residue in the second sequence (<xref ref-type="bibr" rid="b22">22</xref>). These residue match probabilities have been used in ProbCons (<xref ref-type="bibr" rid="b23">23</xref>), a multiple sequence alignment program based on probabilistic consistency.</p><p>In this study, we aim to improve alignment quality by using: (i) more complex pairwise alignment HMMs that incorporate local structural information and (ii) better estimation of HMM parameters from a large set of structural alignments of divergent domain pairs from SCOP database (<xref ref-type="bibr" rid="b24">24</xref>). We show that these two techniques improve both pairwise alignments and probabilistic consistency-based multiple sequence alignments in reference-dependent and reference-independent tests.</p></sec><sec sec-type="materials|methods"><title>MATERIALS AND METHODS</title><sec><title>Training and testing datasets of SCOP domain pairs</title><p>Protein domain sequences and structures were obtained from the ASTRAL database (<xref ref-type="bibr" rid="b25">25</xref>) based on SCOP (<xref ref-type="bibr" rid="b24">24</xref>) version 1.69. We used the dataset consisting of representatives at the 40% sequence identity threshold (SCOP40). Domains from SCOP classes 1 to 4 [all alpha, all beta, alpha and beta (a/b), alpha and beta (a + b)] were selected. For each domain pair from the same superfamily of SCOP40, we computed a structural alignment using the program DaliLite (<xref ref-type="bibr" rid="b26">26</xref>). Alignments with coverage (fraction of aligned region to the length of the shorter sequence) less than 0.6 were removed. The remaining alignments were divided into four datasets corresponding to four sequence identity bins: &#x0003c;10, 10&#x02013;15, 15&#x02013;20 and 20&#x02013;40%. The method for calculating sequence identity that takes into account unaligned regions is described in Supplementary Data. To apply cross validation training and testing, we divided the domain pairs in each identity bin into four subsets at the SCOP fold level, so that no domains belonging to the same SCOP fold were shared by any two subsets. We estimated HMM parameters using alignments in three subsets and tested the programs on representative domain pairs of the remaining fourth subset. This procedure was performed four times corresponding to four ways of partitioning into training and testing datasets. To obtain representative alignments from a subset for testing, we randomly selected one domain pair from each SCOP fold in that subset. The number of domain pairs in each training dataset is larger than 10&#x02009;000 (Supplementary Table S1).</p></sec><sec><title>HMMs of pairwise sequence alignment</title><sec><title>Description of HMM structures</title><p>The standard pairwise alignment HMM has three hidden states emitting residues: a single match state &#x02018;M&#x02019; emitting residue pairs, an &#x02018;X&#x02019; state emitting residues in the first sequence and a &#x02018;Y&#x02019; state emitting residues in the second sequence (<xref ref-type="fig" rid="fig1">Figure 1b</xref>) (<xref ref-type="bibr" rid="b22">22</xref>). This model structure is named HMM_1_1_0 (the format of HMM names is described below and in <xref ref-type="table" rid="tbl1">Table 1</xref> and Supplementary Table S2).</p><p>The novelty of our complex HMMs is the introduction of more match states based on DaliLite structural alignments, which have aligned core blocks (structurally superimposable, shown in uppercase letters) and unaligned regions (structurally not superimposable, shown in lowercase letters) (<xref ref-type="fig" rid="fig1">Figure 1a</xref>). Residue pairs in aligned core blocks can be modeled by a match state (&#x02018;M&#x02019;). If the two unaligned regions in between two core blocks have different and non-zero lengths, they can be modeled using a different &#x02018;match&#x02019; state (&#x02018;U&#x02019;, for unaligned) (<xref ref-type="fig" rid="fig1">Figure 1c</xref>) and &#x02018;X&#x02019; or &#x02018;Y&#x02019; state. This is done by evenly splitting the unaligned residues in the sequence with the shorter unaligned region into two segments, placing them beside the two adjacent core blocks and separating them by a single stretch of gap symbols. In this way, transitions between &#x02018;X&#x02019; and &#x02018;Y&#x02019; do not occur. The residue pair emission probabilities of these artificially forced matches in unaligned regions (&#x02018;U&#x02019;) are expected to be different from those in the core blocks (&#x02018;M&#x02019;). This model (HMM_1_1_1) has two distinct match states: &#x02018;M&#x02019; and &#x02018;U&#x02019; (<xref ref-type="fig" rid="fig1">Figure 1a and c</xref>).</p><p>Furthermore, the residue matches in aligned core blocks can be modeled by several distinct match states based on the local structure information of the first sequence, for instance, secondary structure types (<xref ref-type="fig" rid="fig1">Figure 1d</xref>). Since residue usage and substitution patterns can vary for different local structural environments, the three match states according to secondary structure types have different sets of emission probabilities of 400 residue pairs. Secondary structure types were assigned using program DSSP (<xref ref-type="bibr" rid="b27">27</xref>) for SCOP domains. The model that incorporates three secondary structure types (&#x02018;H&#x02019;: helix, &#x02018;S&#x02019;: strand and &#x02018;C&#x02019;: coil) of the first sequence and unaligned match state (&#x02018;U&#x02019;) is named HMM_1_3_1 (<xref ref-type="fig" rid="fig1">Figure 1d</xref>). Similarly, multiple match states can be introduced based on several solvent accessibility categories, or a combination of solvent accessibility categories and secondary structure types. Solvent accessibilities of residue sidechains were calculated by program NACCESS (<xref ref-type="bibr" rid="b28">28</xref>). Three solvent accessibility categories were used based on our previous studies (<xref ref-type="bibr" rid="b29">29</xref>). The model that incorporates three solvent accessibility categories and unaligned match state is named HMM_3_1_1. Combination of three solvent accessibility categories and three secondary structure types results in nine classes of match states for the core blocks (model HMM_3_3_1).</p><p>Each HMM model is named in the format &#x02018;HMM_solv_ss_u&#x02019;, where &#x02018;solv&#x02019; is the number of solvent accessibility categories, &#x02018;ss&#x02019; is the number of secondary structure types, and &#x02018;u&#x02019; is 1 if unaligned regions are modeled with an additional match state. Some statistics about the five HMMs, such as the number of hidden states, the number of parameters and time complexity, are listed in Supplementary Table S2.</p></sec><sec><title>Estimation of HMM parameters</title><p>We used a supervised learning method to estimate HMM parameters from DaliLite structural alignments, since hidden state paths are known for them (<xref ref-type="fig" rid="fig1">Figure 1a</xref>) (<xref ref-type="bibr" rid="b22">22</xref>). These parameters are: transition probabilities among hidden states [match state(s), &#x02018;X&#x02019; state, &#x02018;Y&#x02019; state, begin state and end state], emission probabilities of residue pairs for each match state, and residue emission probabilities for &#x02018;X&#x02019; state and &#x02018;Y&#x02019; state (<xref ref-type="bibr" rid="b22">22</xref>). Given a training dataset, we assign a weight to each sequence. If a sequence occurs <italic>N</italic> times in the dataset, its weight is 1/<italic>N</italic><sup>1/2</sup>. For large SCOP superfamilies, one sequence is involved in a large number of pairwise alignments. Sequence weighting aims to reduce the bias introduced by large superfamilies and folds. The parameters were estimated from weighted counts of observed transitions and emissions in DaliLite alignments (<xref ref-type="bibr" rid="b22">22</xref>).</p><p>The supervised learning method was also used to estimate model parameters from pairwise alignments in BAliBASE2.0 (<xref ref-type="bibr" rid="b30">30</xref>), from which ProbCons derived its HMM parameters with a different approach (<xref ref-type="bibr" rid="b23">23</xref>). These alignments also have core blocks assigned (uppercase letters). However, local structural information is not available for every sequence. Therefore, from BAliBASE2.0 pairwise alignments, we derived parameters only for models HMM_1_1_0 and HMM_1_1_1 that do not have local structure-dependent match states.</p></sec><sec><title>Pairwise alignment with optimal match probabilities</title><p>We apply standard forward and backward algorithms (<xref ref-type="bibr" rid="b22">22</xref>) to align two sequences <italic>x</italic> = (<italic>x</italic><sub>1</sub>, <italic>x</italic><sub>2</sub>,&#x02009;&#x02026;&#x02009;,&#x02009;<italic>x<sub>m</sub></italic>) and <italic>y</italic> = (<italic>y</italic><sub>1</sub>, <italic>y</italic><sub>2</sub>,&#x02009;&#x02026;&#x02009;,&#x02009;<italic>y<sub>n</sub></italic>) (<italic>m</italic> and <italic>n</italic> are the lengths of <italic>x</italic> and <italic>y</italic>). Given a pairwise HMM, the forward algorithm applies a dynamic programming technique to calculate the probability of observing two subsequences (<italic>x</italic><sub>1</sub>,&#x02009;&#x02026;&#x02009;,&#x02009;<italic>x<sub>i</sub></italic>) and (<italic>y</italic><sub>1</sub>,&#x02009;&#x02026;&#x02009;,&#x02009;<italic>y<sub>j</sub></italic>) generated by an HMM, with the last position of the two subsequences being in a certain hidden state. The formula of forward probability is:
<disp-formula id="e1"><label>1</label><mml:math id="M1"><mml:mrow><mml:msub><mml:mtext>F</mml:mtext><mml:mi>K</mml:mi></mml:msub><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mtext>P</mml:mtext><mml:mo>[</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mn>&#x02026;</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mn>&#x02026;</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>&#x003c0;</mml:mi><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mi>K</mml:mi><mml:mo>]</mml:mo></mml:mrow></mml:math></disp-formula>
Here, &#x003c0;(<italic>i, j</italic>) is the hidden state of the last position. <italic>K</italic> is one of the hidden states. For example, for model HMM_1_3_1, <italic>K</italic> is from the set {&#x02018;H&#x02019;, &#x02018;S&#x02019;, &#x02018;C&#x02019;, &#x02018;U&#x02019;, &#x02018;X&#x02019;, &#x02018;Y&#x02019;} (<xref ref-type="fig" rid="fig1">Figure 1d</xref>).</p><p>The backward algorithm calculates the probability of generating two subsequences (<italic>x<sub>i</sub></italic><sub>+1</sub>,&#x02009;&#x02026;&#x02009;,&#x02009;<italic>x<sub>m</sub></italic>) and (<italic>y<sub>j</sub></italic><sub>+1</sub>,&#x02009;&#x02026;&#x02009;,&#x02009;<italic>y<sub>n</sub></italic>),given the condition that the previous position of the two subsequences is of a certain type of hidden state. The formula of the backward probability is:
<disp-formula id="e2"><label>2</label><mml:math id="M2"><mml:mrow><mml:msub><mml:mtext>B</mml:mtext><mml:mi>K</mml:mi></mml:msub><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mtext>P</mml:mtext><mml:mo>[</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mn>&#x02026;</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mn>&#x02026;</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mrow><mml:mo>&#x02223;</mml:mo><mml:mi>&#x003c0;</mml:mi></mml:mrow><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mi>K</mml:mi><mml:mo>]</mml:mo></mml:mrow></mml:math></disp-formula></p><p>The following formula can be derived (<xref ref-type="bibr" rid="b22">22</xref>):
<disp-formula id="e3"><label>3</label><mml:math id="M3"><mml:mrow><mml:mtext>P</mml:mtext><mml:mo>[</mml:mo><mml:mi>&#x003c0;</mml:mi><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mtext>K</mml:mtext><mml:mrow><mml:mo>&#x02223;</mml:mo><mml:mi>x</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>]</mml:mo><mml:msub><mml:mrow><mml:mo>=</mml:mo><mml:mtext>F</mml:mtext></mml:mrow><mml:mi>K</mml:mi></mml:msub><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>)</mml:mo><mml:mo>*</mml:mo><mml:msub><mml:mtext>B</mml:mtext><mml:mi>K</mml:mi></mml:msub><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>)</mml:mo><mml:mo>/</mml:mo><mml:mtext>P</mml:mtext><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>)</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>
where P[&#x003c0;(<italic>i, j</italic>) = K &#x02223; <italic>x, y</italic>] is the probability of aligned residue pair (<italic>x<sub>i</sub>, y<sub>j</sub></italic>) being generated by a certain hidden match state K given the two full-length sequences <italic>x</italic> and <italic>y</italic>, and P(<italic>x, y</italic>) is the full probability of observing sequences <italic>x</italic> and <italic>y</italic> given the model. P(<italic>x, y</italic>) can be calculated by forward algorithm or backward algorithm (<xref ref-type="bibr" rid="b22">22</xref>).</p><p>The posterior probability (<xref ref-type="bibr" rid="b22">22</xref>,<xref ref-type="bibr" rid="b31">31</xref>) of residue <italic>i</italic> in sequence <italic>x</italic> being aligned to residue <italic>j</italic> in sequence <italic>y</italic> (match probability) can be calculated as:
<disp-formula id="e4"><label>4</label><mml:math id="M4"><mml:mrow><mml:mtext>P</mml:mtext><mml:mo>(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mtext>&#x000a0;aligned to&#x000a0;</mml:mtext><mml:msub><mml:mi>y</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:munder><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:msub><mml:mi>K</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mrow></mml:munder></mml:mstyle><mml:mrow><mml:mtext>P</mml:mtext><mml:mo>[</mml:mo><mml:mi>&#x003c0;</mml:mi><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mi>K</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo>&#x02223;</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula>
Here, <italic>K</italic><sub>m</sub> belongs to a set of match states. For model HMM_1_3_1, <italic>K</italic><sub>m</sub> is from the set {&#x02018;H&#x02019;, &#x02018;S&#x02019;, &#x02018;C&#x02019;, &#x02018;U&#x02019;}.</p><p>We then find the alignment path that maximizes the sum of match probabilities of residue pairs in the alignment path using dynamic programming with zero gap penalties. It has been shown that this technique can give better alignment quality than Viterbi algorithm (<xref ref-type="bibr" rid="b23">23</xref>).</p></sec></sec><sec><title>Multiple sequence alignment procedure</title><p>We have developed a progressive multiple sequence alignment program implementing our HMMs (MUMMALS, standing for <underline>MU</underline>ltiple alignment with <underline>M</underline>ultiple <underline>MA</underline>tch state models of <underline>L</underline>ocal <underline>S</underline>tructure). It applies a probabilistic consistency scoring function similar to the one in ProbCons (<xref ref-type="bibr" rid="b23">23</xref>). First, a tree is built-in a fast way based on a <italic>k</italic>-mer count method (<xref ref-type="bibr" rid="b10">10</xref>). An initial alignment is built progressively guided by the tree with a simple sum-of-pairs scoring function. A second tree is then built with a UPGMA method based on sequence identities calculated from the initial alignment. We then apply the probabilistic consistency strategy as described by Do <italic>et al.</italic> (<xref ref-type="bibr" rid="b23">23</xref>). For each sequence pair, we calculate the match probabilities of residue pairs using one of the HMMs. These probability matrices are subject to consistency measure, which involves multiplications of the matrices (<xref ref-type="bibr" rid="b23">23</xref>). Finally, MUMMALS progressively aligns the sequences guided by the second tree using the consistency-based scoring function.</p><p>To properly balance alignment speed and accuracy, we have also applied a two-stage alignment strategy similar to the one used in our program PCMA (<xref ref-type="bibr" rid="b32">32</xref>). In the first stage, highly similar sequences are progressively aligned in a fast way without consistency scoring. The scoring function in this stage is a weighted sum-of-pairs measure of BLOSUM62 scores (<xref ref-type="bibr" rid="b16">16</xref>). If two neighboring groups on a tree have an average sequence identity higher than a certain threshold, they are aligned in this fast way. The result of the first stage is a set of pre-aligned groups that are relatively divergent from each other. In the second alignment stage, one representative sequence is selected from each pre-aligned group, and these representative sequences are subject to the more time-consuming probabilistic consistency measure. Then the representatives are aligned progressively according to the consistency-based scoring function. Finally, the pre-aligned groups obtained in the first stage are merged according to the alignment of the representatives to obtain the final alignment of all sequences.</p></sec><sec><title>Performance assessment of multiple sequence alignment programs</title><p>To test multiple sequence alignment programs, we used the same representative SCOP pairs selected for pairwise alignment tests (Supplementary Table S1). For each domain, we added up to 24 homologs, which were obtained from PSI-BLAST searches (<xref ref-type="bibr" rid="b1">1</xref>) with five iterations and an <italic>E</italic>-value cut-off of 0.0001. We removed highly similar sequences (&#x0003e;97% identity) and sequence fragments (coverage less than half of the query) before randomly selecting up to 24 homologs. This procedure is similar to the one used to build the PREFAB database (<xref ref-type="bibr" rid="b10">10</xref>). Similar to pairwise alignment tests, the 4-fold cross validation approach is applied to the tests of MUMMALS.</p><p>Two large testing datasets compiled by other researchers were used as well. One is the SABmark database (version 1.65) (<xref ref-type="bibr" rid="b33">33</xref>), which is based on homologous SCOP domains, and the other is PREFAB database (version 4) (<xref ref-type="bibr" rid="b10">10</xref>), which is based on structural alignments and homologous sequences from database searches. Alignment quality scores (<italic>Q</italic>-scores) were calculated using the built-in programs in SABmark and PREFAB packages. The <italic>Q</italic>-score is the fraction of the number of correctly aligned residue pairs in the test alignment to the total number of aligned residue pairs in the reference alignment. Additional series of smaller datasets constructed by MAFFT authors (<xref ref-type="bibr" rid="b11">11</xref>) were 55 HOMSTRAD (<xref ref-type="bibr" rid="b34">34</xref>) structural alignments with various numbers of close homologs added (&#x02018;HOM + X&#x02019;, &#x02018;X&#x02019; is the number of close homologs added and is 0, 20, 50 or 100). To obtain more balanced datasets from &#x02018;HOM + 100&#x02019;, we used BLASTCLUST to cluster sequences in any &#x02018;HOM + 100&#x02019; alignment at 50 or 60% identity level, and selected up to two homologs in each sequence cluster. The resulting datasets are called &#x02018;HOM + 100_bcl50&#x02019; and &#x02018;HOM + 100_bcl60&#x02019;. We also tested programs on 218 BAliBASE3.0 (<xref ref-type="bibr" rid="b35">35</xref>) alignments with full-length sequences. The column scores (the fraction of entirely correct columns) were reported in addition to <italic>Q</italic>-scores for BAliBASE3.0. Wilcoxon signed-ranks tests were performed to calculate statistical significance of comparisons between alignment programs, which include ProbCons (version 1.10) (<xref ref-type="bibr" rid="b23">23</xref>), MAFFT (version 5.667) (<xref ref-type="bibr" rid="b11">11</xref>) with several options, MUSCLE (version 3.52) (<xref ref-type="bibr" rid="b10">10</xref>) and ClustalW (version 1.83) (<xref ref-type="bibr" rid="b7">7</xref>).</p><p>In addition to <italic>Q</italic>-score, we utilized a reference-independent assessment of alignment quality from a structural modeling perspective. Given a test sequence alignment of two SCOP domains with known structures, corresponding C&#x003b1; atoms in aligned residue pairs were used as equivalent points for structural superposition to minimize the root mean square distance (RMSD). The structural similarity scores were calculated based on this forced superposition of the aligned residue pairs. The following scores were used: DALI <italic>Z</italic>-score (<xref ref-type="bibr" rid="b36">36</xref>), GDT score (<xref ref-type="bibr" rid="b37">37</xref>), TM-score (<xref ref-type="bibr" rid="b38">38</xref>), 3D-score (<xref ref-type="bibr" rid="b39">39</xref>) and two LiveBench contact scores (<xref ref-type="bibr" rid="b39">39</xref>) (see Supplementary Data for the equations of 3D-score and LiveBench contact scores). An alignment with better quality should have a higher similarity of the two structures superimposed in a sequence-dependent way described above, and thus have a larger structural score. Two reference-independent sequence similarity scores were also calculated for aligned residue pairs in a test alignment: sequence identity and average BLOSUM62 scores (<xref ref-type="bibr" rid="b16">16</xref>). Additionally, each of the scores was rescaled to take into account a random model (the reversed alignment), self-comparisons and alignment coverage (see Supplementary Data for details). Such rescaling places each score between 0 (random match) and 1 (self-match) and makes different scoring schemes more comparable to each other.</p></sec><sec><title>Availability</title><p>The MUMMALS multiple alignment web server is at: <ext-link ext-link-type="uri" xlink:href="http://prodata.swmed.edu/mummals/"/>, with the source code of MUMMALS available for download.</p></sec></sec><sec><title>RESULTS</title><sec><title>Complex HMMs with local structural information improve pairwise alignments</title><p>Applying a cross validation approach, we tested our pairwise alignment HMMs on representative domain pairs from the ASTRAL SCOP40 dataset (<xref ref-type="table" rid="tbl1">Table 1</xref> and Supplementary Table S3). Model HMM_1_1_0 represents the simplest model with a single match state (<xref ref-type="fig" rid="fig1">Figure 1a</xref>). It can serve as a control for more complex models, including HMM_1_1_1 that assigns residue pairs in unaligned regions to a different match state, HMM_1_3_1 that captures secondary structure information, HMM_3_1_1 that captures solvent accessibility information, and HMM_3_3_1 that has both types of local structural information (see Materials and Methods).</p><p>Several conclusions can be drawn from <xref ref-type="table" rid="tbl1">Table 1</xref> and Supplementary Table S3. (i) For each testing dataset, the best performance is usually achieved with parameters estimated on the training dataset with the same identity range (Supplementary Table S3). For example, models trained on alignments with the highest identity range (20&#x02013;40%) exhibit best performance on testing alignments in that range. Thus residue substitution and insertion/deletion statistics are different for sequence pairs with different degrees of similarity, in agreement with other reports (<xref ref-type="bibr" rid="b16">16</xref>,<xref ref-type="bibr" rid="b17">17</xref>). Although models trained on pairs with the lowest identity range can perform slightly better (&#x0223c;2%) on representatives in that range, they perform much worse on alignments with the highest identity range (nearly 10% decrease as compared to models trained on pairs with the highest identity range). (ii) More complex HMMs improve alignment quality. For example, HMM_1_3_1 performs better than HMM_1_1_1 in almost every case. HMM_1_3_1 performs almost equally well to HMM_3_3_1. (iii) Our models trained on pairs with 20&#x02013;40% identity range perform better than several other aligners, such as ProbCons (<xref ref-type="bibr" rid="b23">23</xref>), MAFFT (<xref ref-type="bibr" rid="b11">11</xref>) with several option, MUSCLE (<xref ref-type="bibr" rid="b10">10</xref>) and ClustalW (<xref ref-type="bibr" rid="b7">7</xref>) on any testing dataset. Although the simplest model HMM_1_1_0 has the same model structure as the one used in ProbCons, it gives &#x0223c;3&#x02013;4% increase over ProbCons for every testing dataset. The best models HMM_1_3_1 and HMM_3_3_1 give 4&#x02013;5% increase over ProbCons. (iv) When trained on BAliBASE2.0, HMM_1_1_0 and HMM_1_1_1 exhibit inferior performance compared to the same models trained on SCOP domain pairs with identity above 20%, suggesting that SCOP domain pairs with above 20% identity is a better training dataset than BAliBASE2.0. The two models (especially HMM_1_1_1) trained on BAliBASE2.0 nevertheless give slightly better performance than ProbCons, which was also trained on BAliBASE2.0 but with a different training method (unsupervised learning) (<xref ref-type="bibr" rid="b23">23</xref>).</p><p>To further compare the performance of our HMMs and the one used in ProbCons, we tested sequence pairs from BAliBASE2.0, on which the HMM in ProbCons was trained (Supplementary Table S4). BAliBASE2.0 is a manually curated database for testing multiple alignment programs. It contains core blocks (uppercase letters) with good quality and a large fraction of lowercase letter regions where high alignment quality is not guaranteed. HMM_1_1_0 and HMM_1_1_1 trained on DaliLite alignments of SCOP domain pairs with above 20% identity show better results than these two models trained on BAliBASE2.0 as well as ProbCons, suggesting that the structural alignments of relatively divergent SCOP domains form a better training set than BAliBASE2.0. HMM_1_3_1 trained on the same SCOP domain pairs gives the best BAliBASE2.0 results (Supplementary Table S4), confirming that a more complex model with multiple match states of secondary structures improves alignment quality.</p></sec><sec><title>MUMMALS and multiple sequence alignment tests</title><p>We implemented our HMM models in a multiple sequence alignment program based on probabilistic consistency. Our program is named MUMMALS, standing for <underline>MU</underline>ltiple alignment with <underline>M</underline>ultiple <underline>MA</underline>tch state models of <underline>L</underline>ocal <underline>S</underline>tructure. MUMMALS was compared to several other programs, such as ProbCons (<xref ref-type="bibr" rid="b23">23</xref>), MAFFT (<xref ref-type="bibr" rid="b11">11</xref>), MUSCLE (<xref ref-type="bibr" rid="b10">10</xref>) and ClustalW (<xref ref-type="bibr" rid="b7">7</xref>). We assembled testing datasets of multiple sequences by adding homologs to pairwise alignments of SCOP domain pairs (see Materials and Methods). For three testing datasets with identity ranges below 20%, MUMMALS shows &#x0223c;3&#x02013;4% increase of average <italic>Q</italic>-score over ProbCons when the best-performing HMMs are selected (HMM_1_3_1 and HMM_3_3_1) (<xref ref-type="table" rid="tbl2">Table 2</xref>). For the dataset with identity range above 20%, the improvement is less prominent (&#x0223c;1%), although still statistically significant (<italic>P</italic> &#x0003c; 0.005). Among the other programs tested (ProbCons, several options of MAFFT, MUSCLE and ClustalW), MAFFT with options [lg]insi usually gives the best performance. Our program still outperforms any MAFFT option by &#x0223c;2% for the three datasets with identity ranges below 20%.
</p><p>The other two large datasets we have used for testing are PREFAB version 4 (PREFAB4) (<xref ref-type="bibr" rid="b10">10</xref>) and SABmark version 1.65 (<xref ref-type="bibr" rid="b33">33</xref>). PREFAB4 consists of 1682 alignments based on the consensus of two structural alignment programs SOFI (<xref ref-type="bibr" rid="b40">40</xref>) and CE (<xref ref-type="bibr" rid="b41">41</xref>), with up to 24 homologous sequences added from database searches. SABmark database has two alignment sets. The &#x02018;twilight zone&#x02019; set contains SCOP (version 1.65) domain pairs with very low-to-low similarity and the &#x02018;superfamily&#x02019; set contains SCOP domains with low to intermediate similarity. The reference alignments in SABmark were also derived from the consensus of SOFI and CE. The comparison of MUMMALS with the other programs on PREFAB4 and SABmark shows similar trends as seen in datasets assembled by us. MUMMALS with the best-performing models (HMM_1_3_1 and HMM_3_3_1) gives the highest average <italic>Q</italic>-scores, with &#x0223c;2&#x02013;4% increase over ProbCons and &#x0223c;1% increase over the best of the MAFFT series (<xref ref-type="table" rid="tbl2">Table 2</xref>).</p><p>We also tested these programs on datasets of 55 HOMSTRAD structural alignments (<xref ref-type="bibr" rid="b11">11</xref>,<xref ref-type="bibr" rid="b34">34</xref>) with various numbers of homologs added (Supplementary Table S5). MUMMALS performs better than other programs for testing datasets &#x02018;HOM + 0&#x02019;, &#x02018;HOM + 20&#x02019; and &#x02018;HOM + 50&#x02019;. The results of MUMMALS on &#x02018;HOM + 100&#x02019; are inferior to those on &#x02018;HOM + 50&#x02019;, which is in contrast to MAFFT that shows consistent increase of accuracy when more homologs are added. We reason that such a problem of MUMMALS is due to excessive number of close homologs in some sequence subgroups in &#x02018;HOM + 100&#x02019; test cases, since our consistency measure does not take into account similarities among the testing sequences. To test this hypothesis, we removed closely related sequences in &#x02018;HOM + 100&#x02019; alignment at 50 or 60% identity level (datasets &#x02018;HOM + 100_bcl50&#x02019; and &#x02018;HOM + 100_bcl60&#x02019;). The remaining sequences are more balanced in terms of similarities among them. We indeed obtained the best MUMMALS performance after removing closely related sequences (Supplementary Table S5). A similar degrading effect of closely related sequences is observed for ProbCons, which is also based on probabilistic consistency.</p><p>Recently, BAliBASE3.0 multiple alignment benchmark has been released (<xref ref-type="bibr" rid="b35">35</xref>). We tested the programs on 218 BAliBASE3.0 alignments with full-length sequences. These alignments represent difficult cases since N- or C-terminal non-homologous regions are included for some sequences. The average <italic>Q</italic>-scores and column scores (the fraction of entirely correctly columns) in manually defined core blocks are reported in <xref ref-type="table" rid="tbl2">Table 2</xref>. For <italic>Q</italic>-score measurement of alignment quality, the Wilcoxon signed rank tests show that MUMMALS with best-performing models (HMM_3_3_1 or HMM_1_3_1) is statistically better than other programs, albeit MUMMALS does not have the highest average <italic>Q</italic>-score. For column score measurement of alignment quality, MUMMALS with HMM_3_3_1 or HMM_1_3_1 has a lower average column score than MAFFT-[le]insi and ProbCons, but the difference between them is not statistically significant. In fact MUMMALS with HMM_3_3_1 outperforms MAFFT-linsi (having the best average scores) in 106 cases while MAFFT-linsi performs better in 67 cases, measured by column score.</p><p>We found that the major cause of lower average column score of MUMMALS is due to a few alignments that MUMMALS gives considerably lower scores as compared to MAFFT-linsi (10 alignments with a score difference larger than 0.5). Manual inspections of these alignments revealed some interesting scenarios. In some cases, the low scores of MUMMALS are due to wrong alignment of a few divergent sequences, some of which have long extensions at the ends. Column score is very sensitive in such situations, since a low score is produced even if only one sequence is incorrectly aligned in many places. MAFFT alignments with local options ([le]insi) indeed show advantage in these situations (<xref ref-type="bibr" rid="b11">11</xref>). In several other cases, MUMMALS produces structurally meaningful alignments that are scored very low since they are not consistent with the reference alignments (Supplementary Figure S1). One example is testing case BB40037, for which the reference alignment aligns the &#x02018;fer2&#x02019; domain [2Fe-2S iron sulfur cluster binding domain, named by Conserved Domain Database (<xref ref-type="bibr" rid="b42">42</xref>)] that is present in every sequence. Inspection of the sequences revealed two groups of sequences with different domain architectures in BB40037 (Supplementary Figure S1a). One group contains three domains in the order of &#x02018;fer2&#x02019;, &#x02018;FAD_binding_6&#x02019; (oxidoreductase FAD-binding domain) and &#x02018;NAD_binding_1&#x02019; (oxidoreductase NAD-binding domain). The other group contains the same three domains, but in the order of &#x02018;FAD_binding_6&#x02019;, &#x02018;NAD_binding_1&#x02019; and &#x02018;fer2&#x02019;. MUMMALS aligns &#x02018;FAD_binding_6&#x02019; and &#x02018;NAD_binding_1&#x02019; for the two groups and thus misaligned the &#x02018;fer2&#x02019; domain. Since the reference-dependent evaluation is based on &#x02018;fer2&#x02019; domain, MUMMALS alignment gets a column score of zero. Another evaluation problem is caused by domain duplication or repeats, as exemplified by test case BB40040. Most of BB40040 sequences have a single domain of carbonic anhydrase. However, the sequence &#x02018;CAH_DUNSA&#x02019; has two such domains (Supplementary Figure S1b). The reference alignment aligns the first domain of &#x02018;CAH_DUNSA&#x02019; to other sequences while MUMMALS aligns most of the second domain to other sequences, resulting in a low column score.</p></sec><sec><title>Secondary structure prediction and alignment quality</title><p>Model HMM_1_3_1 has hidden secondary structure-dependent match states that are used in alignment construction. However, secondary structure predictions are not explicitly generated and remain &#x02018;hidden&#x02019; in the alignment process. A posterior decoding technique can be applied to this model to output explicit secondary structure predictions (see Supplementary Data for details). The prediction accuracy is &#x0223c;60% on representative SCOP domains (Supplementary Table S6). This prediction accuracy is lower than many advanced methods, such as PSI-PRED (<xref ref-type="bibr" rid="b43">43</xref>), which use homologs from database searches to enhance the secondary structure signal of a single sequence. Our HMM-based prediction of secondary structure corresponds to a single sequence predictor, since position-specific information from multiple homologs is not used. The prediction accuracy of model HMM_1_3_1 is comparable to other methods that generate predictions based on a single sequence (<xref ref-type="bibr" rid="b44">44</xref>).</p><p>If secondary structure information is known for one of the aligned sequences, model HMM_1_3_1 can be modified to restrict the hidden state path to follow the experimental secondary structure (see Supplementary Data). Using real secondary structural information in MUMMALS with model HMM_1_3_1, we were able to obtain an average <italic>Q</italic>-score increase of 3% on SABmark datasets (Supplementary Table S8). Such a result suggests that one limitation of MUMMALS is the low accuracy of the implicit secondary structure prediction. Further improvement of alignment quality should be possible with more accurate secondary structure predictions that explore database homologs.</p></sec><sec><title>Evaluation of programs with reference-independent scores</title><p>All previously described tests are based on comparison with reference alignments that are treated as &#x02018;gold standards&#x02019;. It is unclear how the quality of reference &#x02018;gold&#x02019; alignments influences the ranking of alignment programs (<xref ref-type="bibr" rid="b45">45</xref>). Several examples from BAliBASE3.0 show some problems with reference-dependent evaluation. Since the structures of all domains in our testing datasets are known, we can evaluate the quality of a test alignment using reference-independent scores that reflect the similarity between two structures after they are superimposed according to aligned residues in the test alignment. The structural scores we have used are: DALI <italic>Z</italic>-score, TM-score, GDT-TS score, 3D-score and two LiveBench contact scores. From <xref ref-type="table" rid="tbl3">Table 3</xref>, it is clear that MUMMALS with the best-performing models (HMM_1_3_1 and HMM_3_3_1) produces higher average reference-independent structural scores than other programs for divergent domain pairs (identity below 20%), suggesting that our HMM models produce potentially more useful alignments in terms of structure modeling. Interestingly, MUMMALS does not produce the highest reference-independent sequence-based similarity scores (sequence identity and BLOSUM62 scores of aligned residue pairs). This result suggests that minimization of these sequence similarity measures alone does not lead to better alignment quality for divergent sequences. Our experiments with reference-independent evaluation shows good correlation with reference-dependent results described above, thus rendering a &#x02018;gold standard&#x02019; reference unnecessary for alignment evaluation.
</p></sec><sec><title>Pairwise comparisons of multiple sequence aligners</title><p>MUMMALS shows improvement over MAFFT and ProbCons by only a few percent in terms of average alignment quality scores on various testing datasets. Although this improvement is statistically significant and does not depend on the testing dataset (assembled by us, or by other researchers) or alignment quality measure (reference-dependent <italic>Q</italic>-score, or reference-independent DALI <italic>Z</italic>-score, TM-score, GDT-TS, etc), it is not clear what these average scores actually represent. To gain more understanding, we directly compared alignment scores of different programs for individual domain pairs. <xref ref-type="table" rid="tbl4">Table 4</xref> shows the number of alignments where one program performs better than another program by 10% or more (measured by <italic>Q</italic>-score or normalized TM-score) for 1207 divergent SCOP40 pairs with added homologs (sequence identity &#x0003c;20%). The numbers for such differences among MUMMALS family of programs with five different HMMs are relatively small, suggesting that MUMMALS with different HMMs generates alignments not that different from each other. The differences between MUMMALS and other programs are significantly larger. For example, MUMMALS with HMM_3_3_1 has a large <italic>Q</italic>-score increase (&#x02265;10%) over ProbCons on 201 alignments, while ProbCons is better by 10% or more on 62 alignments. For MUMMALS with HMM_3_3_1 and MAFFT-ginsi, these numbers are 199 and 117, respectively. Our comparisons thus suggest that different programs can explore somewhat different regions in alignment space, and the program giving lower average performance may be capable of generating better alignments in many cases. However, selection of a better alignment in the absence of structural comparison is still a difficult task (<xref ref-type="bibr" rid="b46">46</xref>).
</p></sec></sec><sec><title>DISCUSSION</title><sec><title>Comparison of multiple sequence alignment programs</title><p>ProbCons (<xref ref-type="bibr" rid="b23">23</xref>) and MAFFT (<xref ref-type="bibr" rid="b11">11</xref>) are two of the most accurate multiple sequence alignment programs that explore only sequence information. They use different strategies to improve the accuracy of progressive alignment. ProbCons mainly relies on the consistency-based scoring function and MAFFT utilizes iterative refinement. MAFFT's scoring function is a weighted sum-of-pairs score of BLOSUM62, a general amino acid substitution matrix. Recent versions of MAFFT enhance performance by exploring aligned core regions with a simple consistency measure (<xref ref-type="bibr" rid="b11">11</xref>). However, the time-consuming ProbCons-type consistency operations on sequence triplets are not implemented in MAFFT. Our results show that MUMMALS based on probabilistic consistency can perform better than MAFFT, implying that consistency-based scoring function is superior to weighted sum-of-pairs measures of general substitution matrices.</p><p>Among existing multiple aligners, MUMMALS is methodologically closest to ProbCons. However, we implement HMMs that are different from the one used in ProbCons in three aspects. First, we introduce more complex model structures by increasing the number of match state types. While HMM_1_1_0, used mainly as a control, has the same model structure as the one in ProbCons, the other four models (HMM_1_1_1, HMM_1_3_1, HMM_3_1_1 and HMM_3_3_1) incorporate more match states, which take into account residue substitution differences in unaligned regions and aligned core blocks, as well as local structural differences in aligned core blocks. Second, we have estimated model parameters from DaliLite structural alignments of divergent SCOP domains (&#x0003c;40% identity), while the training data of ProbCons are from BAliBASE2.0. Third, we applied a supervised learning approach to estimating model parameters from structural alignments that have known hidden state paths. ProbCons applied an unsupervised learning approach (expectation maximization) to derive parameters without using reference alignments. Trained and tested on DaliLite structural alignments of SCOP40 domain pairs and on BAliBASE2.0 alignments, our models give better alignment quality than ProbCons and a number of other programs. We show that more complex models improve alignment quality and SCOP40 superfamily pairs with identity range of 20&#x02013;40% provide a better training dataset than BAliBASE2.0 alignments.</p><p>Although we do not explicitly perform structure prediction in the course of alignment construction, our HMMs with multiple match states have built-in information of residue substitution characteristics in distinct local structure environments. Such information is learned from structural alignments in the training process and is encoded in the models. Since these match states are hidden states, our HMMs construct alignments using only sequence information. In this aspect, our method is different from some other methods that require direct use of real or predicted local structural information (<xref ref-type="bibr" rid="b19">19</xref>,<xref ref-type="bibr" rid="b47">47</xref>).</p></sec><sec><title>Time complexity of HMMs and MUMMALS</title><p>The trade-off for improvement of alignment quality with more complex model structures is more time for computation (Supplementary Table S2). HMM_3_3_1 (modeling both secondary structure and solvent accessibility) has the largest number of hidden states and is the most time-consuming model, running about three times slower than HMM_1_3_1 (modeling only secondary structure). However, the performance of these two models is fairly similar in pairwise or multiple sequence alignment tests (<xref ref-type="table" rid="tbl1">Tables 1</xref>&#x02013;<xref ref-type="table" rid="tbl3">3</xref>). HMM_3_1_1 (modeling only solvent accessibility) has the same time complexity as HMM_1_3_1, but usually shows slightly inferior performance to HMM_1_3_1. These observations suggest that HMM_1_3_1 (modeling only secondary structure) is most efficient in balancing alignment accuracy and speed.</p><p>For MUMMALS, the rate-limiting steps are the computation of match probabilities using forward and backward algorithms (time order is <italic>N</italic><sup>2</sup> <sup>*</sup><italic>L</italic><sup>2</sup> <sup>*</sup><italic>K</italic><sup>2</sup>, <italic>N</italic>: number of sequences, <italic>L</italic>: average length, <italic>K</italic>: number of hidden states), and the computation of the consistency-based scoring function, which requires operations on all sequence triplets (time order is <italic>N</italic><sup>3</sup><sup>*</sup><italic>L</italic><sup>2</sup>). If probabilistic consistency measure is applied to every sequence pair, MUMMALS is much slower than MAFFT, MUSCLE and ClustalW (Supplementary Table S9). For example, the median CPU time of MUMMALS with model HMM_1_3_1 on 1785 SCOP40 pairs with added homologs is 174s per alignment, as compared to 2.5s for MAFFT with &#x02018;ginsi&#x02019; option (on Redhat Enterprise Linux 3, AMD Opteron 2.0 GHz). Applying a two-stage alignment strategy similar to the one used in the program PCMA (<xref ref-type="bibr" rid="b32">32</xref>), we were able to make MUMMALS almost an order of magnitude faster while still maintaining the same level of alignment accuracy on SCOP testing datasets (Supplementary Table S9). Since highly similar sequences can be aligned accurately with a general scoring function (<xref ref-type="bibr" rid="b8">8</xref>), there is no need for all of them to be subject to the time-consuming consistency measure. Although adding homologous sequences can in general improve alignment quality, our results on HOMSTRAD datasets suggest that proper balance of the similarity among the added homologs is also critical for MUMMALS as well as ProbCons.</p></sec><sec><title>Methods for alignment quality evaluation</title><p>Reference-dependent alignment evaluation relies on comparison of a test alignment to a reference alignment that is assumed to be correct. A commonly used alignment quality score is the fraction of correctly aligned residue pairs (<italic>Q</italic>-score). More complex scores have been designed to take into account the relative shifts of residues (<xref ref-type="bibr" rid="b48">48</xref>,<xref ref-type="bibr" rid="b49">49</xref>). Even though structure-based alignments can serve as high-quality references, there are several well-known drawbacks. First, structural alignments generated by automatic programs could still contain errors, especially for pairs with relatively low structural similarity, i.e. careful expert-driven multilateral research may generate alignments more meaningful than those obtained by programs. Second, defining the optimal structural alignment in certain regions is difficult for structurally divergent pairs, i.e. it is simply not possible to identify a single &#x02018;correct&#x02019; alignment, which may not even exist. Third, for multi-domain proteins, especially those with repeats or duplications, multiple ways of aligning structurally similar parts exist, resulting in a variety of reference alignments that are correct from structure modeling perspective. However, structure superposition programs usually provide a single best alignment. Some problems of reference-dependent evaluations are illustrated by examples from BAliBASE3.0. For SCOP40 testing datasets, we found about 20 domain pairs for which all sequence-based programs failed to align a single position correctly according to DaliLite reference alignment. Manual inspection of these instances suggests that most of these domains involve structural repeats. Many alignments produced by the tested programs did produce structurally meaningful results, but they had zero scores because they matched different repeats than those aligned by DaliLite.</p><p>Reference-independent evaluation can avoid these drawbacks. Although reference-independent evaluation is routinely used for assessing structure prediction models (<xref ref-type="bibr" rid="b50">50</xref>,<xref ref-type="bibr" rid="b51">51</xref>), it has not been frequently used in assessment of multiple sequence alignment programs (<xref ref-type="bibr" rid="b10">10</xref>,<xref ref-type="bibr" rid="b45">45</xref>). Our results show that reference-independent evaluation using various structural similarity scores produces similar, if not identical, rankings of the programs compared to reference-dependent evaluations using DaliLite alignments (<xref ref-type="table" rid="tbl3">Table 3</xref>). On the one hand, this result suggests that a large collection of reference alignments generated by structure alignment program DaliLite are on average well-suited for assessment of alignment quality. On the other hand, it is probably unnecessary to have a set of &#x02018;gold standard&#x02019; reference alignments. Reference-independent evaluation through scoring superpositions generated according sequence-based alignments is an easier and maybe more fair method to assess alignment quality and to compare different aligners. Therefore, particularly when the size of a testing dataset is large, improving reference alignment quality either by manual inspection and adjustment (<xref ref-type="bibr" rid="b30">30</xref>), or by using the consensus of structural aligners (<xref ref-type="bibr" rid="b10">10</xref>,<xref ref-type="bibr" rid="b33">33</xref>) is probably not necessary. With reference-independent evaluation techniques, we even suggest bypassing the step of generating reference alignments.</p></sec><sec><title>Multiple sequence alignment: still an unsolved problem</title><p>Despite several percentage points' improvement in alignments provided by MUMMALS, alignment quality for divergent sequences (sequence identity &#x0003c;15%) is still not high, since only &#x0223c;50% or even less residue pairs on average are aligned correctly according to reference alignments (<xref ref-type="table" rid="tbl2">Table 2</xref>). Although the best programs (MUMMALS, MAFFT and ProbCons) have limited differences in terms of average alignment quality score, they can produce quite different alignments for some sequence pairs (<xref ref-type="table" rid="tbl4">Table 4</xref>). It can be a good practice to use several aligners to generate alignments for divergent sequences. Manual examination of these alignments can be helpful in making expert judgments. Exploration of the consensus among programs is fruitful as well and is frequently used in meta-servers for structure prediction (<xref ref-type="bibr" rid="b52">52</xref>&#x02013;<xref ref-type="bibr" rid="b54">54</xref>). Results of the meta-aligner M-COFFEE (<xref ref-type="bibr" rid="b46">46</xref>) as well as ours (data not shown, MUMMALS package contains a meta-program similar to M-COFFEE) suggest that combining different multiple sequence aligners can give significant but limited improvement of alignment quality.</p><p>One advantage of MUMMALS is the use of HMMs with local structure information learned from structural alignments. Our model HMM_1_3_1 gives low secondary structure prediction accuracy. Providing real secondary structure information to this model can further improve alignment quality by a few percent. These results suggest that application of more accurate secondary structure predictions can lead to better alignment quality. Exploration of database sequence homologs and available 3D structures was also shown to be helpful (<xref ref-type="bibr" rid="b11">11</xref>,<xref ref-type="bibr" rid="b55">55</xref>,<xref ref-type="bibr" rid="b56">56</xref>). Further enhancement of multiple alignment quality could be achieved by effective integration of existing alignment techniques and various evolutionary and structural information resources.</p></sec></sec><sec><title>SUPPLEMENTARY DATA</title><p>Supplementary Data are available at NAR Online.</p></sec>
<sec sec-type="supplementary-material">
<title>Supplementary Material</title>
<supplementary-material id="PMC_1" content-type="local-data">
<caption>
<title>[Supplementary Data]</title>
</caption>
<media mimetype="text" mime-subtype="html" xlink:href="nar_gkl514_index.html"/>
<media xlink:role="associated-file" mimetype="application" mime-subtype="msword" xlink:href="nar_gkl514_gkl514_suppl.doc"/>
</supplementary-material>
</sec>
</body><back><ack><p>The authors would like to thank Bong-Hyun Kim for the program to calculate reference-independent sequence and structural scores and Dr Kazutaka Katoh for providing the HOMSTRAD datasets. The authors would also like to thank Lisa Kinch, James Wrabl and anonymous referees for helpful comments. Funding to pay the Open Access publication charges for this article was provided by Howard Hughes Medical Institute. This work was supported in part by NIH grant GM67165 to NVG.</p><p><italic>Conflict of interest statement.</italic> None declared.</p></ack><ref-list><title>REFERENCES</title><ref id="b1"><label>1</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Altschul</surname><given-names>S.F.</given-names></name><name><surname>Madden</surname><given-names>T.L.</given-names></name><name><surname>Schaffer</surname><given-names>A.A.</given-names></name><name><surname>Zhang</surname><given-names>J.</given-names></name><name><surname>Zhang</surname><given-names>Z.</given-names></name><name><surname>Miller</surname><given-names>W.</given-names></name><name><surname>Lipman</surname><given-names>D.J.</given-names></name></person-group><article-title>Gapped BLAST and PSI-BLAST: a new generation of protein database search programs</article-title><source>Nucleic Acids Res.</source><year>1997</year><volume>25</volume><fpage>3389</fpage><lpage>3402</lpage><pub-id pub-id-type="pmid">9254694</pub-id></citation></ref><ref id="b2"><label>2</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Eddy</surname><given-names>S.R.</given-names></name></person-group><article-title>Profile hidden Markov models</article-title><source>Bioinformatics</source><year>1998</year><volume>14</volume><fpage>755</fpage><lpage>763</lpage><pub-id pub-id-type="pmid">9918945</pub-id></citation></ref><ref id="b3"><label>3</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Lichtarge</surname><given-names>O.</given-names></name><name><surname>Bourne</surname><given-names>H.R.</given-names></name><name><surname>Cohen</surname><given-names>F.E.</given-names></name></person-group><article-title>An evolutionary trace method defines binding surfaces common to protein families</article-title><source>J. Mol. Biol.</source><year>1996</year><volume>257</volume><fpage>342</fpage><lpage>358</lpage><pub-id pub-id-type="pmid">8609628</pub-id></citation></ref><ref id="b4"><label>4</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Jones</surname><given-names>S.</given-names></name><name><surname>Thornton</surname><given-names>J.M.</given-names></name></person-group><article-title>Searching for functional sites in protein structures</article-title><source>Curr. Opin. Chem. Biol.</source><year>2004</year><volume>8</volume><fpage>3</fpage><lpage>7</lpage><pub-id pub-id-type="pmid">15036149</pub-id></citation></ref><ref id="b5"><label>5</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Wallace</surname><given-names>I.M.</given-names></name><name><surname>Blackshields</surname><given-names>G.</given-names></name><name><surname>Higgins</surname><given-names>D.G.</given-names></name></person-group><article-title>Multiple sequence alignments</article-title><source>Curr. Opin. Struct. Biol.</source><year>2005</year><volume>15</volume><fpage>261</fpage><lpage>266</lpage><pub-id pub-id-type="pmid">15963889</pub-id></citation></ref><ref id="b6"><label>6</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Edgar</surname><given-names>R.C.</given-names></name><name><surname>Batzoglou</surname><given-names>S.</given-names></name></person-group><article-title>Multiple sequence alignment</article-title><source>Curr. Opin. Struct. Biol.</source><year>2006</year><volume>16</volume><fpage>368</fpage><lpage>373</lpage><pub-id pub-id-type="pmid">16679011</pub-id></citation></ref><ref id="b7"><label>7</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Thompson</surname><given-names>J.D.</given-names></name><name><surname>Higgins</surname><given-names>D.G.</given-names></name><name><surname>Gibson</surname><given-names>T.J.</given-names></name></person-group><article-title>CLUSTAL W: improving the sensitivity of progressive multiple sequence alignment through sequence weighting, position-specific gap penalties and weight matrix choice</article-title><source>Nucleic Acids Res.</source><year>1994</year><volume>22</volume><fpage>4673</fpage><lpage>4680</lpage><pub-id pub-id-type="pmid">7984417</pub-id></citation></ref><ref id="b8"><label>8</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Thompson</surname><given-names>J.D.</given-names></name><name><surname>Plewniak</surname><given-names>F.</given-names></name><name><surname>Poch</surname><given-names>O.</given-names></name></person-group><article-title>A comprehensive comparison of multiple sequence alignment programs</article-title><source>Nucleic Acids Res.</source><year>1999</year><volume>27</volume><fpage>2682</fpage><lpage>2690</lpage><pub-id pub-id-type="pmid">10373585</pub-id></citation></ref><ref id="b9"><label>9</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Gotoh</surname><given-names>O.</given-names></name></person-group><article-title>Significant improvement in accuracy of multiple protein sequence alignments by iterative refinement as assessed by reference to structural alignments</article-title><source>J. Mol. Biol.</source><year>1996</year><volume>264</volume><fpage>823</fpage><lpage>838</lpage><pub-id pub-id-type="pmid">8980688</pub-id></citation></ref><ref id="b10"><label>10</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Edgar</surname><given-names>R.C.</given-names></name></person-group><article-title>MUSCLE: multiple sequence alignment with high accuracy and high throughput</article-title><source>Nucleic Acids Res.</source><year>2004</year><volume>32</volume><fpage>1792</fpage><lpage>1797</lpage><pub-id pub-id-type="pmid">15034147</pub-id></citation></ref><ref id="b11"><label>11</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Katoh</surname><given-names>K.</given-names></name><name><surname>Kuma</surname><given-names>K.</given-names></name><name><surname>Toh</surname><given-names>H.</given-names></name><name><surname>Miyata</surname><given-names>T.</given-names></name></person-group><article-title>MAFFT version 5: improvement in accuracy of multiple sequence alignment</article-title><source>Nucleic Acids Res.</source><year>2005</year><volume>33</volume><fpage>511</fpage><lpage>518</lpage><pub-id pub-id-type="pmid">15661851</pub-id></citation></ref><ref id="b12"><label>12</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Notredame</surname><given-names>C.</given-names></name><name><surname>Higgins</surname><given-names>D.G.</given-names></name><name><surname>Heringa</surname><given-names>J.</given-names></name></person-group><article-title>T-Coffee: a novel method for fast and accurate multiple sequence alignment</article-title><source>J. Mol. Biol.</source><year>2000</year><volume>302</volume><fpage>205</fpage><lpage>217</lpage><pub-id pub-id-type="pmid">10964570</pub-id></citation></ref><ref id="b13"><label>13</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Needleman</surname><given-names>S.B.</given-names></name><name><surname>Wunsch</surname><given-names>C.D.</given-names></name></person-group><article-title>A general method applicable to the search for similarities in the amino acid sequence of two proteins</article-title><source>J. Mol. Biol.</source><year>1970</year><volume>48</volume><fpage>443</fpage><lpage>453</lpage><pub-id pub-id-type="pmid">5420325</pub-id></citation></ref><ref id="b14"><label>14</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Smith</surname><given-names>T.F.</given-names></name><name><surname>Waterman</surname><given-names>M.S.</given-names></name></person-group><article-title>Identification of common molecular subsequences</article-title><source>J. Mol. Biol.</source><year>1981</year><volume>147</volume><fpage>195</fpage><lpage>197</lpage><pub-id pub-id-type="pmid">7265238</pub-id></citation></ref><ref id="b15"><label>15</label><citation citation-type="book"><person-group person-group-type="author"><name><surname>Dayhoff</surname><given-names>M.O.</given-names></name><name><surname>Schwartz</surname><given-names>R.M.</given-names></name><name><surname>Orcutt</surname><given-names>B.C.</given-names></name></person-group><person-group person-group-type="editor"><name><surname>Dayhoff</surname><given-names>M.O.</given-names></name></person-group><article-title>Atlas of Protein Sequences and Structures</article-title><source>National Biomedical Research Foundation</source><year>1978</year><volume>Vol. 5</volume><publisher-loc>Washington, DC</publisher-loc><fpage>345</fpage><lpage>352</lpage></citation></ref><ref id="b16"><label>16</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Henikoff</surname><given-names>S.</given-names></name><name><surname>Henikoff</surname><given-names>J.G.</given-names></name></person-group><article-title>Amino acid substitution matrices from protein blocks</article-title><source>Proc. Natl Acad. Sci. USA</source><year>1992</year><volume>89</volume><fpage>10915</fpage><lpage>10919</lpage><pub-id pub-id-type="pmid">1438297</pub-id></citation></ref><ref id="b17"><label>17</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Prlic</surname><given-names>A.</given-names></name><name><surname>Domingues</surname><given-names>F.S.</given-names></name><name><surname>Sippl</surname><given-names>M.J.</given-names></name></person-group><article-title>Structure-derived substitution matrices for alignment of distantly related sequences [In Process Citation]</article-title><source>Protein Eng.</source><year>2000</year><volume>13</volume><fpage>545</fpage><lpage>550</lpage><pub-id pub-id-type="pmid">10964983</pub-id></citation></ref><ref id="b18"><label>18</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Blake</surname><given-names>J.D.</given-names></name><name><surname>Cohen</surname><given-names>F.E.</given-names></name></person-group><article-title>Pairwise sequence alignment below the twilight zone</article-title><source>J. Mol. Biol.</source><year>2001</year><volume>307</volume><fpage>721</fpage><lpage>735</lpage><pub-id pub-id-type="pmid">11254392</pub-id></citation></ref><ref id="b19"><label>19</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Wang</surname><given-names>J.</given-names></name><name><surname>Feng</surname><given-names>J.A.</given-names></name></person-group><article-title>NdPASA: a novel pairwise protein sequence alignment algorithm that incorporates neighbor-dependent amino acid propensities</article-title><source>Proteins</source><year>2005</year><volume>58</volume><fpage>628</fpage><lpage>637</lpage><pub-id pub-id-type="pmid">15616964</pub-id></citation></ref><ref id="b20"><label>20</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Huang</surname><given-names>Y.M.</given-names></name><name><surname>Bystroff</surname><given-names>C.</given-names></name></person-group><article-title>Improved pairwise alignments of proteins in the Twilight Zone using local structure predictions</article-title><source>Bioinformatics</source><year>2006</year><volume>22</volume><fpage>413</fpage><lpage>422</lpage><pub-id pub-id-type="pmid">16352653</pub-id></citation></ref><ref id="b21"><label>21</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Eddy</surname><given-names>S.R.</given-names></name></person-group><article-title>Hidden Markov models</article-title><source>Curr. Opin. Struct. Biol.</source><year>1996</year><volume>6</volume><fpage>361</fpage><lpage>365</lpage><pub-id pub-id-type="pmid">8804822</pub-id></citation></ref><ref id="b22"><label>22</label><citation citation-type="book"><person-group person-group-type="author"><name><surname>Durbin</surname><given-names>R.</given-names></name><name><surname>Eddy</surname><given-names>S.R.</given-names></name><name><surname>Krogh</surname><given-names>A.</given-names></name><name><surname>Mitchison</surname><given-names>G.</given-names></name></person-group><source>Biological Sequence Analysis</source><year>1998</year><publisher-name>Cambridge University Press</publisher-name><fpage>80</fpage><lpage>99</lpage></citation></ref><ref id="b23"><label>23</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Do</surname><given-names>C.B.</given-names></name><name><surname>Mahabhashyam</surname><given-names>M.S.</given-names></name><name><surname>Brudno</surname><given-names>M.</given-names></name><name><surname>Batzoglou</surname><given-names>S.</given-names></name></person-group><article-title>ProbCons: probabilistic consistency-based multiple sequence alignment</article-title><source>Genome Res.</source><year>2005</year><volume>15</volume><fpage>330</fpage><lpage>340</lpage><pub-id pub-id-type="pmid">15687296</pub-id></citation></ref><ref id="b24"><label>24</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Murzin</surname><given-names>A.G.</given-names></name><name><surname>Brenner</surname><given-names>S.E.</given-names></name><name><surname>Hubbard</surname><given-names>T.</given-names></name><name><surname>Chothia</surname><given-names>C.</given-names></name></person-group><article-title>SCOP: a structural classification of proteins database for the investigation of sequences and structures</article-title><source>J. Mol. Biol.</source><year>1995</year><volume>247</volume><fpage>536</fpage><lpage>540</lpage><pub-id pub-id-type="pmid">7723011</pub-id></citation></ref><ref id="b25"><label>25</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Chandonia</surname><given-names>J.M.</given-names></name><name><surname>Hon</surname><given-names>G.</given-names></name><name><surname>Walker</surname><given-names>N.S.</given-names></name><name><surname>Lo Conte</surname><given-names>L.</given-names></name><name><surname>Koehl</surname><given-names>P.</given-names></name><name><surname>Levitt</surname><given-names>M.</given-names></name><name><surname>Brenner</surname><given-names>S.E.</given-names></name></person-group><article-title>The ASTRAL Compendium in 2004</article-title><source>Nucleic Acids Res.</source><year>2004</year><volume>32</volume><fpage>D189</fpage><lpage>D192</lpage><pub-id pub-id-type="pmid">14681391</pub-id></citation></ref><ref id="b26"><label>26</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Holm</surname><given-names>L.</given-names></name><name><surname>Sander</surname><given-names>C.</given-names></name></person-group><article-title>Mapping the protein universe</article-title><source>Science</source><year>1996</year><volume>273</volume><fpage>595</fpage><lpage>603</lpage><pub-id pub-id-type="pmid">8662544</pub-id></citation></ref><ref id="b27"><label>27</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Kabsch</surname><given-names>W.</given-names></name><name><surname>Sander</surname><given-names>C.</given-names></name></person-group><article-title>Identical pentapeptides with different backbones</article-title><source>Nature</source><year>1985</year><volume>317</volume><fpage>207</fpage><pub-id pub-id-type="pmid">4047161</pub-id></citation></ref><ref id="b28"><label>28</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Hubbard</surname><given-names>S.J.</given-names></name><name><surname>Campbell</surname><given-names>S.F.</given-names></name><name><surname>Thornton</surname><given-names>J.M.</given-names></name></person-group><article-title>Molecular recognition. Conformational analysis of limited proteolytic sites and serine proteinase protein inhibitors</article-title><source>J. Mol. Biol.</source><year>1991</year><volume>220</volume><fpage>507</fpage><lpage>530</lpage><pub-id pub-id-type="pmid">1856871</pub-id></citation></ref><ref id="b29"><label>29</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Pei</surname><given-names>J.</given-names></name><name><surname>Grishin</surname><given-names>N.V.</given-names></name></person-group><article-title>Combining evolutionary and structural information for local protein structure prediction</article-title><source>Proteins</source><year>2004</year><volume>56</volume><fpage>782</fpage><lpage>794</lpage><pub-id pub-id-type="pmid">15281130</pub-id></citation></ref><ref id="b30"><label>30</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Bahr</surname><given-names>A.</given-names></name><name><surname>Thompson</surname><given-names>J.D.</given-names></name><name><surname>Thierry</surname><given-names>J.C.</given-names></name><name><surname>Poch</surname><given-names>O.</given-names></name></person-group><article-title>BAliBASE (Benchmark Alignment dataBASE): enhancements for repeats, transmembrane sequences and circular permutations</article-title><source>Nucleic Acids Res.</source><year>2001</year><volume>29</volume><fpage>323</fpage><lpage>326</lpage><pub-id pub-id-type="pmid">11125126</pub-id></citation></ref><ref id="b31"><label>31</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Miyazawa</surname><given-names>S.</given-names></name></person-group><article-title>A reliable sequence alignment method based on probabilities of residue correspondences</article-title><source>Protein Eng.</source><year>1995</year><volume>8</volume><fpage>999</fpage><lpage>1009</lpage><pub-id pub-id-type="pmid">8771180</pub-id></citation></ref><ref id="b32"><label>32</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Pei</surname><given-names>J.</given-names></name><name><surname>Sadreyev</surname><given-names>R.</given-names></name><name><surname>Grishin</surname><given-names>N.V.</given-names></name></person-group><article-title>PCMA: fast and accurate multiple sequence alignment based on profile consistency</article-title><source>Bioinformatics</source><year>2003</year><volume>19</volume><fpage>427</fpage><lpage>428</lpage><pub-id pub-id-type="pmid">12584134</pub-id></citation></ref><ref id="b33"><label>33</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Van Walle</surname><given-names>I.</given-names></name><name><surname>Lasters</surname><given-names>I.</given-names></name><name><surname>Wyns</surname><given-names>L.</given-names></name></person-group><article-title>SABmark&#x02014;a benchmark for sequence alignment that covers the entire known fold space</article-title><source>Bioinformatics</source><year>2005</year><volume>21</volume><fpage>1267</fpage><lpage>1268</lpage><pub-id pub-id-type="pmid">15333456</pub-id></citation></ref><ref id="b34"><label>34</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>de Bakker</surname><given-names>P.I.</given-names></name><name><surname>Bateman</surname><given-names>A.</given-names></name><name><surname>Burke</surname><given-names>D.F.</given-names></name><name><surname>Miguel</surname><given-names>R.N.</given-names></name><name><surname>Mizuguchi</surname><given-names>K.</given-names></name><name><surname>Shi</surname><given-names>J.</given-names></name><name><surname>Shirai</surname><given-names>H.</given-names></name><name><surname>Blundell</surname><given-names>T.L.</given-names></name></person-group><article-title>HOMSTRAD: adding sequence information to structure-based alignments of homologous protein families</article-title><source>Bioinformatics</source><year>2001</year><volume>17</volume><fpage>748</fpage><lpage>749</lpage><pub-id pub-id-type="pmid">11524380</pub-id></citation></ref><ref id="b35"><label>35</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Thompson</surname><given-names>J.D.</given-names></name><name><surname>Koehl</surname><given-names>P.</given-names></name><name><surname>Ripp</surname><given-names>R.</given-names></name><name><surname>Poch</surname><given-names>O.</given-names></name></person-group><article-title>BAliBASE 3.0: latest developments of the multiple sequence alignment benchmark</article-title><source>Proteins</source><year>2005</year><volume>61</volume><fpage>127</fpage><lpage>136</lpage><pub-id pub-id-type="pmid">16044462</pub-id></citation></ref><ref id="b36"><label>36</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Holm</surname><given-names>L.</given-names></name><name><surname>Sander</surname><given-names>C.</given-names></name></person-group><article-title>Dictionary of recurrent domains in protein structures</article-title><source>Proteins</source><year>1998</year><volume>33</volume><fpage>88</fpage><lpage>96</lpage><pub-id pub-id-type="pmid">9741847</pub-id></citation></ref><ref id="b37"><label>37</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Zemla</surname><given-names>A.</given-names></name><name><surname>Venclovas</surname><given-names>C.</given-names></name><name><surname>Moult</surname><given-names>J.</given-names></name><name><surname>Fidelis</surname><given-names>K.</given-names></name></person-group><article-title>Processing and analysis of CASP3 protein structure predictions</article-title><source>Proteins</source><year>1999</year><volume>3</volume><fpage>22</fpage><lpage>29</lpage><pub-id pub-id-type="pmid">10526349</pub-id></citation></ref><ref id="b38"><label>38</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Zhang</surname><given-names>Y.</given-names></name><name><surname>Skolnick</surname><given-names>J.</given-names></name></person-group><article-title>Scoring function for automated assessment of protein structure template quality</article-title><source>Proteins</source><year>2004</year><volume>57</volume><fpage>702</fpage><lpage>710</lpage><pub-id pub-id-type="pmid">15476259</pub-id></citation></ref><ref id="b39"><label>39</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Rychlewski</surname><given-names>L.</given-names></name><name><surname>Fischer</surname><given-names>D.</given-names></name><name><surname>Elofsson</surname><given-names>A.</given-names></name></person-group><article-title>LiveBench-6: large-scale automated evaluation of protein structure prediction servers</article-title><source>Proteins</source><year>2003</year><volume>53</volume><fpage>542</fpage><lpage>547</lpage><pub-id pub-id-type="pmid">14579344</pub-id></citation></ref><ref id="b40"><label>40</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Boutonnet</surname><given-names>N.S.</given-names></name><name><surname>Rooman</surname><given-names>M.J.</given-names></name><name><surname>Ochagavia</surname><given-names>M.E.</given-names></name><name><surname>Richelle</surname><given-names>J.</given-names></name><name><surname>Wodak</surname><given-names>S.J.</given-names></name></person-group><article-title>Optimal protein structure alignments by multiple linkage clustering: application to distantly related proteins</article-title><source>Protein Eng.</source><year>1995</year><volume>8</volume><fpage>647</fpage><lpage>662</lpage><pub-id pub-id-type="pmid">8577694</pub-id></citation></ref><ref id="b41"><label>41</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Shindyalov</surname><given-names>I.N.</given-names></name><name><surname>Bourne</surname><given-names>P.E.</given-names></name></person-group><article-title>Protein structure alignment by incremental combinatorial extension (CE) of the optimal path</article-title><source>Protein Eng.</source><year>1998</year><volume>11</volume><fpage>739</fpage><lpage>747</lpage><pub-id pub-id-type="pmid">9796821</pub-id></citation></ref><ref id="b42"><label>42</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Marchler-Bauer</surname><given-names>A.</given-names></name><name><surname>Anderson</surname><given-names>J.B.</given-names></name><name><surname>Cherukuri</surname><given-names>P.F.</given-names></name><name><surname>DeWeese-Scott</surname><given-names>C.</given-names></name><name><surname>Geer</surname><given-names>L.Y.</given-names></name><name><surname>Gwadz</surname><given-names>M.</given-names></name><name><surname>He</surname><given-names>S.</given-names></name><name><surname>Hurwitz</surname><given-names>D.I.</given-names></name><name><surname>Jackson</surname><given-names>J.D.</given-names></name><name><surname>Ke</surname><given-names>Z.</given-names></name><etal/></person-group><article-title>CDD: a Conserved Domain Database for protein classification</article-title><source>Nucleic Acids Res.</source><year>2005</year><volume>33</volume><fpage>D192</fpage><lpage>D196</lpage><pub-id pub-id-type="pmid">15608175</pub-id></citation></ref><ref id="b43"><label>43</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Jones</surname><given-names>D.T.</given-names></name></person-group><article-title>Protein secondary structure prediction based on position-specific scoring matrices</article-title><source>J. Mol. Biol.</source><year>1999</year><volume>292</volume><fpage>195</fpage><lpage>202</lpage><pub-id pub-id-type="pmid">10493868</pub-id></citation></ref><ref id="b44"><label>44</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Rost</surname><given-names>B.</given-names></name></person-group><article-title>Review: protein secondary structure prediction continues to rise</article-title><source>J. Struct. Biol.</source><year>2001</year><volume>134</volume><fpage>204</fpage><lpage>218</lpage><pub-id pub-id-type="pmid">11551180</pub-id></citation></ref><ref id="b45"><label>45</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>O'Sullivan</surname><given-names>O.</given-names></name><name><surname>Zehnder</surname><given-names>M.</given-names></name><name><surname>Higgins</surname><given-names>D.</given-names></name><name><surname>Bucher</surname><given-names>P.</given-names></name><name><surname>Grosdidier</surname><given-names>A.</given-names></name><name><surname>Notredame</surname><given-names>C.</given-names></name></person-group><article-title>APDB: a novel measure for benchmarking sequence alignment methods without reference alignments</article-title><source>Bioinformatics</source><year>2003</year><volume>19</volume><fpage>i215</fpage><lpage>i221</lpage><pub-id pub-id-type="pmid">12855461</pub-id></citation></ref><ref id="b46"><label>46</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Wallace</surname><given-names>I.M.</given-names></name><name><surname>O'Sullivan</surname><given-names>O.</given-names></name><name><surname>Higgins</surname><given-names>D.G.</given-names></name><name><surname>Notredame</surname><given-names>C.</given-names></name></person-group><article-title>M-Coffee: combining multiple sequence alignment methods with T-Coffee</article-title><source>Nucleic Acids Res.</source><year>2006</year><volume>34</volume><fpage>1692</fpage><lpage>1699</lpage><pub-id pub-id-type="pmid">16556910</pub-id></citation></ref><ref id="b47"><label>47</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Zhou</surname><given-names>H.</given-names></name><name><surname>Zhou</surname><given-names>Y.</given-names></name></person-group><article-title>SPEM: improving multiple sequence alignment with sequence profiles and predicted secondary structures</article-title><source>Bioinformatics</source><year>2005</year><volume>21</volume><fpage>3615</fpage><lpage>3621</lpage><pub-id pub-id-type="pmid">16020471</pub-id></citation></ref><ref id="b48"><label>48</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Cline</surname><given-names>M.</given-names></name><name><surname>Hughey</surname><given-names>R.</given-names></name><name><surname>Karplus</surname><given-names>K.</given-names></name></person-group><article-title>Predicting reliable regions in protein sequence alignments</article-title><source>Bioinformatics</source><year>2002</year><volume>18</volume><fpage>306</fpage><lpage>314</lpage><pub-id pub-id-type="pmid">11847078</pub-id></citation></ref><ref id="b49"><label>49</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Sadreyev</surname><given-names>R.</given-names></name><name><surname>Grishin</surname><given-names>N.</given-names></name></person-group><article-title>COMPASS: a tool for comparison of multiple protein alignments with assessment of statistical significance</article-title><source>J. Mol. Biol.</source><year>2003</year><volume>326</volume><fpage>317</fpage><lpage>336</lpage><pub-id pub-id-type="pmid">12547212</pub-id></citation></ref><ref id="b50"><label>50</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Venclovas</surname><given-names>C.</given-names></name><name><surname>Margelevicius</surname><given-names>M.</given-names></name></person-group><article-title>Comparative modeling in CASP6 using consensus approach to template selection, sequence-structure alignment, and structure assessment</article-title><source>Proteins</source><year>2005</year><volume>61</volume><fpage>99</fpage><lpage>105</lpage><pub-id pub-id-type="pmid">16187350</pub-id></citation></ref><ref id="b51"><label>51</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Kinch</surname><given-names>L.N.</given-names></name><name><surname>Wrabl</surname><given-names>J.O.</given-names></name><name><surname>Krishna</surname><given-names>S.S.</given-names></name><name><surname>Majumdar</surname><given-names>I.</given-names></name><name><surname>Sadreyev</surname><given-names>R.I.</given-names></name><name><surname>Qi</surname><given-names>Y.</given-names></name><name><surname>Pei</surname><given-names>J.</given-names></name><name><surname>Cheng</surname><given-names>H.</given-names></name><name><surname>Grishin</surname><given-names>N.V.</given-names></name></person-group><article-title>CASP5 assessment of fold recognition target predictions</article-title><source>Proteins</source><year>2003</year><volume>53</volume><fpage>395</fpage><lpage>409</lpage><pub-id pub-id-type="pmid">14579328</pub-id></citation></ref><ref id="b52"><label>52</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Ginalski</surname><given-names>K.</given-names></name><name><surname>Elofsson</surname><given-names>A.</given-names></name><name><surname>Fischer</surname><given-names>D.</given-names></name><name><surname>Rychlewski</surname><given-names>L.</given-names></name></person-group><article-title>3D-Jury: a simple approach to improve protein structure predictions</article-title><source>Bioinformatics</source><year>2003</year><volume>19</volume><fpage>1015</fpage><lpage>1018</lpage><pub-id pub-id-type="pmid">12761065</pub-id></citation></ref><ref id="b53"><label>53</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Wallner</surname><given-names>B.</given-names></name><name><surname>Elofsson</surname><given-names>A.</given-names></name></person-group><article-title>Pcons5: combining consensus, structural evaluation and fold recognition scores</article-title><source>Bioinformatics</source><year>2005</year><volume>21</volume><fpage>4248</fpage><lpage>4254</lpage><pub-id pub-id-type="pmid">16204344</pub-id></citation></ref><ref id="b54"><label>54</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Chivian</surname><given-names>D.</given-names></name><name><surname>Kim</surname><given-names>D.E.</given-names></name><name><surname>Malmstrom</surname><given-names>L.</given-names></name><name><surname>Schonbrun</surname><given-names>J.</given-names></name><name><surname>Rohl</surname><given-names>C.A.</given-names></name><name><surname>Baker</surname><given-names>D.</given-names></name></person-group><article-title>Prediction of CASP6 structures using automated Robetta protocols</article-title><source>Proteins</source><year>2005</year><volume>61</volume><fpage>157</fpage><lpage>166</lpage><pub-id pub-id-type="pmid">16187358</pub-id></citation></ref><ref id="b55"><label>55</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>O'Sullivan</surname><given-names>O.</given-names></name><name><surname>Suhre</surname><given-names>K.</given-names></name><name><surname>Abergel</surname><given-names>C.</given-names></name><name><surname>Higgins</surname><given-names>D.G.</given-names></name><name><surname>Notredame</surname><given-names>C.</given-names></name></person-group><article-title>3DCoffee: combining protein sequences and structures within multiple sequence alignments</article-title><source>J. Mol. Biol.</source><year>2004</year><volume>340</volume><fpage>385</fpage><lpage>395</lpage><pub-id pub-id-type="pmid">15201059</pub-id></citation></ref><ref id="b56"><label>56</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Simossis</surname><given-names>V.A.</given-names></name><name><surname>Heringa</surname><given-names>J.</given-names></name></person-group><article-title>Integrating protein secondary structure prediction and multiple sequence alignment</article-title><source>Curr. Protein Pept. Sci.</source><year>2004</year><volume>5</volume><fpage>249</fpage><lpage>266</lpage><pub-id pub-id-type="pmid">15320732</pub-id></citation></ref></ref-list><sec sec-type="display-objects"><title>Figures and Tables</title><fig id="fig1" position="float"><label>Figure 1</label><caption><p>(<bold>a</bold>) An illustration of structure-based sequence alignment and hidden state paths. In Sequences 1 and 2, uppercase letters and lowercase letters represent aligned core blocks and unaligned regions, respectively. If two corresponding unaligned regions bounded by the same two core blocks are of different length, we split the shorter one into two pieces and introduce contiguous gaps in the middle. For both N- and C-terminal ends, the shorter unaligned region is pushed toward the core blocks. Secondary structure (ss) types (helix, &#x02018;h&#x02019;; strand, &#x02018;e&#x02019;; coil, &#x02018;c&#x02019;) are shown for Sequence 1. The hidden state paths for three models are shown below the amino acid sequences. (<bold>b</bold>) Model structure of HMM_1_1_0. Residue pairs in unaligned regions are modeled using the same match state (&#x02018;M&#x02019;) as those in the aligned blocks. Insertions in the first sequence and second sequence are modeled using states &#x02018;X&#x02019; and &#x02018;Y&#x02019;, respectively. (<bold>c</bold>) Model structure of HMM_1_1_1. Residue pairs in the unaligned regions are modeled using a different match state (&#x02018;U&#x02019;) than the match state in the core blocks (&#x02018;M&#x02019;). (<bold>d</bold>) Model structure of HMM_1_3_1. Residue pairs in aligned core blocks are modeled using three match states (&#x02018;H&#x02019;, &#x02018;S&#x02019;, &#x02018;C&#x02019;) according to three secondary structure types of the first sequence. In (b), (c) and (d), match states are shown as squares and insertion states are shown as diamonds. Begin state, end state, and transitions from or to them are present in these models, but are not shown.</p></caption><graphic xlink:href="gkl514f1"/></fig><table-wrap id="tbl1" position="float"><label>Table 1</label><caption><p>Average <italic>Q</italic>-scores in pairwise alignment tests on representative SCOP40 domain pairs</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" rowspan="1" colspan="1">Method/Model</th><th colspan="5" align="left" rowspan="1">Testing datasets</th></tr><tr><th rowspan="1" colspan="1"/><th align="left" rowspan="1" colspan="1">SCOP 0&#x02013;10%</th><th align="left" rowspan="1" colspan="1">SCOP 10&#x02013;15%</th><th align="left" rowspan="1" colspan="1">SCOP 15&#x02013;20%</th><th align="left" rowspan="1" colspan="1">SCOP 2&#x02013;40%</th><th align="left" rowspan="1" colspan="1">SCOP All</th></tr><tr><th rowspan="1" colspan="1"/><th align="left" rowspan="1" colspan="1">(355)</th><th align="left" rowspan="1" colspan="1">(432)</th><th align="left" rowspan="1" colspan="1">(420)</th><th align="left" rowspan="1" colspan="1">(578)</th><th align="left" rowspan="1" colspan="1">(1785)</th></tr></thead><tbody><tr><td align="left" rowspan="1" colspan="1">HMM_1_1_0<xref ref-type="table-fn" rid="tf1-1">a</xref></td><td align="left" rowspan="1" colspan="1">0.146</td><td align="left" rowspan="1" colspan="1">0.322<xref ref-type="table-fn" rid="tf1-3">c</xref></td><td align="left" rowspan="1" colspan="1">0.568<xref ref-type="table-fn" rid="tf1-3">c</xref></td><td align="left" rowspan="1" colspan="1">0.851<xref ref-type="table-fn" rid="tf1-3">c</xref></td><td align="left" rowspan="1" colspan="1">0.516<xref ref-type="table-fn" rid="tf1-3">c</xref></td></tr><tr><td align="left" rowspan="1" colspan="1">HMM_1_1_1<xref ref-type="table-fn" rid="tf1-1">a</xref></td><td align="left" rowspan="1" colspan="1">0.146</td><td align="left" rowspan="1" colspan="1">0.328<xref ref-type="table-fn" rid="tf1-3">c</xref></td><td align="left" rowspan="1" colspan="1">0.573<xref ref-type="table-fn" rid="tf1-3">c</xref></td><td align="left" rowspan="1" colspan="1">0.855<xref ref-type="table-fn" rid="tf1-3">c</xref></td><td align="left" rowspan="1" colspan="1">0.520<xref ref-type="table-fn" rid="tf1-3">c</xref></td></tr><tr><td align="left" rowspan="1" colspan="1">HMM_3_1_1<xref ref-type="table-fn" rid="tf1-1">a</xref></td><td align="left" rowspan="1" colspan="1">0.150<xref ref-type="table-fn" rid="tf1-3">c</xref></td><td align="left" rowspan="1" colspan="1">0.327<xref ref-type="table-fn" rid="tf1-3">c</xref></td><td align="left" rowspan="1" colspan="1">0.574<xref ref-type="table-fn" rid="tf1-3">c</xref></td><td align="left" rowspan="1" colspan="1">0.858<xref ref-type="table-fn" rid="tf1-3">c</xref></td><td align="left" rowspan="1" colspan="1">0.521<xref ref-type="table-fn" rid="tf1-3">c</xref></td></tr><tr><td align="left" rowspan="1" colspan="1">HMM_1_3_1<xref ref-type="table-fn" rid="tf1-1">a</xref></td><td align="left" rowspan="1" colspan="1"><bold>0.152</bold><xref ref-type="table-fn" rid="tf1-3">c</xref></td><td align="left" rowspan="1" colspan="1">0.334<xref ref-type="table-fn" rid="tf1-3">c</xref></td><td align="left" rowspan="1" colspan="1">0.585<xref ref-type="table-fn" rid="tf1-3">c</xref></td><td align="left" rowspan="1" colspan="1">0.858<xref ref-type="table-fn" rid="tf1-3">c</xref></td><td align="left" rowspan="1" colspan="1">0.526<xref ref-type="table-fn" rid="tf1-3">c</xref></td></tr><tr><td align="left" rowspan="1" colspan="1">HMM_3_3_1<xref ref-type="table-fn" rid="tf1-1">a</xref></td><td align="left" rowspan="1" colspan="1">0.151<xref ref-type="table-fn" rid="tf1-3">c</xref></td><td align="left" rowspan="1" colspan="1"><bold>0.335</bold><xref ref-type="table-fn" rid="tf1-3">c</xref></td><td align="left" rowspan="1" colspan="1"><bold>0.586</bold><xref ref-type="table-fn" rid="tf1-3">c</xref></td><td align="left" rowspan="1" colspan="1"><bold>0.860</bold><xref ref-type="table-fn" rid="tf1-3">c</xref></td><td align="left" rowspan="1" colspan="1"><bold>0.527</bold><xref ref-type="table-fn" rid="tf1-3">c</xref></td></tr><tr><td align="left" rowspan="1" colspan="1">HMM_1_1_0<xref ref-type="table-fn" rid="tf1-2">b</xref></td><td align="left" rowspan="1" colspan="1">0.123</td><td align="left" rowspan="1" colspan="1">0.295</td><td align="left" rowspan="1" colspan="1">0.551</td><td align="left" rowspan="1" colspan="1">0.843</td><td align="left" rowspan="1" colspan="1">0.498</td></tr><tr><td align="left" rowspan="1" colspan="1">HMM_1_1_1<xref ref-type="table-fn" rid="tf1-2">b</xref></td><td align="left" rowspan="1" colspan="1">0.132</td><td align="left" rowspan="1" colspan="1">0.31</td><td align="left" rowspan="1" colspan="1">0.572</td><td align="left" rowspan="1" colspan="1">0.851</td><td align="left" rowspan="1" colspan="1">0.511</td></tr><tr><td align="left" rowspan="1" colspan="1">ProbCons</td><td align="left" rowspan="1" colspan="1">0.116</td><td align="left" rowspan="1" colspan="1"><bold>0.294</bold></td><td align="left" rowspan="1" colspan="1"><bold>0.536</bold></td><td align="left" rowspan="1" colspan="1"><bold>0.833</bold></td><td align="left" rowspan="1" colspan="1"><bold>0.490</bold></td></tr><tr><td align="left" rowspan="1" colspan="1">MAFFT-fftnsi</td><td align="left" rowspan="1" colspan="1">0.087</td><td align="left" rowspan="1" colspan="1">0.256</td><td align="left" rowspan="1" colspan="1">0.496</td><td align="left" rowspan="1" colspan="1">0.809</td><td align="left" rowspan="1" colspan="1">0.457</td></tr><tr><td align="left" rowspan="1" colspan="1">MAFFT-einsi</td><td align="left" rowspan="1" colspan="1">0.081</td><td align="left" rowspan="1" colspan="1">0.248</td><td align="left" rowspan="1" colspan="1">0.491</td><td align="left" rowspan="1" colspan="1">0.809</td><td align="left" rowspan="1" colspan="1">0.453</td></tr><tr><td align="left" rowspan="1" colspan="1">MAFFT-linsi</td><td align="left" rowspan="1" colspan="1">0.116</td><td align="left" rowspan="1" colspan="1">0.262</td><td align="left" rowspan="1" colspan="1">0.495</td><td align="left" rowspan="1" colspan="1">0.794</td><td align="left" rowspan="1" colspan="1">0.460</td></tr><tr><td align="left" rowspan="1" colspan="1">MAFFT-ginsi</td><td align="left" rowspan="1" colspan="1">0.116</td><td align="left" rowspan="1" colspan="1">0.265</td><td align="left" rowspan="1" colspan="1">0.496</td><td align="left" rowspan="1" colspan="1">0.794</td><td align="left" rowspan="1" colspan="1">0.461</td></tr><tr><td align="left" rowspan="1" colspan="1">MUSCLE</td><td align="left" rowspan="1" colspan="1"><bold>0.139</bold></td><td align="left" rowspan="1" colspan="1">0.293</td><td align="left" rowspan="1" colspan="1">0.507</td><td align="left" rowspan="1" colspan="1">0.817</td><td align="left" rowspan="1" colspan="1">0.482</td></tr><tr><td align="left" rowspan="1" colspan="1">ClustalW</td><td align="left" rowspan="1" colspan="1">0.136</td><td align="left" rowspan="1" colspan="1">0.27</td><td align="left" rowspan="1" colspan="1">0.482</td><td align="left" rowspan="1" colspan="1">0.809</td><td align="left" rowspan="1" colspan="1">0.467</td></tr></tbody></table><table-wrap-foot><fn><p>Each HMM is named in the format &#x02018;HMM_solv_ss_u&#x02019;, where &#x02018;solv&#x02019; is the number of solvent accessibility categories, &#x02018;ss&#x02019; is the number of secondary structure types, and &#x02018;u&#x02019; is 1 if unaligned regions are modeled with an additional match state. Average <italic>Q</italic>-scores of four testing datasets with different identity ranges are shown. <italic>Q</italic>-score is the number of correctly aligned residue pairs in the test alignment divided by the total number of aligned residue pairs in the reference alignment. The number of alignments in each testing dataset is shown in parentheses and the identity range in % is specified above the number of alignments. The best results of our models and the best results of other programs are in bold numbers.</p></fn><fn id="tf1-1"><p><sup>a</sup>Trained on DaliLite alignments of SCOP40 domain pairs with 20&#x02013;40% identity.</p></fn><fn id="tf1-2"><p><sup>b</sup>Trained on BAliBASE2.0 pairwise alignments.</p></fn><fn id="tf1-3"><p><sup>c</sup>Our model is statistically better than the best of other programs according to Wilcoxon signed-rank test (<italic>P</italic> &#x0003c; 0.015).</p></fn></table-wrap-foot></table-wrap><table-wrap id="tbl2" position="float"><label>Table 2</label><caption><p>Average alignment scores in tests of multiple sequence alignment programs</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" rowspan="1" colspan="1">Methods/Models</th><th colspan="9" align="left" rowspan="1">Testing datasets</th></tr><tr><th rowspan="1" colspan="1"/><th align="left" rowspan="1" colspan="1">SCOP 0&#x02013;10%</th><th align="left" rowspan="1" colspan="1">SCOP 10&#x02013;15%</th><th align="left" rowspan="1" colspan="1">SCOP 15&#x02013;20%</th><th align="left" rowspan="1" colspan="1">SCOP 20&#x02013;40%</th><th align="left" rowspan="1" colspan="1">SCOP</th><th align="left" rowspan="1" colspan="1">PREFAB</th><th align="left" rowspan="1" colspan="1">SABmark</th><th align="left" rowspan="1" colspan="1">SABmark</th><th align="left" rowspan="1" colspan="1">BAliBASE3.0</th></tr><tr><th rowspan="1" colspan="1"/><th align="left" rowspan="1" colspan="1">(355)</th><th align="left" rowspan="1" colspan="1">(432)</th><th align="left" rowspan="1" colspan="1">(420)</th><th align="left" rowspan="1" colspan="1">(578)</th><th align="left" rowspan="1" colspan="1"> All (1785)</th><th align="left" rowspan="1" colspan="1">(1682)</th><th align="left" rowspan="1" colspan="1">Sup (425)</th><th align="left" rowspan="1" colspan="1">Twi (209)</th><th align="left" rowspan="1" colspan="1">Q/col (218)</th></tr></thead><tbody><tr><td align="left" rowspan="1" colspan="1">HMM_1_1_0</td><td align="left" rowspan="1" colspan="1">0.313</td><td align="left" rowspan="1" colspan="1">0.514<xref ref-type="table-fn" rid="tf2-1">a</xref></td><td align="left" rowspan="1" colspan="1">0.727<xref ref-type="table-fn" rid="tf2-1">a</xref></td><td align="left" rowspan="1" colspan="1">0.885</td><td align="left" rowspan="1" colspan="1">0.644<xref ref-type="table-fn" rid="tf2-1">a</xref></td><td align="left" rowspan="1" colspan="1">0.723<xref ref-type="table-fn" rid="tf2-1">a</xref></td><td align="left" rowspan="1" colspan="1">0.516<xref ref-type="table-fn" rid="tf2-1">a</xref></td><td align="left" rowspan="1" colspan="1">0.193<xref ref-type="table-fn" rid="tf2-1">a</xref></td><td align="left" rowspan="1" colspan="1">0.862/0.551</td></tr><tr><td align="left" rowspan="1" colspan="1">HMM_1_1_1</td><td align="left" rowspan="1" colspan="1">0.313</td><td align="left" rowspan="1" colspan="1">0.512<xref ref-type="table-fn" rid="tf2-1">a</xref></td><td align="left" rowspan="1" colspan="1">0.728<xref ref-type="table-fn" rid="tf2-1">a</xref></td><td align="left" rowspan="1" colspan="1">0.886</td><td align="left" rowspan="1" colspan="1">0.644<xref ref-type="table-fn" rid="tf2-1">a</xref></td><td align="left" rowspan="1" colspan="1">0.724<xref ref-type="table-fn" rid="tf2-1">a</xref></td><td align="left" rowspan="1" colspan="1">0.512<xref ref-type="table-fn" rid="tf2-1">a</xref></td><td align="left" rowspan="1" colspan="1">0.186<xref ref-type="table-fn" rid="tf2-1">a</xref></td><td align="left" rowspan="1" colspan="1">0.861/0.550</td></tr><tr><td align="left" rowspan="1" colspan="1">HMM_3_1_1</td><td align="left" rowspan="1" colspan="1">0.321<xref ref-type="table-fn" rid="tf2-1">a</xref></td><td align="left" rowspan="1" colspan="1">0.514<xref ref-type="table-fn" rid="tf2-1">a</xref></td><td align="left" rowspan="1" colspan="1">0.730<xref ref-type="table-fn" rid="tf2-1">a</xref></td><td align="left" rowspan="1" colspan="1">0.888</td><td align="left" rowspan="1" colspan="1">0.647<xref ref-type="table-fn" rid="tf2-1">a</xref></td><td align="left" rowspan="1" colspan="1">0.726<xref ref-type="table-fn" rid="tf2-1">a</xref></td><td align="left" rowspan="1" colspan="1">0.516<xref ref-type="table-fn" rid="tf2-1">a</xref></td><td align="left" rowspan="1" colspan="1">0.186<xref ref-type="table-fn" rid="tf2-1">a</xref></td><td align="left" rowspan="1" colspan="1">0.862/0.554</td></tr><tr><td align="left" rowspan="1" colspan="1">HMM_1_3_1</td><td align="left" rowspan="1" colspan="1">0.327<xref ref-type="table-fn" rid="tf2-1">a</xref></td><td align="left" rowspan="1" colspan="1">0.518<xref ref-type="table-fn" rid="tf2-1">a</xref></td><td align="left" rowspan="1" colspan="1">0.732<xref ref-type="table-fn" rid="tf2-1">a</xref></td><td align="left" rowspan="1" colspan="1">0.889<xref ref-type="table-fn" rid="tf2-1">a</xref></td><td align="left" rowspan="1" colspan="1">0.650<xref ref-type="table-fn" rid="tf2-1">a</xref></td><td align="left" rowspan="1" colspan="1">0.729<xref ref-type="table-fn" rid="tf2-1">a</xref></td><td align="left" rowspan="1" colspan="1">0.519<xref ref-type="table-fn" rid="tf2-1">a</xref></td><td align="left" rowspan="1" colspan="1">0.194<xref ref-type="table-fn" rid="tf2-1">a</xref></td><td align="left" rowspan="1" colspan="1">0.863/0.554</td></tr><tr><td align="left" rowspan="1" colspan="1">HMM_3_3_1</td><td align="left" rowspan="1" colspan="1"><bold>0.329</bold><xref ref-type="table-fn" rid="tf2-1">a</xref></td><td align="left" rowspan="1" colspan="1"><bold>0.520</bold><xref ref-type="table-fn" rid="tf2-1">a</xref></td><td align="left" rowspan="1" colspan="1"><bold>0.733</bold><xref ref-type="table-fn" rid="tf2-1">a</xref></td><td align="left" rowspan="1" colspan="1"><bold>0.889</bold><xref ref-type="table-fn" rid="tf2-1">a</xref></td><td align="left" rowspan="1" colspan="1"><bold>0.651</bold><xref ref-type="table-fn" rid="tf2-1">a</xref></td><td align="left" rowspan="1" colspan="1"><bold>0.731</bold><xref ref-type="table-fn" rid="tf2-1">a</xref></td><td align="left" rowspan="1" colspan="1"><bold>0.522</bold><xref ref-type="table-fn" rid="tf2-1">a</xref></td><td align="left" rowspan="1" colspan="1"><bold>0.196</bold><xref ref-type="table-fn" rid="tf2-1">a</xref></td><td align="left" rowspan="1" colspan="1"><bold>0.863/0.557</bold></td></tr><tr><td align="left" rowspan="1" colspan="1">ProbCons</td><td align="left" rowspan="1" colspan="1">0.291</td><td align="left" rowspan="1" colspan="1">0.486</td><td align="left" rowspan="1" colspan="1">0.702</td><td align="left" rowspan="1" colspan="1">0.879</td><td align="left" rowspan="1" colspan="1">0.625</td><td align="left" rowspan="1" colspan="1">0.716</td><td align="left" rowspan="1" colspan="1">0.485</td><td align="left" rowspan="1" colspan="1">0.166</td><td align="left" rowspan="1" colspan="1">0.862<xref ref-type="table-fn" rid="tf2-3">c</xref>/0.556<xref ref-type="table-fn" rid="tf2-2">b</xref></td></tr><tr><td align="left" rowspan="1" colspan="1">MAFFT-fftnsi</td><td align="left" rowspan="1" colspan="1">0.283</td><td align="left" rowspan="1" colspan="1">0.472</td><td align="left" rowspan="1" colspan="1">0.673</td><td align="left" rowspan="1" colspan="1">0.865</td><td align="left" rowspan="1" colspan="1">0.608</td><td align="left" rowspan="1" colspan="1">0.7</td><td align="left" rowspan="1" colspan="1">0.45</td><td align="left" rowspan="1" colspan="1">0.147</td><td align="left" rowspan="1" colspan="1">0.829<xref ref-type="table-fn" rid="tf2-3">c</xref>/0.515<xref ref-type="table-fn" rid="tf2-3">c</xref></td></tr><tr><td align="left" rowspan="1" colspan="1">MAFFT-einsi</td><td align="left" rowspan="1" colspan="1">0.293</td><td align="left" rowspan="1" colspan="1">0.498</td><td align="left" rowspan="1" colspan="1">0.71</td><td align="left" rowspan="1" colspan="1">0.882</td><td align="left" rowspan="1" colspan="1">0.631</td><td align="left" rowspan="1" colspan="1">0.72</td><td align="left" rowspan="1" colspan="1">0.502</td><td align="left" rowspan="1" colspan="1">0.175</td><td align="left" rowspan="1" colspan="1">0.866<xref ref-type="table-fn" rid="tf2-3">c</xref>/0.585<xref ref-type="table-fn" rid="tf2-2">b</xref></td></tr><tr><td align="left" rowspan="1" colspan="1">MAFFT-linsi</td><td align="left" rowspan="1" colspan="1">0.301</td><td align="left" rowspan="1" colspan="1"><bold>0.5</bold></td><td align="left" rowspan="1" colspan="1">0.707</td><td align="left" rowspan="1" colspan="1">0.883</td><td align="left" rowspan="1" colspan="1">0.633</td><td align="left" rowspan="1" colspan="1"><bold>0.722</bold></td><td align="left" rowspan="1" colspan="1"><bold>0.51</bold></td><td align="left" rowspan="1" colspan="1"><bold>0.184</bold></td><td align="left" rowspan="1" colspan="1"><bold>0.868<xref ref-type="table-fn" rid="tf2-3">c</xref>/0.586</bold><xref ref-type="table-fn" rid="tf2-2">b</xref></td></tr><tr><td align="left" rowspan="1" colspan="1">MAFFT-ginsi</td><td align="left" rowspan="1" colspan="1"><bold>0.308</bold></td><td align="left" rowspan="1" colspan="1">0.497</td><td align="left" rowspan="1" colspan="1"><bold>0.714</bold></td><td align="left" rowspan="1" colspan="1"><bold>0.888</bold></td><td align="left" rowspan="1" colspan="1"><bold>0.637</bold></td><td align="left" rowspan="1" colspan="1">0.715</td><td align="left" rowspan="1" colspan="1">0.495</td><td align="left" rowspan="1" colspan="1">0.176</td><td align="left" rowspan="1" colspan="1">0.840<xref ref-type="table-fn" rid="tf2-3">c</xref>/0.526<xref ref-type="table-fn" rid="tf2-3">c</xref></td></tr><tr><td align="left" rowspan="1" colspan="1">MUSCLE</td><td align="left" rowspan="1" colspan="1">0.262</td><td align="left" rowspan="1" colspan="1">0.453</td><td align="left" rowspan="1" colspan="1">0.662</td><td align="left" rowspan="1" colspan="1">0.866</td><td align="left" rowspan="1" colspan="1">0.597</td><td align="left" rowspan="1" colspan="1">0.68</td><td align="left" rowspan="1" colspan="1">0.433</td><td align="left" rowspan="1" colspan="1">0.136</td><td align="left" rowspan="1" colspan="1">0.816<xref ref-type="table-fn" rid="tf2-3">c</xref>/0.472<xref ref-type="table-fn" rid="tf2-3">c</xref></td></tr><tr><td align="left" rowspan="1" colspan="1">ClustalW</td><td align="left" rowspan="1" colspan="1">0.21</td><td align="left" rowspan="1" colspan="1">0.357</td><td align="left" rowspan="1" colspan="1">0.566</td><td align="left" rowspan="1" colspan="1">0.798</td><td align="left" rowspan="1" colspan="1">0.519</td><td align="left" rowspan="1" colspan="1">0.617</td><td align="left" rowspan="1" colspan="1">0.39</td><td align="left" rowspan="1" colspan="1">0.127</td><td align="left" rowspan="1" colspan="1">0.749<xref ref-type="table-fn" rid="tf2-3">c</xref>/0.373<xref ref-type="table-fn" rid="tf2-3">c</xref></td></tr></tbody></table><table-wrap-foot><fn><p>The format of the HMM names (&#x02018;HMM_solv_ss_u&#x02019;) is explained in <xref ref-type="table" rid="tbl1">Table 1</xref>. Average <italic>Q</italic>-scores are shown for all the testing datasets. For the BAliBASE3.0 dataset, both the <italic>Q</italic>-score (&#x02018;Q&#x02019;, first number) and column score (&#x02018;col&#x02019;, second number, fraction of entirely correct columns) are shown. The first four testing datasets are representative SCOP40 domain pairs with added homologs. SABmark has &#x02018;superfamily&#x02019; dataset (sup) and &#x02018;twilight zone&#x02019; dataset (twi). The number of alignments in each testing dataset is shown in parentheses and the identity range in % is specified above the number of alignments for SCOP datasets. MUMMALS implementing different HMMs are the first five methods. All sequences pairs are subject to consistency measure in MUMMALS. The best scores of MUMMALS and the best scores of other programs are in bold.</p></fn><fn id="tf2-1"><p><sup>a</sup>MUMMALS with this model is statistically better than the best of other programs according to Wilcoxon signed-rank test (<italic>P</italic> &#x0003c; 0.015).</p></fn><fn id="tf2-2"><p><sup>b</sup>For BAliBASE3.0 test, the difference between MUMMALS with model HMM_1_3_1 or HMM_3_3_1 and this program is not statistically significant (<italic>P</italic> &#x0003e; 0.05) according to Wilcoxon signed-ranks test.</p></fn><fn id="tf2-3"><p><sup>c</sup>For BAliBASE3.0 test, MUMMALS with model HMM_1_3_1 or HMM_3_3_1 is statistically better than this program (<italic>P</italic>-value less than 0.01, except for <italic>Q</italic>-scores of ProbCons, for which <italic>P</italic> = 0.017).</p></fn></table-wrap-foot></table-wrap><table-wrap id="tbl3" position="float"><label>Table 3</label><caption><p>Assessment of multiple sequence alignment programs using reference-independent sequence and structural similarity scores on 1207 representative SCOP40 domain pairs with identity &#x0003c;20%</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" rowspan="1" colspan="1">Method</th><th colspan="6" align="left" rowspan="1">Structural similarity</th><th colspan="2" align="left" rowspan="1">Sequence similarity</th></tr><tr><th rowspan="1" colspan="1"/><th align="left" rowspan="1" colspan="1">DALI <italic>Z</italic>-score</th><th align="left" rowspan="1" colspan="1">GDT-TS</th><th align="left" rowspan="1" colspan="1">TM-score</th><th align="left" rowspan="1" colspan="1">3D-score</th><th align="left" rowspan="1" colspan="1">LBcona</th><th align="left" rowspan="1" colspan="1">LBconb</th><th align="left" rowspan="1" colspan="1">Sequence identity</th><th align="left" rowspan="1" colspan="1">Blosum62 score</th></tr></thead><tbody><tr><td align="left" rowspan="1" colspan="1">HMM_1_1_0</td><td align="left" rowspan="1" colspan="1">0.1178</td><td align="left" rowspan="1" colspan="1">0.2510</td><td align="left" rowspan="1" colspan="1">0.3005</td><td align="left" rowspan="1" colspan="1">0.2499<xref ref-type="table-fn" rid="tf3-1">a</xref></td><td align="left" rowspan="1" colspan="1">0.2181</td><td align="left" rowspan="1" colspan="1">0.2828</td><td align="left" rowspan="1" colspan="1">0.0953</td><td align="left" rowspan="1" colspan="1">0.1687</td></tr><tr><td align="left" rowspan="1" colspan="1">HMM_1_1_1</td><td align="left" rowspan="1" colspan="1">0.1200<xref ref-type="table-fn" rid="tf3-1">a</xref></td><td align="left" rowspan="1" colspan="1">0.2519<xref ref-type="table-fn" rid="tf3-1">a</xref></td><td align="left" rowspan="1" colspan="1">0.3010<xref ref-type="table-fn" rid="tf3-1">a</xref></td><td align="left" rowspan="1" colspan="1">0.2514<xref ref-type="table-fn" rid="tf3-1">a</xref></td><td align="left" rowspan="1" colspan="1">0.2190<xref ref-type="table-fn" rid="tf3-1">a</xref></td><td align="left" rowspan="1" colspan="1">0.2838</td><td align="left" rowspan="1" colspan="1"><bold>0.0955</bold></td><td align="left" rowspan="1" colspan="1"><bold>0.1688</bold></td></tr><tr><td align="left" rowspan="1" colspan="1">HMM_3_1_1</td><td align="left" rowspan="1" colspan="1">0.1217<xref ref-type="table-fn" rid="tf3-1">a</xref></td><td align="left" rowspan="1" colspan="1">0.2540<xref ref-type="table-fn" rid="tf3-1">a</xref></td><td align="left" rowspan="1" colspan="1">0.3034<xref ref-type="table-fn" rid="tf3-1">a</xref></td><td align="left" rowspan="1" colspan="1">0.2532<xref ref-type="table-fn" rid="tf3-1">a</xref></td><td align="left" rowspan="1" colspan="1">0.2215<xref ref-type="table-fn" rid="tf3-1">a</xref></td><td align="left" rowspan="1" colspan="1">0.2872<xref ref-type="table-fn" rid="tf3-1">a</xref></td><td align="left" rowspan="1" colspan="1">0.0938</td><td align="left" rowspan="1" colspan="1">0.1665</td></tr><tr><td align="left" rowspan="1" colspan="1">HMM_1_3_1</td><td align="left" rowspan="1" colspan="1">0.1226<xref ref-type="table-fn" rid="tf3-1">a</xref></td><td align="left" rowspan="1" colspan="1">0.2564<xref ref-type="table-fn" rid="tf3-1">a</xref></td><td align="left" rowspan="1" colspan="1">0.3061<xref ref-type="table-fn" rid="tf3-1">a</xref></td><td align="left" rowspan="1" colspan="1">0.2557<xref ref-type="table-fn" rid="tf3-1">a</xref></td><td align="left" rowspan="1" colspan="1">0.2230<xref ref-type="table-fn" rid="tf3-1">a</xref></td><td align="left" rowspan="1" colspan="1">0.2892<xref ref-type="table-fn" rid="tf3-1">a</xref></td><td align="left" rowspan="1" colspan="1">0.0944</td><td align="left" rowspan="1" colspan="1">0.1662</td></tr><tr><td align="left" rowspan="1" colspan="1">HMM_3_3_1</td><td align="left" rowspan="1" colspan="1"><bold>0.1231</bold><xref ref-type="table-fn" rid="tf3-1">a</xref></td><td align="left" rowspan="1" colspan="1"><bold>0.2570</bold><xref ref-type="table-fn" rid="tf3-1">a</xref></td><td align="left" rowspan="1" colspan="1"><bold>0.3070</bold><xref ref-type="table-fn" rid="tf3-1">a</xref></td><td align="left" rowspan="1" colspan="1"><bold>0.2563</bold><xref ref-type="table-fn" rid="tf3-1">a</xref></td><td align="left" rowspan="1" colspan="1"><bold>0.2240</bold><xref ref-type="table-fn" rid="tf3-1">a</xref></td><td align="left" rowspan="1" colspan="1"><bold>0.2909</bold><xref ref-type="table-fn" rid="tf3-1">a</xref></td><td align="left" rowspan="1" colspan="1">0.0932</td><td align="left" rowspan="1" colspan="1">0.1651</td></tr><tr><td align="left" rowspan="1" colspan="1">ProbCons</td><td align="left" rowspan="1" colspan="1">0.1003</td><td align="left" rowspan="1" colspan="1">0.2324</td><td align="left" rowspan="1" colspan="1">0.2767</td><td align="left" rowspan="1" colspan="1">0.2307</td><td align="left" rowspan="1" colspan="1">0.2060</td><td align="left" rowspan="1" colspan="1">0.2670</td><td align="left" rowspan="1" colspan="1"><bold>0.0983</bold></td><td align="left" rowspan="1" colspan="1">0.1719</td></tr><tr><td align="left" rowspan="1" colspan="1">MAFFT-fftnsi</td><td align="left" rowspan="1" colspan="1">0.0982</td><td align="left" rowspan="1" colspan="1">0.2333</td><td align="left" rowspan="1" colspan="1">0.2814</td><td align="left" rowspan="1" colspan="1">0.2297</td><td align="left" rowspan="1" colspan="1">0.2004</td><td align="left" rowspan="1" colspan="1">0.2632</td><td align="left" rowspan="1" colspan="1">0.0917</td><td align="left" rowspan="1" colspan="1">0.1621</td></tr><tr><td align="left" rowspan="1" colspan="1">MAFFT-einsi</td><td align="left" rowspan="1" colspan="1"><bold>0.1136</bold></td><td align="left" rowspan="1" colspan="1">0.2425</td><td align="left" rowspan="1" colspan="1">0.2886</td><td align="left" rowspan="1" colspan="1">0.2410</td><td align="left" rowspan="1" colspan="1">0.2105</td><td align="left" rowspan="1" colspan="1">0.2763</td><td align="left" rowspan="1" colspan="1">0.0940</td><td align="left" rowspan="1" colspan="1">0.1666</td></tr><tr><td align="left" rowspan="1" colspan="1">MAFFT-linsi</td><td align="left" rowspan="1" colspan="1">0.1135</td><td align="left" rowspan="1" colspan="1"><bold>0.2485</bold></td><td align="left" rowspan="1" colspan="1">0.2982</td><td align="left" rowspan="1" colspan="1"><bold>0.2467</bold></td><td align="left" rowspan="1" colspan="1">0.2143</td><td align="left" rowspan="1" colspan="1"><bold>0.2820</bold></td><td align="left" rowspan="1" colspan="1">0.0923</td><td align="left" rowspan="1" colspan="1">0.1632</td></tr><tr><td align="left" rowspan="1" colspan="1">MAFFT-ginsi</td><td align="left" rowspan="1" colspan="1">0.1126</td><td align="left" rowspan="1" colspan="1">0.2454</td><td align="left" rowspan="1" colspan="1"><bold>0.2960</bold></td><td align="left" rowspan="1" colspan="1">0.2429</td><td align="left" rowspan="1" colspan="1"><bold>0.2152</bold></td><td align="left" rowspan="1" colspan="1">0.2803</td><td align="left" rowspan="1" colspan="1">0.0972</td><td align="left" rowspan="1" colspan="1"><bold>0.1725</bold></td></tr><tr><td align="left" rowspan="1" colspan="1">MUSCLE</td><td align="left" rowspan="1" colspan="1">0.0980</td><td align="left" rowspan="1" colspan="1">0.2297</td><td align="left" rowspan="1" colspan="1">0.2777</td><td align="left" rowspan="1" colspan="1">0.2266</td><td align="left" rowspan="1" colspan="1">0.1941</td><td align="left" rowspan="1" colspan="1">0.2535</td><td align="left" rowspan="1" colspan="1">0.0939</td><td align="left" rowspan="1" colspan="1">0.1686</td></tr><tr><td align="left" rowspan="1" colspan="1">ClustalW</td><td align="left" rowspan="1" colspan="1">0.0723</td><td align="left" rowspan="1" colspan="1">0.1916</td><td align="left" rowspan="1" colspan="1">0.2318</td><td align="left" rowspan="1" colspan="1">0.1876</td><td align="left" rowspan="1" colspan="1">0.1551</td><td align="left" rowspan="1" colspan="1">0.2030</td><td align="left" rowspan="1" colspan="1">0.0733</td><td align="left" rowspan="1" colspan="1">0.1344</td></tr></tbody></table><table-wrap-foot><fn><p>The first five methods are MUMMALS implementing different HMMs. The format of the HMM names (&#x02018;HMM_solv_ss_u&#x02019;) is explained in <xref ref-type="table" rid="tbl1">Table 1</xref>. The best scores of MUMMALS and the best scores of other programs (ProbCons, MAFFT with different options, MUSCLE, ClustalW) are in bold.</p></fn><fn id="tf3-1"><p><sup>a</sup>MUMMALS with this model is statistically better than the best of other programs according to Wilcoxon signed-rank test (<italic>P</italic> &#x0003c; 0.01).</p></fn></table-wrap-foot></table-wrap><table-wrap id="tbl4" position="float"><label>Table 4</label><caption><p>Number of large <italic>Q</italic>-score or TM-score differences (no less than 0.1) among the multiple sequence alignment programs on 1207 representative SCOP40 domain pairs with identity &#x0003c;20%</p></caption><table frame="hsides" rules="groups"><thead><tr><th rowspan="1" colspan="1"/><th align="left" rowspan="1" colspan="1">HMM_1_1_0</th><th align="left" rowspan="1" colspan="1">HMM_1_1_1</th><th align="left" rowspan="1" colspan="1">HMM_3_1_1</th><th align="left" rowspan="1" colspan="1">HMM_1_3_1</th><th align="left" rowspan="1" colspan="1">HMM_3_3_1</th><th align="left" rowspan="1" colspan="1">ProbCons</th><th align="left" rowspan="1" colspan="1">MAFFT-fftnsi</th><th align="left" rowspan="1" colspan="1">MAFFT-einsi</th><th align="left" rowspan="1" colspan="1">MAFFT-linsi</th><th align="left" rowspan="1" colspan="1">MAFFT-ginsi</th><th align="left" rowspan="1" colspan="1">MUSCLE</th><th align="left" rowspan="1" colspan="1">ClustalW</th></tr></thead><tbody><tr><td align="left" rowspan="1" colspan="1">HMM_1_1_0</td><td align="left" rowspan="1" colspan="1">&#x02014;</td><td align="left" rowspan="1" colspan="1">13/8</td><td align="left" rowspan="1" colspan="1">41/18</td><td align="left" rowspan="1" colspan="1">29/15</td><td align="left" rowspan="1" colspan="1"><bold>45/24</bold></td><td align="left" rowspan="1" colspan="1">50/157</td><td align="left" rowspan="1" colspan="1">105/191</td><td align="left" rowspan="1" colspan="1">108/163</td><td align="left" rowspan="1" colspan="1">119/127</td><td align="left" rowspan="1" colspan="1">85/102</td><td align="left" rowspan="1" colspan="1">92/208</td><td align="left" rowspan="1" colspan="1">73/399</td></tr><tr><td align="left" rowspan="1" colspan="1">HMM_1_1_1</td><td align="left" rowspan="1" colspan="1">14/14</td><td align="left" rowspan="1" colspan="1">&#x02014;</td><td align="left" rowspan="1" colspan="1">35/16</td><td align="left" rowspan="1" colspan="1">18/6</td><td align="left" rowspan="1" colspan="1"><bold>38/24</bold></td><td align="left" rowspan="1" colspan="1">53/156</td><td align="left" rowspan="1" colspan="1">100/189</td><td align="left" rowspan="1" colspan="1">103/171</td><td align="left" rowspan="1" colspan="1">109/124</td><td align="left" rowspan="1" colspan="1">90/110</td><td align="left" rowspan="1" colspan="1">91/209</td><td align="left" rowspan="1" colspan="1">76/397</td></tr><tr><td align="left" rowspan="1" colspan="1">HMM_3_1_1</td><td align="left" rowspan="1" colspan="1">28/45</td><td align="left" rowspan="1" colspan="1">22/40</td><td align="left" rowspan="1" colspan="1">&#x02014;</td><td align="left" rowspan="1" colspan="1">16/24</td><td align="left" rowspan="1" colspan="1"><bold>4/5</bold></td><td align="left" rowspan="1" colspan="1">39/164</td><td align="left" rowspan="1" colspan="1">86/211</td><td align="left" rowspan="1" colspan="1">101/183</td><td align="left" rowspan="1" colspan="1">109/135</td><td align="left" rowspan="1" colspan="1">81/124</td><td align="left" rowspan="1" colspan="1">82/225</td><td align="left" rowspan="1" colspan="1">63/418</td></tr><tr><td align="left" rowspan="1" colspan="1">HMM_1_3_1</td><td align="left" rowspan="1" colspan="1">19/29</td><td align="left" rowspan="1" colspan="1">9/22</td><td align="left" rowspan="1" colspan="1">26/20</td><td align="left" rowspan="1" colspan="1">&#x02014;</td><td align="left" rowspan="1" colspan="1"><bold>25/19</bold></td><td align="left" rowspan="1" colspan="1">46/155</td><td align="left" rowspan="1" colspan="1">90/202</td><td align="left" rowspan="1" colspan="1">107/169</td><td align="left" rowspan="1" colspan="1">110/124</td><td align="left" rowspan="1" colspan="1">89/116</td><td align="left" rowspan="1" colspan="1">92/214</td><td align="left" rowspan="1" colspan="1">70/408</td></tr><tr><td align="left" rowspan="1" colspan="1">HMM_3_3_1</td><td align="left" rowspan="1" colspan="1"><bold>29/57</bold></td><td align="left" rowspan="1" colspan="1"><bold>22/54</bold></td><td align="left" rowspan="1" colspan="1"><bold>6/17</bold></td><td align="left" rowspan="1" colspan="1"><bold>20/36</bold></td><td align="left" rowspan="1" colspan="1">&#x02014;</td><td align="left" rowspan="1" colspan="1"><bold>38/169</bold></td><td align="left" rowspan="1" colspan="1"><bold>85/207</bold></td><td align="left" rowspan="1" colspan="1"><bold>97/185</bold></td><td align="left" rowspan="1" colspan="1"><bold>111/138</bold></td><td align="left" rowspan="1" colspan="1"><bold>82/128</bold></td><td align="left" rowspan="1" colspan="1"><bold>82/227</bold></td><td align="left" rowspan="1" colspan="1"><bold>59/431</bold></td></tr><tr><td align="left" rowspan="1" colspan="1">ProbCons</td><td align="left" rowspan="1" colspan="1">187/76</td><td align="left" rowspan="1" colspan="1">186/80</td><td align="left" rowspan="1" colspan="1">203/67</td><td align="left" rowspan="1" colspan="1">189/73</td><td align="left" rowspan="1" colspan="1"><bold>201/62</bold></td><td align="left" rowspan="1" colspan="1">&#x02014;</td><td align="left" rowspan="1" colspan="1">149/133</td><td align="left" rowspan="1" colspan="1">152/98</td><td align="left" rowspan="1" colspan="1">172/80</td><td align="left" rowspan="1" colspan="1">162/76</td><td align="left" rowspan="1" colspan="1">162/169</td><td align="left" rowspan="1" colspan="1">110/336</td></tr><tr><td align="left" rowspan="1" colspan="1">MAFFT-fftnsi</td><td align="left" rowspan="1" colspan="1">334/123</td><td align="left" rowspan="1" colspan="1">334/118</td><td align="left" rowspan="1" colspan="1">354/113</td><td align="left" rowspan="1" colspan="1">344/115</td><td align="left" rowspan="1" colspan="1"><bold>352/115</bold></td><td align="left" rowspan="1" colspan="1">242/154</td><td align="left" rowspan="1" colspan="1">&#x02014;</td><td align="left" rowspan="1" colspan="1">123/98</td><td align="left" rowspan="1" colspan="1">137/71</td><td align="left" rowspan="1" colspan="1">153/76</td><td align="left" rowspan="1" colspan="1">115/143</td><td align="left" rowspan="1" colspan="1">88/342</td></tr><tr><td align="left" rowspan="1" colspan="1">MAFFT-einsi</td><td align="left" rowspan="1" colspan="1">234/156</td><td align="left" rowspan="1" colspan="1">232/152</td><td align="left" rowspan="1" colspan="1">260/147</td><td align="left" rowspan="1" colspan="1">247/152</td><td align="left" rowspan="1" colspan="1"><bold>258/138</bold></td><td align="left" rowspan="1" colspan="1">152/186</td><td align="left" rowspan="1" colspan="1">116/225</td><td align="left" rowspan="1" colspan="1">&#x02014;</td><td align="left" rowspan="1" colspan="1">80/37</td><td align="left" rowspan="1" colspan="1">133/96</td><td align="left" rowspan="1" colspan="1">134/193</td><td align="left" rowspan="1" colspan="1">93/369</td></tr><tr><td align="left" rowspan="1" colspan="1">MAFFT-linsi</td><td align="left" rowspan="1" colspan="1">206/138</td><td align="left" rowspan="1" colspan="1">204/140</td><td align="left" rowspan="1" colspan="1">237/131</td><td align="left" rowspan="1" colspan="1">219/143</td><td align="left" rowspan="1" colspan="1"><bold>239/128</bold></td><td align="left" rowspan="1" colspan="1">133/188</td><td align="left" rowspan="1" colspan="1">87/207</td><td align="left" rowspan="1" colspan="1">62/82</td><td align="left" rowspan="1" colspan="1">&#x02014;</td><td align="left" rowspan="1" colspan="1">85/98</td><td align="left" rowspan="1" colspan="1">93/196</td><td align="left" rowspan="1" colspan="1">60/387</td></tr><tr><td align="left" rowspan="1" colspan="1">MAFFT-ginsi</td><td align="left" rowspan="1" colspan="1">160/124</td><td align="left" rowspan="1" colspan="1">162/124</td><td align="left" rowspan="1" colspan="1">192/119</td><td align="left" rowspan="1" colspan="1">176/126</td><td align="left" rowspan="1" colspan="1"><bold>199/117</bold></td><td align="left" rowspan="1" colspan="1">113/184</td><td align="left" rowspan="1" colspan="1">109/253</td><td align="left" rowspan="1" colspan="1">129/158</td><td align="left" rowspan="1" colspan="1">111/132</td><td align="left" rowspan="1" colspan="1">&#x02014;</td><td align="left" rowspan="1" colspan="1">90/185</td><td align="left" rowspan="1" colspan="1">67/395</td></tr><tr><td align="left" rowspan="1" colspan="1">MUSCLE</td><td align="left" rowspan="1" colspan="1">370/94</td><td align="left" rowspan="1" colspan="1">374/94</td><td align="left" rowspan="1" colspan="1">390/83</td><td align="left" rowspan="1" colspan="1">384/90</td><td align="left" rowspan="1" colspan="1"><bold>401/83</bold></td><td align="left" rowspan="1" colspan="1">302/138</td><td align="left" rowspan="1" colspan="1">218/136</td><td align="left" rowspan="1" colspan="1">309/134</td><td align="left" rowspan="1" colspan="1">295/110</td><td align="left" rowspan="1" colspan="1">327/106</td><td align="left" rowspan="1" colspan="1">&#x02014;</td><td align="left" rowspan="1" colspan="1">75/288</td></tr><tr><td align="left" rowspan="1" colspan="1">ClustalW</td><td align="left" rowspan="1" colspan="1">627/67</td><td align="left" rowspan="1" colspan="1">628/66</td><td align="left" rowspan="1" colspan="1">645/60</td><td align="left" rowspan="1" colspan="1">645/65</td><td align="left" rowspan="1" colspan="1"><bold>649/55</bold></td><td align="left" rowspan="1" colspan="1">559/103</td><td align="left" rowspan="1" colspan="1">498/96</td><td align="left" rowspan="1" colspan="1">582/91</td><td align="left" rowspan="1" colspan="1">585/70</td><td align="left" rowspan="1" colspan="1">600/76</td><td align="left" rowspan="1" colspan="1">449/100</td><td align="left" rowspan="1" colspan="1">&#x02014;</td></tr></tbody></table><table-wrap-foot><fn><p>The first five methods are MUMMALS implementing different HMMs. The format of the HMM names (&#x02018;HMM_solv_ss_u&#x02019;) is explained in <xref ref-type="table" rid="tbl1">Table 1</xref>. Each none-diagonal cell has two numbers separated by a slash. The first number is the number of cases where the alignment quality score of the program listed to the left (in a row) is inferior to that of the program listed above (in a column) by 0.1 or more. The second number is the number of cases where the score of the &#x02018;row&#x02019; program is better than that of the &#x02018;column&#x02019; program by 0.1 or more. The alignment quality scores in the lower triangle and upper triangle are <italic>Q</italic>-scores and weighted and normalized TM-scores, respectively. Comparisons of MUMMALS with the best model (HMM_3_3_1) with other programs are highlighted in bold.</p></fn></table-wrap-foot></table-wrap></sec></back></article>





