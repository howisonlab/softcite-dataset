{
    "level": "sentence",
    "abstract": [
        {
            "text": "A software tool, computing observed and expected upper limits on Poissonian process rates using a hybrid frequentist-Bayesian CL s method, is presented. ",
            "paragraph_rank": 2,
            "section_rank": 1
        },
        {
            "text": "This tool can be used for simple counting experiments where only signal, background and observed yields are provided or for multi-bin experiments where binned distributions of discriminating variables are provided. ",
            "paragraph_rank": 2,
            "section_rank": 1
        },
        {
            "text": "It allows the combination of several channels and takes into account statistical and systematic uncertainties, as well as correlations of systematic uncertainties between channels. ",
            "paragraph_rank": 2,
            "section_rank": 1
        },
        {
            "text": "It has been validated against other software tools and analytical calculations, for several realistic cases.",
            "paragraph_rank": 2,
            "section_rank": 1
        }
    ],
    "body_text": [
        {
            "text": "Introduction",
            "section_rank": 2
        },
        {
            "text": "In a physics experiment, the result must sometimes be interpreted in terms of upper limits on the rate of a particular physical process of interest, dubbed signal. ",
            "section": "Introduction",
            "paragraph_rank": 3,
            "section_rank": 2
        },
        {
            "text": "OpTHyLiC 1 offers an easy-to-use hybrid frequentist-Bayesian solution to set upper limits for an arbitrary number of channels and backgrounds, using the CL s method. ",
            "section": "Introduction",
            "paragraph_rank": 3,
            "section_rank": 2
        },
        {
            "text": "It can be used for simple counting experiments where only signal, background and observed yields are provided as well as for multi-bin experiments where binned distributions of discriminating variables are provided. ",
            "section": "Introduction",
            "paragraph_rank": 3,
            "section_rank": 2
        },
        {
            "text": "Statistical and systematic uncertainties are taken into account in a Bayesian way, and correlations of systematic uncertainties across backgrounds and channels are properly accounted for. ",
            "section": "Introduction",
            "paragraph_rank": 3,
            "section_rank": 2
        },
        {
            "text": "OpTHyLiC can be downloaded from [1].",
            "section": "Introduction",
            "paragraph_rank": 3,
            "section_rank": 2,
            "ref_spans": [
                {
                    "start": 32,
                    "end": 35,
                    "type": "bibr",
                    "text": "[1]"
                }
            ]
        },
        {
            "text": "Other tools such as McLimit [2] or RooStats [3] provide the ability to compute limits using the hybrid method. ",
            "section": "Introduction",
            "paragraph_rank": 4,
            "section_rank": 2,
            "ref_spans": [
                {
                    "start": 28,
                    "end": 31,
                    "type": "bibr",
                    "ref_id": "b1",
                    "text": "[2]"
                }
            ],
            "entity_spans": [
                {
                    "start": 20,
                    "end": 28,
                    "type": "software",
                    "rawForm": "McLimit",
                    "resp": "service",
                    "id": "software-simple-s1"
                },
                {
                    "start": 35,
                    "end": 44,
                    "type": "software",
                    "rawForm": "RooStats",
                    "resp": "service",
                    "id": "software-simple-s2"
                }
            ]
        },
        {
            "text": "However, OpTHyLiC was specifically optimized for this method: it is lightweight, simple and faster than the tools most often used currently (even in complex cases with many backgrounds, channels and nuisance parameters, limits are typically computed in one minute or less). ",
            "section": "Introduction",
            "paragraph_rank": 4,
            "section_rank": 2
        },
        {
            "text": "Furthermore, it provides several options to configure the treatment of statistical and systematic uncertainties. ",
            "section": "Introduction",
            "paragraph_rank": 4,
            "section_rank": 2
        },
        {
            "text": "OpTHyLiC does not support profiling of uncertainties; the motivations for this choice are discussed in the next section.",
            "section": "Introduction",
            "paragraph_rank": 4,
            "section_rank": 2
        },
        {
            "text": "The document is organized as follows. ",
            "section": "Introduction",
            "paragraph_rank": 5,
            "section_rank": 2
        },
        {
            "text": "Typical situations in which OpTHyLiC can be used are described in Sec. ",
            "section": "Introduction",
            "paragraph_rank": 5,
            "section_rank": 2
        },
        {
            "text": "2. The notations used in this paper are introduced in Sec. ",
            "section": "Introduction",
            "paragraph_rank": 5,
            "section_rank": 2
        },
        {
            "text": "3. The statistical method implemented in OpTHyLiC is described in Sec. ",
            "section": "Introduction",
            "paragraph_rank": 5,
            "section_rank": 2
        },
        {
            "text": "4. The software is described in Sec. 5 and its validation in Sec. 6.",
            "section": "Introduction",
            "paragraph_rank": 5,
            "section_rank": 2
        },
        {
            "text": "Purpose of the software",
            "section_rank": 3
        },
        {
            "text": "The OpTHyLiC software was written in order to provide users with a lightweight, simple and fast tool to compute upper limits. ",
            "section": "Purpose of the software",
            "paragraph_rank": 6,
            "section_rank": 3,
            "entity_spans": [
                {
                    "start": 4,
                    "end": 13,
                    "type": "software",
                    "rawForm": "OpTHyLiC",
                    "resp": "service",
                    "id": "software-simple-s3"
                }
            ]
        },
        {
            "text": "It should be seen as a complementary tool to the several existing ones. ",
            "section": "Purpose of the software",
            "paragraph_rank": 6,
            "section_rank": 3
        },
        {
            "text": "Because of the absence of profiling, it does not provide the best upper limits in cases where data capable of strongly constraining nuisance parameters exist. ",
            "section": "Purpose of the software",
            "paragraph_rank": 6,
            "section_rank": 3
        },
        {
            "text": "In such cases, users should prefer other tools like pure frequentist ones (which implement profiling of uncertainties) or pure Bayesian ones. ",
            "section": "Purpose of the software",
            "paragraph_rank": 6,
            "section_rank": 3
        },
        {
            "text": "OpTHyLiC is more specifically dedicated to situations where no such data exist or to situations where pure frequentist or pure Bayesian tools are too slow for the users' needs. ",
            "section": "Purpose of the software",
            "paragraph_rank": 6,
            "section_rank": 3,
            "entity_spans": [
                {
                    "start": 0,
                    "end": 8,
                    "type": "software",
                    "rawForm": "OpTHyLiC",
                    "resp": "service",
                    "id": "software-simple-s4"
                }
            ]
        },
        {
            "text": "In the former situation, it is often observed that pure frequentist, pure Bayesian and hybrid approaches yield similar limits. ",
            "section": "Purpose of the software",
            "paragraph_rank": 6,
            "section_rank": 3
        },
        {
            "text": "It can therefore be advantageous to use OpTHyLiC rather than tools that are more complicated to handle and slower. ",
            "section": "Purpose of the software",
            "paragraph_rank": 6,
            "section_rank": 3,
            "entity_spans": [
                {
                    "start": 40,
                    "end": 48,
                    "type": "software",
                    "rawForm": "OpTHyLiC",
                    "resp": "service",
                    "id": "software-simple-s5"
                }
            ]
        },
        {
            "text": "The latter situation occurs for example when the expected number of events is small and asymptotic properties of the profile likelihood ratio can't be used to speed up pure frequentist calculations (in this case pseudoexperiments must be drawn in order to perform the hypothesis tests which can be very time consuming when profiling a large number uncertainties). ",
            "section": "Purpose of the software",
            "paragraph_rank": 6,
            "section_rank": 3
        },
        {
            "text": "It can also occur when the aim is rather to perform an optimisation of the analysis (to determine the best event selection criteria or the best histogram binning for instance) than to compute final limits. ",
            "section": "Purpose of the software",
            "paragraph_rank": 6,
            "section_rank": 3
        },
        {
            "text": "Such optimisation studies often do not require high accuracy and can be extremely time consuming or even impossible to do with profiling.",
            "section": "Purpose of the software",
            "paragraph_rank": 6,
            "section_rank": 3
        },
        {
            "text": "OpTHyLiC can be used by physicists needing a tool relatively easy to master that provides reliable results taking into account several analysis channels and/or systematic uncertainties. ",
            "section": "Purpose of the software",
            "paragraph_rank": 7,
            "section_rank": 3
        },
        {
            "text": "It can for example be useful to perform phenomenological sensitivity studies or to recast published searches with newer theoretical models.",
            "section": "Purpose of the software",
            "paragraph_rank": 7,
            "section_rank": 3
        },
        {
            "text": "OpTHyLiC can also be used by beginners in statistics willing to perform limit calculations in realistic cases for the first time without having to understand first all the details and subtleties of profiling in pure frequentist calculations. ",
            "section": "Purpose of the software",
            "paragraph_rank": 8,
            "section_rank": 3
        },
        {
            "text": "Those aiming at understanding the details and subtleties of pure frequentist calculations can also use OpTHyLiC as an intermediate step towards that final objective. ",
            "section": "Purpose of the software",
            "paragraph_rank": 8,
            "section_rank": 3
        },
        {
            "text": "Many of the quantities, definitions and concepts presented in this paper and used in OpTHyLiC are indeed also used by tools like HistFactory and RooStats to perform pure frequentist calculations. ",
            "section": "Purpose of the software",
            "paragraph_rank": 8,
            "section_rank": 3
        },
        {
            "text": "Even though OpTHyLiC was originally designed for high energy physics it can also be used in other fields such as nuclear measurements or medical physics. ",
            "section": "Purpose of the software",
            "paragraph_rank": 8,
            "section_rank": 3
        },
        {
            "text": "Many measurements performed in such fields are poissonian and can be modelled with the OpTHyLiC statistical model. ",
            "section": "Purpose of the software",
            "paragraph_rank": 8,
            "section_rank": 3
        },
        {
            "text": "OpTHyLiC can therefore be used to perform statistical inference and gain valuable informations about physics parameters relevant in those fields too.",
            "section": "Purpose of the software",
            "paragraph_rank": 8,
            "section_rank": 3
        },
        {
            "text": "Notations and definitions",
            "section_rank": 4
        },
        {
            "text": "The following notations will be used throughout the document:",
            "section": "Notations and definitions",
            "paragraph_rank": 9,
            "section_rank": 4
        },
        {
            "text": "\u2022 \u00b5: signal strength modifier, defined as the tested signal rate divided by a fixed reference signal rate value (such as obtained from a theoretical prediction);",
            "section": "Notations and definitions",
            "paragraph_rank": 10,
            "section_rank": 4
        },
        {
            "text": "\u2022 \u00b5 up : upper limit on the signal strength modifier;",
            "section": "Notations and definitions",
            "paragraph_rank": 11,
            "section_rank": 4
        },
        {
            "text": "\u2022 n: number of channels;",
            "section": "Notations and definitions",
            "paragraph_rank": 12,
            "section_rank": 4
        },
        {
            "text": "\u2022 s c\u03b8 : event yield for signal process in channel c (c \u2208 [1, n]) and bin \u03b8;",
            "section": "Notations and definitions",
            "paragraph_rank": 13,
            "section_rank": 4
        },
        {
            "text": "\u2022 s nom c\u03b8 : nominal reference event yield for signal process in channel c and bin \u03b8;",
            "section": "Notations and definitions",
            "paragraph_rank": 14,
            "section_rank": 4
        },
        {
            "text": "\u2022 \u03c3 cl : absolute systematic uncertainty for signal process in channel c and bin \u03b8, due to the finite size of the control sample;",
            "section": "Notations and definitions",
            "paragraph_rank": 15,
            "section_rank": 4
        },
        {
            "text": "\u2022 b ci\u03b8 : event yield for type i background process in channel c and bin \u03b8;",
            "section": "Notations and definitions",
            "paragraph_rank": 16,
            "section_rank": 4
        },
        {
            "text": "\u2022 b nom ci\u03b8 : nominal event yield for type i background process in channel c and bin \u03b8;",
            "section": "Notations and definitions",
            "paragraph_rank": 17,
            "section_rank": 4
        },
        {
            "text": "\u2022 b nom c\u03b8 = i\u2208backgrounds b nom ci\u03b8 : total nominal yield for background processes in channel c and bin \u03b8;",
            "section": "Notations and definitions",
            "paragraph_rank": 18,
            "section_rank": 4
        },
        {
            "text": "\u2022 \u03c3 ci\u03b8 : absolute systematic uncertainty for type i background process in channel c and bin \u03b8, due to the finite size of the control sample;",
            "section": "Notations and definitions",
            "paragraph_rank": 19,
            "section_rank": 4
        },
        {
            "text": "\u2022 N c\u03b8 : event yield in channel c and bin \u03b8;",
            "section": "Notations and definitions",
            "paragraph_rank": 20,
            "section_rank": 4
        },
        {
            "text": "\u2022 N obs c\u03b8 : event yield actually observed in the data or the pseudo-data in channel c and bin \u03b8.",
            "section": "Notations and definitions",
            "paragraph_rank": 21,
            "section_rank": 4
        },
        {
            "text": "A channel corresponds to a region enriched in signal events (also called signal region). ",
            "section": "Notations and definitions",
            "paragraph_rank": 22,
            "section_rank": 4
        },
        {
            "text": "In the case of multi-bin experiments, the user must provide binned distributions (or histograms) for each channel, background and signal. ",
            "section": "Notations and definitions",
            "paragraph_rank": 22,
            "section_rank": 4
        },
        {
            "text": "Bins of these distributions are referred to by the index \u03b8. ",
            "section": "Notations and definitions",
            "paragraph_rank": 22,
            "section_rank": 4
        },
        {
            "text": "For counting experiments, only yields for each background and signal in each channel are needed. ",
            "section": "Notations and definitions",
            "paragraph_rank": 22,
            "section_rank": 4
        },
        {
            "text": "In this case, the index \u03b8 is irrelevant and is discarded.",
            "section": "Notations and definitions",
            "paragraph_rank": 22,
            "section_rank": 4
        },
        {
            "text": "Method description",
            "section_rank": 5
        },
        {
            "text": "OpTHyLiC implements the CL s method [4]. ",
            "section": "Method description",
            "paragraph_rank": 23,
            "section_rank": 5,
            "ref_spans": [
                {
                    "start": 36,
                    "end": 39,
                    "type": "bibr",
                    "ref_id": "b2",
                    "text": "[4]"
                }
            ]
        },
        {
            "text": "Pseudo-experiments are generated and the distribution of a test statistic is determined under both signal plus background and background only hypotheses. ",
            "section": "Method description",
            "paragraph_rank": 23,
            "section_rank": 5
        },
        {
            "text": "From these distributions, CL s is computed and the upper limit on the signal strength modifier \u00b5 up is found by solving the equation",
            "section": "Method description",
            "paragraph_rank": 23,
            "section_rank": 5
        },
        {
            "text": "for a fixed value of \u03b1 which is set depending on the chosen confidence level 1 \u2212 \u03b1. ",
            "section": "Method description",
            "paragraph_rank": 24,
            "section_rank": 5
        },
        {
            "text": "For 95% confidence level upper limits, \u03b1 = 0.05. ",
            "section": "Method description",
            "paragraph_rank": 24,
            "section_rank": 5
        },
        {
            "text": "The test statistic used is the ratio of likelihoods under signal plus background and background only hypotheses:",
            "section": "Method description",
            "paragraph_rank": 24,
            "section_rank": 5
        },
        {
            "text": "The general form of the likelihood is discussed in Sec. 4.1. ",
            "section": "Method description",
            "paragraph_rank": 25,
            "section_rank": 5
        },
        {
            "text": "The statistical and systematic uncertainties are included by the use of nuisance parameters, as detailed in Sec. 4.2 and 4.3, respectively. ",
            "section": "Method description",
            "paragraph_rank": 25,
            "section_rank": 5
        },
        {
            "text": "These uncertainties are accounted for in a Bayesian way: the inference of the observed upper limit is performed from pseudo-experiments using the distribution of the likelihood marginalised over the nuisance parameters, as explained in Sec. 4.4. ",
            "section": "Method description",
            "paragraph_rank": 25,
            "section_rank": 5
        },
        {
            "text": "The procedure for calculating the expected limits is summarised in Sec. 4.5.",
            "section": "Method description",
            "paragraph_rank": 25,
            "section_rank": 5
        },
        {
            "text": "Statistical model",
            "section_rank": 6
        },
        {
            "text": "The full likelihood, including all nuisance parameters, is given by:",
            "section": "Statistical model",
            "paragraph_rank": 26,
            "section_rank": 6
        },
        {
            "text": "where:",
            "section": "Statistical model",
            "paragraph_rank": 27,
            "section_rank": 6
        },
        {
            "text": "\u2022 the index c runs over the channels;",
            "section": "Statistical model",
            "paragraph_rank": 28,
            "section_rank": 6
        },
        {
            "text": "\u2022 the index i runs over the backgrounds;",
            "section": "Statistical model",
            "paragraph_rank": 29,
            "section_rank": 6
        },
        {
            "text": "\u2022 the index \u03b8 runs over the bins;",
            "section": "Statistical model",
            "paragraph_rank": 30,
            "section_rank": 6
        },
        {
            "text": "\u2022 the index j runs over the systematic uncertainties;",
            "section": "Statistical model",
            "paragraph_rank": 31,
            "section_rank": 6
        },
        {
            "text": "In OpTHyLiC, the signal always adds to the background (\u00b5s c\u03b8 is always positive). ",
            "section": "Statistical model",
            "paragraph_rank": 32,
            "section_rank": 6
        },
        {
            "text": "Cases where the searched signal causes a deficit of events with respect to the background only hypothesis therefore can't be treated with OpTHyLiC.",
            "section": "Statistical model",
            "paragraph_rank": 32,
            "section_rank": 6
        },
        {
            "text": "The set of nuisance parameters {s c\u03b8 , b ci\u03b8 , \u03b7 j } can be divided into two categories. ",
            "section": "Statistical model",
            "paragraph_rank": 33,
            "section_rank": 6
        },
        {
            "text": "The first ones, {s c\u03b8 , b ci\u03b8 }, account for the systematic uncertainties due to the finite size of the control samples used to estimate the signal and background nominal yields s nom c\u03b8 and b nom ci\u03b8 , respectively. ",
            "section": "Statistical model",
            "paragraph_rank": 33,
            "section_rank": 6
        },
        {
            "text": "Such uncertainties are referred to as \"statistical uncertainties\" in this paper. ",
            "section": "Statistical model",
            "paragraph_rank": 33,
            "section_rank": 6
        },
        {
            "text": "These nuisance parameters are constrained by the functions f . ",
            "section": "Statistical model",
            "paragraph_rank": 33,
            "section_rank": 6
        },
        {
            "text": "The second ones, {\u03b7 j }, account for the systematic uncertainties. ",
            "section": "Statistical model",
            "paragraph_rank": 33,
            "section_rank": 6
        },
        {
            "text": "They are constrained by the functions g. ",
            "section": "Statistical model",
            "paragraph_rank": 33,
            "section_rank": 6
        },
        {
            "text": "The variation of the signal and background yields under the effect of the systematic uncertainties are described by the functions k syst c\u03b8 ({\u03b7 j }) and k syst ci\u03b8 ({\u03b7 j }), respectively. ",
            "section": "Statistical model",
            "paragraph_rank": 33,
            "section_rank": 6
        },
        {
            "text": "Bins of discriminating variable histograms are treated as channels: the drawing of Poisson random numbers and the statistical uncertainties on the yield of each process in each bin are independent, but a given systematic uncertainty may affect the yields in a correlated way. ",
            "section": "Statistical model",
            "paragraph_rank": 33,
            "section_rank": 6
        },
        {
            "text": "It is therefore equivalent to run a counting experiment with N channels and a binned experiment with N bins where the yields and uncertainties in each bin match those in the channels.",
            "section": "Statistical model",
            "paragraph_rank": 33,
            "section_rank": 6
        },
        {
            "text": "Treatment of statistical uncertainties",
            "section_rank": 7
        },
        {
            "text": "The nuisance parameters s c and b ci , accounting for the statistical uncertainties on the nominal signal and background yields, are constrained by probability density functions (p. d. f.) f of the form:",
            "section": "Treatment of statistical uncertainties",
            "paragraph_rank": 34,
            "section_rank": 7
        },
        {
            "text": "where y is the nuisance parameter, y nom the nominal yield and \u03c3 the statistical uncertainty, which can be the square root of summed squared weights (e.g. when y nom is estimated from a mixture of normalised simulated samples). ",
            "section": "Treatment of statistical uncertainties",
            "paragraph_rank": 35,
            "section_rank": 7
        },
        {
            "text": "In OpTHyLiC, five different p. ",
            "section": "Treatment of statistical uncertainties",
            "paragraph_rank": 35,
            "section_rank": 7
        },
        {
            "text": "d. ",
            "section": "Treatment of statistical uncertainties",
            "paragraph_rank": 35,
            "section_rank": 7
        },
        {
            "text": "f. ",
            "section": "Treatment of statistical uncertainties",
            "paragraph_rank": 35,
            "section_rank": 7
        },
        {
            "text": "can be used as constraints: a normal distribution, a log-normal distribution, or three different types of gamma distributions.",
            "section": "Treatment of statistical uncertainties",
            "paragraph_rank": 35,
            "section_rank": 7
        },
        {
            "text": "Normal and log-normal constraints",
            "section_rank": 8
        },
        {
            "text": "The parameters of the normal and log-normal p. ",
            "section": "Normal and log-normal constraints",
            "paragraph_rank": 36,
            "section_rank": 8
        },
        {
            "text": "d. ",
            "section": "Normal and log-normal constraints",
            "paragraph_rank": 36,
            "section_rank": 8
        },
        {
            "text": "f. ",
            "section": "Normal and log-normal constraints",
            "paragraph_rank": 36,
            "section_rank": 8
        },
        {
            "text": "are chosen so that the average and the standard deviation of these distributions are equal to y nom and \u03c3, respectively. ",
            "section": "Normal and log-normal constraints",
            "paragraph_rank": 36,
            "section_rank": 8
        },
        {
            "text": "The normal distribution has the form:",
            "section": "Normal and log-normal constraints",
            "paragraph_rank": 36,
            "section_rank": 8
        },
        {
            "text": "and the log-normal distribution has the form:",
            "section": "Normal and log-normal constraints",
            "paragraph_rank": 37,
            "section_rank": 8
        },
        {
            "text": "with:",
            "section": "Normal and log-normal constraints",
            "paragraph_rank": 38,
            "section_rank": 8
        },
        {
            "text": "The normal distribution can be defined for any real y values, including nonphysical negative event yields. ",
            "section": "Normal and log-normal constraints",
            "paragraph_rank": 39,
            "section_rank": 8
        },
        {
            "text": "On the contrary, the log-normal distribution is defined only for y > 0.",
            "section": "Normal and log-normal constraints",
            "paragraph_rank": 39,
            "section_rank": 8
        },
        {
            "text": "In the log-normal case, the nominal yield y nom and statistical uncertainty \u03c3 estimated by users are interpreted as the average and standard deviation of the distribution, respectively. ",
            "section": "Normal and log-normal constraints",
            "paragraph_rank": 40,
            "section_rank": 8
        },
        {
            "text": "However, a different interpretation is possible. ",
            "section": "Normal and log-normal constraints",
            "paragraph_rank": 40,
            "section_rank": 8
        },
        {
            "text": "For example, if the statistical uncertainty results from a maximum likelihood estimate on some auxiliary dataset, y nom corresponds to the mode of the likelihood and \u03c3 to the uncertainty as measured from the curvature of the log-likelihood around the mode (\u03c3 = \u22121/ (ln f L ) (y = y nom )). ",
            "section": "Normal and log-normal constraints",
            "paragraph_rank": 40,
            "section_rank": 8
        },
        {
            "text": "The parameters a and b of the log-normal distribution should therefore be equal to:",
            "section": "Normal and log-normal constraints",
            "paragraph_rank": 40,
            "section_rank": 8
        },
        {
            "text": "This can be achieved in OpTHyLiC by setting input parameters to: ",
            "section": "Normal and log-normal constraints",
            "paragraph_rank": 41,
            "section_rank": 8
        },
        {
            "text": "with a and b given by Eq. ",
            "section": "Normal and log-normal constraints",
            "paragraph_rank": 42,
            "section_rank": 8
        },
        {
            "text": "8, rather than to y nom and \u03c3, respectively. ",
            "section": "Normal and log-normal constraints",
            "paragraph_rank": 42,
            "section_rank": 8
        },
        {
            "text": "where a and b are the rate and shape parameters respectively. ",
            "section": "Normal and log-normal constraints",
            "paragraph_rank": 43,
            "section_rank": 8
        },
        {
            "text": "As for the lognormal, the gamma distributions are defined for any strictly positive value of y.",
            "section": "Normal and log-normal constraints",
            "paragraph_rank": 43,
            "section_rank": 8
        },
        {
            "text": "This p. ",
            "section": "Normal and log-normal constraints",
            "paragraph_rank": 44,
            "section_rank": 8
        },
        {
            "text": "d. ",
            "section": "Normal and log-normal constraints",
            "paragraph_rank": 44,
            "section_rank": 8
        },
        {
            "text": "f. ",
            "section": "Normal and log-normal constraints",
            "paragraph_rank": 44,
            "section_rank": 8
        },
        {
            "text": "can be seen as the posterior distribution obtained from an auxiliary measurement accounting for the Poissonian nature of the statistical uncertainty. ",
            "section": "Normal and log-normal constraints",
            "paragraph_rank": 44,
            "section_rank": 8
        },
        {
            "text": "Accounting for this nature is not straightforward since events are in general weighted. ",
            "section": "Normal and log-normal constraints",
            "paragraph_rank": 44,
            "section_rank": 8
        },
        {
            "text": "A popular approach (used for example in Hist-Factory [5]) is to consider an imaginary auxiliary measurement in which all events have unit weight (which can therefore be described by a Poisson distribution) and in which the relative statistical uncertainty is equal to that used in the main measurement (\u03c3/y nom ).",
            "section": "Normal and log-normal constraints",
            "paragraph_rank": 44,
            "section_rank": 8,
            "ref_spans": [
                {
                    "start": 53,
                    "end": 56,
                    "type": "bibr",
                    "ref_id": "b3",
                    "text": "[5]"
                }
            ]
        },
        {
            "text": "Let N aux be the number of events observed in this auxiliary measurement. ",
            "section": "Normal and log-normal constraints",
            "paragraph_rank": 45,
            "section_rank": 8
        },
        {
            "text": "The auxiliary measurement likelihood is:",
            "section": "Normal and log-normal constraints",
            "paragraph_rank": 45,
            "section_rank": 8
        },
        {
            "text": "where \u03bb is the (unknown) nuisance parameter. ",
            "section": "Normal and log-normal constraints",
            "paragraph_rank": 46,
            "section_rank": 8
        },
        {
            "text": "It can be written as:",
            "section": "Normal and log-normal constraints",
            "paragraph_rank": 46,
            "section_rank": 8
        },
        {
            "text": "where N nom aux is the nominal value of N aux and \u03b3 the nuisance parameter affecting the yield in the main measurement -the product of Poisson terms in Eq. ",
            "section": "Normal and log-normal constraints",
            "paragraph_rank": 47,
            "section_rank": 8
        },
        {
            "text": "3 -in a multiplicative way: y = \u03b3 y nom . ",
            "section": "Normal and log-normal constraints",
            "paragraph_rank": 47,
            "section_rank": 8
        },
        {
            "text": "N nom aux is found by imposing that the relative statistical uncertainty is the same in the auxiliary and main measurements:",
            "section": "Normal and log-normal constraints",
            "paragraph_rank": 47,
            "section_rank": 8
        },
        {
            "text": "The auxiliary measurement likelihood can then be written as follows:",
            "section": "Normal and log-normal constraints",
            "paragraph_rank": 48,
            "section_rank": 8
        },
        {
            "text": "From this likelihood, posterior distributions for \u03b3 can be determined for various prior distributions \u03c0 (\u03b3):",
            "section": "Normal and log-normal constraints",
            "paragraph_rank": 49,
            "section_rank": 8
        },
        {
            "text": "These posterior distributions can then be translated into posterior distributions for the yield y (hereafter denoted as f (y; y nom , \u03c3), using the same notation as in Eq. ",
            "section": "Normal and log-normal constraints",
            "paragraph_rank": 50,
            "section_rank": 8
        },
        {
            "text": "4).",
            "section": "Normal and log-normal constraints",
            "paragraph_rank": 50,
            "section_rank": 8
        },
        {
            "text": "Three prior distributions are considered; in each case, the posterior distribution for y is a gamma distribution with the general form given by Eq. ",
            "section": "Normal and log-normal constraints",
            "paragraph_rank": 51,
            "section_rank": 8
        },
        {
            "text": "10:",
            "section": "Normal and log-normal constraints",
            "paragraph_rank": 51,
            "section_rank": 8
        },
        {
            "text": "\u2022 \u03c0 (\u03b3) \u221d 1 (uniform prior); in this case, the posterior distribution is: f (y; y nom , \u03c3) = f G y; a = y nom /\u03c3 2 , b = (y nom /\u03c3) 2 + 1 ;",
            "section": "Normal and log-normal constraints",
            "paragraph_rank": 52,
            "section_rank": 8
        },
        {
            "text": "(16a)",
            "section": "Normal and log-normal constraints",
            "paragraph_rank": 53,
            "section_rank": 8
        },
        {
            "text": "\u2022 \u03c0 (\u03b3) \u221d 1/ \u221a \u03b3 (Jeffreys prior 2 ); in this case, the posterior distribution is:",
            "section": "Normal and log-normal constraints",
            "paragraph_rank": 54,
            "section_rank": 8
        },
        {
            "text": "\u2022 \u03c0 (\u03b3) \u221d 1/\u03b3 (hyperbolic prior); in this case, the posterior distribution is:",
            "section": "Normal and log-normal constraints",
            "paragraph_rank": 55,
            "section_rank": 8
        },
        {
            "text": "The three gamma constraints available in OpTHyLiC correspond to the three posteriors given in Eq. ",
            "section": "Normal and log-normal constraints",
            "paragraph_rank": 56,
            "section_rank": 8
        },
        {
            "text": "16a, 16b and 16c. ",
            "section": "Normal and log-normal constraints",
            "paragraph_rank": 56,
            "section_rank": 8
        },
        {
            "text": "Their parameters are summarized in Tab. ",
            "section": "Normal and log-normal constraints",
            "paragraph_rank": 56,
            "section_rank": 8
        },
        {
            "text": "1. ",
            "section": "Normal and log-normal constraints",
            "paragraph_rank": 56,
            "section_rank": 8
        },
        {
            "text": "Comparison of the constraint functions",
            "section_rank": 9
        },
        {
            "text": "The five available constraint functions -normal, log-normal and the three gamma distributions -are compared for three different values of y nom and \u03c3 in Fig. 1. ",
            "section": "Comparison of the constraint functions",
            "paragraph_rank": 57,
            "section_rank": 9,
            "ref_spans": [
                {
                    "start": 153,
                    "end": 159,
                    "type": "figure",
                    "ref_id": "fig_2",
                    "text": "Fig. 1"
                }
            ]
        },
        {
            "text": "When \u03c3 is small with respect to y nom , the distributions are very close to each other. ",
            "section": "Comparison of the constraint functions",
            "paragraph_rank": 57,
            "section_rank": 9
        },
        {
            "text": "Otherwise, the differences between the distributions can be significant. ",
            "section": "Comparison of the constraint functions",
            "paragraph_rank": 57,
            "section_rank": 9
        },
        {
            "text": "2 We recall that Jeffreys prior is \u03c0 (\u03b3) \u221d I(\u03b3), where the Fisher information is I(\u03b3) = E \u2202 log P (Naux;\u03b3) \u2202\u03b3 2 . ",
            "section": "Comparison of the constraint functions",
            "paragraph_rank": 57,
            "section_rank": 9,
            "ref_spans": [
                {
                    "start": 0,
                    "end": 1,
                    "type": "bibr",
                    "ref_id": "b1",
                    "text": "2"
                }
            ]
        },
        {
            "text": "Injecting Eq. ",
            "section": "Comparison of the constraint functions",
            "paragraph_rank": 57,
            "section_rank": 9
        },
        {
            "text": "14 in this expression leads to \u03c0 (\u03b3) \u221d 1/ \u221a \u03b3.    ",
            "section": "Comparison of the constraint functions",
            "paragraph_rank": 57,
            "section_rank": 9
        },
        {
            "text": "Care should be taken when statistical uncertainties are large compared with the nominal yields or when nominal yields are equal to zero. ",
            "section": "Comparison of the constraint functions",
            "paragraph_rank": 57,
            "section_rank": 9
        },
        {
            "text": "When statistical uncertainties are large, constraint p. ",
            "section": "Comparison of the constraint functions",
            "paragraph_rank": 57,
            "section_rank": 9
        },
        {
            "text": "d. ",
            "section": "Comparison of the constraint functions",
            "paragraph_rank": 57,
            "section_rank": 9
        },
        {
            "text": "f. ",
            "section": "Comparison of the constraint functions",
            "paragraph_rank": 57,
            "section_rank": 9
        },
        {
            "text": "can be truncated at zero in the normal case. ",
            "section": "Comparison of the constraint functions",
            "paragraph_rank": 57,
            "section_rank": 9
        },
        {
            "text": "In such cases, log-normal and gamma should be preferred. ",
            "section": "Comparison of the constraint functions",
            "paragraph_rank": 57,
            "section_rank": 9
        },
        {
            "text": "When nominal yields are equal to zero, log-normal and gamma are undefined. ",
            "section": "Comparison of the constraint functions",
            "paragraph_rank": 57,
            "section_rank": 9
        },
        {
            "text": "In such cases, OpTHyLiC automatically selects a normal constraint truncated at zero. ",
            "section": "Comparison of the constraint functions",
            "paragraph_rank": 57,
            "section_rank": 9
        },
        {
            "text": "In general, users are encouraged to study the stability of the limit calculations depending on the assumptions made in such circumstances.",
            "section": "Comparison of the constraint functions",
            "paragraph_rank": 57,
            "section_rank": 9
        },
        {
            "text": "Treatment of systematic uncertainties",
            "section_rank": 10
        },
        {
            "text": "Systematic uncertainties on nominal yields s nom c\u03b8 and b nom ci\u03b8 are accounted for by including the set of nuisance parameters {\u03b7 j }. ",
            "section": "Treatment of systematic uncertainties",
            "paragraph_rank": 58,
            "section_rank": 10
        },
        {
            "text": "They are assumed to be either 100% correlated or completely uncorrelated. ",
            "section": "Treatment of systematic uncertainties",
            "paragraph_rank": 58,
            "section_rank": 10
        },
        {
            "text": "The total number of nuisance parameters is therefore equal to the total number of independent systematic uncertainties, including all channels, backgrounds and signals. ",
            "section": "Treatment of systematic uncertainties",
            "paragraph_rank": 58,
            "section_rank": 10
        },
        {
            "text": "The correlation factor between two nuisance parameters \u03b7 j and \u03b7 k is given by the Kronecker symbol \u03b4 jk . ",
            "section": "Treatment of systematic uncertainties",
            "paragraph_rank": 58,
            "section_rank": 10
        },
        {
            "text": "The term constraining nuisance parameters in the likelihood can thus be factorized into the product of individual constraint terms. ",
            "section": "Treatment of systematic uncertainties",
            "paragraph_rank": 58,
            "section_rank": 10
        },
        {
            "text": "In Eq. ",
            "section": "Treatment of systematic uncertainties",
            "paragraph_rank": 58,
            "section_rank": 10
        },
        {
            "text": "3, the nuisance parameter for each systematic uncertainty of index j is constrained by a standard normal p. ",
            "section": "Treatment of systematic uncertainties",
            "paragraph_rank": 58,
            "section_rank": 10
        },
        {
            "text": "d. ",
            "section": "Treatment of systematic uncertainties",
            "paragraph_rank": 58,
            "section_rank": 10
        },
        {
            "text": "f. ",
            "section": "Treatment of systematic uncertainties",
            "paragraph_rank": 58,
            "section_rank": 10
        },
        {
            "text": "g of the form:",
            "section": "Treatment of systematic uncertainties",
            "paragraph_rank": 58,
            "section_rank": 10
        },
        {
            "text": "As stated in Sec. 4.1, the effect of systematic uncertainties on the yield is described by relations of the form:",
            "section": "Treatment of systematic uncertainties",
            "paragraph_rank": 59,
            "section_rank": 10
        },
        {
            "text": "where y is the varied yield, y nom the nominal yield and k syst ({\u03b7 j }) the function describing the variation of the yield with the set of nuisance parameters {\u03b7 j }. ",
            "section": "Treatment of systematic uncertainties",
            "paragraph_rank": 60,
            "section_rank": 10
        },
        {
            "text": "OpTHyLiC provides two different solutions for combining the effect of multiple nuisance parameters:",
            "section": "Treatment of systematic uncertainties",
            "paragraph_rank": 60,
            "section_rank": 10
        },
        {
            "text": "\u2022 additive:",
            "section": "Treatment of systematic uncertainties",
            "paragraph_rank": 61,
            "section_rank": 10
        },
        {
            "text": "\u2022 multiplicative:",
            "section": "Treatment of systematic uncertainties",
            "paragraph_rank": 62,
            "section_rank": 10
        },
        {
            "text": "In Eq. ",
            "section": "Treatment of systematic uncertainties",
            "paragraph_rank": 63,
            "section_rank": 10
        },
        {
            "text": "19a and 19b, h syst j (\u03b7 j ) is the function describing the variation of the yield with nuisance parameter j. ",
            "section": "Treatment of systematic uncertainties",
            "paragraph_rank": 63,
            "section_rank": 10
        },
        {
            "text": "In both cases, when the effect of only one nuisance parameter is considered, k syst (\u03b7 j ) = h syst j (\u03b7 j ) as it should. ",
            "section": "Treatment of systematic uncertainties",
            "paragraph_rank": 63,
            "section_rank": 10
        },
        {
            "text": "For each systematic uncertainty j, the corresponding nuisance parameter \u03b7 j is chosen such that \u03b7 j = 0 corresponds to no variation, \u03b7 j = +1 to a +1\u03c3 variation, and \u03b7 j = \u22121 to a \u22121\u03c3 variation. ",
            "section": "Treatment of systematic uncertainties",
            "paragraph_rank": 63,
            "section_rank": 10
        },
        {
            "text": "The main issue associated to systematic uncertainties is the choice of the function h syst j (\u03b7 j ) that relates the effect of the systematic uncertainty to its associated nuisance parameter. ",
            "section": "Treatment of systematic uncertainties",
            "paragraph_rank": 63,
            "section_rank": 10
        },
        {
            "text": "Usually, h syst j is known, for each systematic, for \u03b7 j = 0, \u22121 and +1. ",
            "section": "Treatment of systematic uncertainties",
            "paragraph_rank": 63,
            "section_rank": 10
        },
        {
            "text": "The value of h sys j for \u03b7 j = 0 is by definition equal to 1: it corresponds to the case y = y nom . ",
            "section": "Treatment of systematic uncertainties",
            "paragraph_rank": 63,
            "section_rank": 10
        },
        {
            "text": "Let h \u2191 j (h \u2193 j ) be the relative variation of the yield when systematic j is varied by +1 (\u22121) \u03c3. ",
            "section": "Treatment of systematic uncertainties",
            "paragraph_rank": 63,
            "section_rank": 10
        },
        {
            "text": "Thus, for all j:",
            "section": "Treatment of systematic uncertainties",
            "paragraph_rank": 63,
            "section_rank": 10
        },
        {
            "text": "The problem consists in finding continuous functions h syst j (\u03b7 j ), interpolating for \u03b7 j \u2208 [\u22121, +1] and extrapolating for \u03b7 j > +1 and \u03b7 j < \u22121, and such that Eqs. ",
            "section": "Treatment of systematic uncertainties",
            "paragraph_rank": 64,
            "section_rank": 10
        },
        {
            "text": "20 are satisfied -at least approximately. ",
            "section": "Treatment of systematic uncertainties",
            "paragraph_rank": 64,
            "section_rank": 10
        },
        {
            "text": "Four choices are currently available in OpTHyLiC, and are represented in Fig. 2:",
            "section": "Treatment of systematic uncertainties",
            "paragraph_rank": 64,
            "section_rank": 10,
            "ref_spans": [
                {
                    "start": 73,
                    "end": 79,
                    "type": "figure",
                    "ref_id": "fig_3",
                    "text": "Fig. 2"
                }
            ]
        },
        {
            "text": "\u2022 piece-wise linear interpolation and extrapolation, defined in Sec. 4.3.1;",
            "section": "Treatment of systematic uncertainties",
            "paragraph_rank": 65,
            "section_rank": 10
        },
        {
            "text": "\u2022 piece-wise exponential interpolation and extrapolation, defined in Sec. 4.3.2;",
            "section": "Treatment of systematic uncertainties",
            "paragraph_rank": 66,
            "section_rank": 10
        },
        {
            "text": "\u2022 polynomial interpolation and exponential extrapolation, defined in Sec. 4.3.3;",
            "section": "Treatment of systematic uncertainties",
            "paragraph_rank": 67,
            "section_rank": 10
        },
        {
            "text": "\u2022 \"McLimit\" interpolation and extrapolation, defined in Sec. 4.3.4 and corresponding to the choice followed in the McLimit program.",
            "section": "Treatment of systematic uncertainties",
            "paragraph_rank": 68,
            "section_rank": 10,
            "entity_spans": [
                {
                    "start": 3,
                    "end": 10,
                    "type": "software",
                    "rawForm": "McLimit",
                    "resp": "service",
                    "id": "software-simple-s6"
                },
                {
                    "start": 115,
                    "end": 123,
                    "type": "software",
                    "rawForm": "McLimit",
                    "resp": "service",
                    "id": "software-simple-s7"
                }
            ]
        },
        {
            "text": "Piece-wise linear interpolation and extrapolation",
            "section_rank": 11
        },
        {
            "text": "The piece-wise linear interpolation and extrapolation is defined as follows: From this definition, it appears that h syst j can be negative if h \u2191 j or h \u2193 j is negative. ",
            "section": "Piece-wise linear interpolation and extrapolation",
            "paragraph_rank": 69,
            "section_rank": 11
        },
        {
            "text": "This unphysical behaviour is dealt with in OpTHyLiC by setting h syst j to zero when it occurs.",
            "section": "Piece-wise linear interpolation and extrapolation",
            "paragraph_rank": 69,
            "section_rank": 11
        },
        {
            "text": "Piece-wise exponential interpolation and extrapolation",
            "section_rank": 12
        },
        {
            "text": "The piece-wise exponential interpolation and extrapolation is defined as follows:",
            "section": "Piece-wise exponential interpolation and extrapolation",
            "paragraph_rank": 70,
            "section_rank": 12
        },
        {
            "text": "From this definition, it appears that h syst j can be negative if h \u2191 j or h \u2193 j is lower than -1. ",
            "section": "Piece-wise exponential interpolation and extrapolation",
            "paragraph_rank": 71,
            "section_rank": 12
        },
        {
            "text": "This unphysical behaviour is dealt with in OpTHyLiC by applying a linear interpolation and extrapolation instead (see Sec. 4.3.1) when it occurs. ",
            "section": "Piece-wise exponential interpolation and extrapolation",
            "paragraph_rank": 71,
            "section_rank": 12
        },
        {
            "text": "If both h \u2191 j and h \u2193 j are greater than -1, h syst j is positive for all \u03b7 j values.",
            "section": "Piece-wise exponential interpolation and extrapolation",
            "paragraph_rank": 71,
            "section_rank": 12
        },
        {
            "text": "Polynomial interpolation and exponential extrapolation",
            "section_rank": 13
        },
        {
            "text": "The polynomial interpolation and exponential extrapolation is defined as follows:",
            "section": "Polynomial interpolation and exponential extrapolation",
            "paragraph_rank": 72,
            "section_rank": 13
        },
        {
            "text": "where the coefficients a i are chosen such that h syst j (\u03b7 j ) and its first and second derivatives are continuous at |\u03b7 j | = 1 and \u03b7 j = 0.",
            "section": "Polynomial interpolation and exponential extrapolation",
            "paragraph_rank": 73,
            "section_rank": 13
        },
        {
            "text": "\"McLimit\" interpolation and extrapolation",
            "section_rank": 14,
            "entity_spans": [
                {
                    "start": 1,
                    "end": 8,
                    "type": "software",
                    "rawForm": "McLimit",
                    "resp": "service",
                    "id": "software-simple-s8"
                }
            ]
        },
        {
            "text": "The \"McLimit\" interpolation and extrapolation is defined as follows:",
            "section": "\"McLimit\" interpolation and extrapolation",
            "paragraph_rank": 74,
            "section_rank": 14,
            "entity_spans": [
                {
                    "start": 5,
                    "end": 12,
                    "type": "software",
                    "rawForm": "McLimit",
                    "resp": "service",
                    "id": "software-simple-s9"
                }
            ]
        },
        {
            "text": "where:",
            "section": "\"McLimit\" interpolation and extrapolation",
            "paragraph_rank": 75,
            "section_rank": 14
        },
        {
            "text": "This definition ensures that the first derivative of h syst j at \u03b7 j = 0 is continuous and that h syst j > 0 for all \u03b7 j values. ",
            "section": "\"McLimit\" interpolation and extrapolation",
            "paragraph_rank": 76,
            "section_rank": 14
        },
        {
            "text": "Equation 20b (20c) is exactly satisfied when h \u2191 j > 0 (h \u2193 j > 0) but only to first order when h \u2191 j < 0 (h \u2193 j < 0). ",
            "section": "\"McLimit\" interpolation and extrapolation",
            "paragraph_rank": 76,
            "section_rank": 14
        },
        {
            "text": "Indeed, the following relations hold:",
            "section": "\"McLimit\" interpolation and extrapolation",
            "paragraph_rank": 76,
            "section_rank": 14
        },
        {
            "text": "Also, when the effect of the considered uncertainty is symmetric (h \u2191 j = \u2212h \u2193 j ), this interpolation/extrapolation scheme is equivalent to the piece-wise linear one (see Sec. 4.3.1) for \u03b7 j > 0 if h \u2191 \u2265 0 or \u03b7 j < 0 if h \u2193 \u2265 0.",
            "section": "\"McLimit\" interpolation and extrapolation",
            "paragraph_rank": 77,
            "section_rank": 14
        },
        {
            "text": "Inference of observed upper limit \u00b5 up",
            "section_rank": 15
        },
        {
            "text": "The observed upper limit on the signal strength \u00b5 up is derived from the CL s method using q \u00b5 (Eq. 2) as test statistic. ",
            "section": "Inference of observed upper limit \u00b5 up",
            "paragraph_rank": 78,
            "section_rank": 15
        },
        {
            "text": "q \u00b5 is computed using the nominal likelihood:",
            "section": "Inference of observed upper limit \u00b5 up",
            "paragraph_rank": 78,
            "section_rank": 15
        },
        {
            "text": "It thus reduces to the following simple form:",
            "section": "Inference of observed upper limit \u00b5 up",
            "paragraph_rank": 79,
            "section_rank": 15
        },
        {
            "text": "where q c\u03b8 \u00b5 is the test for channel c and bin \u03b8 given by:",
            "section": "Inference of observed upper limit \u00b5 up",
            "paragraph_rank": 80,
            "section_rank": 15
        },
        {
            "text": "The distributions of q \u00b5 under signal plus background and background only hypotheses (hereafter denoted as p(q \u00b5 |\u00b5) and p(q \u00b5 |0) respectively) are determined by generating pseudo-experiments from the marginal likelihood:",
            "section": "Inference of observed upper limit \u00b5 up",
            "paragraph_rank": 81,
            "section_rank": 15
        },
        {
            "text": "In practice, this is done by first generating nuisance parameter values from their constraint p. ",
            "section": "Inference of observed upper limit \u00b5 up",
            "paragraph_rank": 82,
            "section_rank": 15
        },
        {
            "text": "d. ",
            "section": "Inference of observed upper limit \u00b5 up",
            "paragraph_rank": 82,
            "section_rank": 15
        },
        {
            "text": "f. ",
            "section": "Inference of observed upper limit \u00b5 up",
            "paragraph_rank": 82,
            "section_rank": 15
        },
        {
            "text": "and by then generating N c\u03b8 using the nuisance parameter values obtained in the first step. ",
            "section": "Inference of observed upper limit \u00b5 up",
            "paragraph_rank": 82,
            "section_rank": 15
        },
        {
            "text": "Typical distributions produced by OpTHyLiC are shown in Fig. 3.",
            "section": "Inference of observed upper limit \u00b5 up",
            "paragraph_rank": 82,
            "section_rank": 15,
            "ref_spans": [
                {
                    "start": 56,
                    "end": 62,
                    "type": "figure",
                    "ref_id": "fig_4",
                    "text": "Fig. 3"
                }
            ]
        },
        {
            "text": "Once p(q \u00b5 |\u00b5) and p(q \u00b5 |0) have been determined, CL s is computed by using: ",
            "section": "Inference of observed upper limit \u00b5 up",
            "paragraph_rank": 83,
            "section_rank": 15
        },
        {
            "text": "Computation of expected limits",
            "section_rank": 16
        },
        {
            "text": "OpTHyLiC can also be used to compute expected limits on the signal strength, under the background only hypothesis. ",
            "section": "Computation of expected limits",
            "paragraph_rank": 84,
            "section_rank": 16
        },
        {
            "text": "Five expected limit quantiles are available: median, \u22122\u03c3, \u22121\u03c3, +1\u03c3 and +2\u03c3. ",
            "section": "Computation of expected limits",
            "paragraph_rank": 84,
            "section_rank": 16
        },
        {
            "text": "The last four ones are defined using the standard normal distribution. ",
            "section": "Computation of expected limits",
            "paragraph_rank": 84,
            "section_rank": 16
        },
        {
            "text": "Denoting these quantiles by Z and the corresponding probability by p, one has:",
            "section": "Computation of expected limits",
            "paragraph_rank": 84,
            "section_rank": 16
        },
        {
            "text": "where \u03a6 is the cumulative distribution function of the standard normal distribution. ",
            "section": "Computation of expected limits",
            "paragraph_rank": 85,
            "section_rank": 16
        },
        {
            "text": "The values of probabilities for the quantiles available in OpTHyLiC are given in Tab. ",
            "section": "Computation of expected limits",
            "paragraph_rank": 85,
            "section_rank": 16
        },
        {
            "text": "3. ",
            "section": "Computation of expected limits",
            "paragraph_rank": 85,
            "section_rank": 16
        },
        {
            "text": "Two methods are provided to compute expected limits. ",
            "section": "Computation of expected limits",
            "paragraph_rank": 85,
            "section_rank": 16
        },
        {
            "text": "In the first one, the distribution of \u00b5 up is determined by generating pseudo-experiments under the background-only hypothesis. ",
            "section": "Computation of expected limits",
            "paragraph_rank": 85,
            "section_rank": 16
        },
        {
            "text": "Expected limits are then given by the quantiles (as defined above) of this distribution. ",
            "section": "Computation of expected limits",
            "paragraph_rank": 85,
            "section_rank": 16
        },
        {
            "text": "In the second one, expected Z -2 -1 0 (median) +1 +2 p 0.0228 0.1587 0.5 0.8413 0.9772 Both methods are equivalent from the statistical point of view but different in terms of implementation and computing time. ",
            "section": "Computation of expected limits",
            "paragraph_rank": 85,
            "section_rank": 16
        },
        {
            "text": "In most cases, the second method performs much faster than the first one and should therefore be preferred. ",
            "section": "Computation of expected limits",
            "paragraph_rank": 85,
            "section_rank": 16
        },
        {
            "text": "The first method can be used for cross-checks or if the distribution of \u00b5 up is needed.",
            "section": "Computation of expected limits",
            "paragraph_rank": 85,
            "section_rank": 16
        },
        {
            "text": "However, when using the second method, quantiles are not computed from a single distribution as in the first method: each quantile is computed in a separate job. ",
            "section": "Computation of expected limits",
            "paragraph_rank": 86,
            "section_rank": 16
        },
        {
            "text": "Therefore, due to statistical fluctuations, the expected values may not be sorted as they should (for example, the \u22122\u03c3 expected value can be higher than the \u22121\u03c3 expected value). ",
            "section": "Computation of expected limits",
            "paragraph_rank": 86,
            "section_rank": 16
        },
        {
            "text": "In such cases it is recommended to increase the number of pseudo-experiments.",
            "section": "Computation of expected limits",
            "paragraph_rank": 86,
            "section_rank": 16
        },
        {
            "text": "Software description",
            "section_rank": 17
        },
        {
            "text": "Structure and prerequisites",
            "section_rank": 18
        },
        {
            "text": "OpTHyLiC is written in C++ and uses the ROOT library [6]. ",
            "section": "Structure and prerequisites",
            "paragraph_rank": 87,
            "section_rank": 18,
            "entity_spans": [
                {
                    "start": 40,
                    "end": 45,
                    "type": "software",
                    "rawForm": "ROOT",
                    "resp": "service",
                    "id": "software-simple-s10"
                }
            ]
        },
        {
            "text": "The code is separated in different classes. ",
            "section": "Structure and prerequisites",
            "paragraph_rank": 87,
            "section_rank": 18
        },
        {
            "text": "Their definitions and implementations are separated into different files which are placed in the main OpTHyLiC directory. ",
            "section": "Structure and prerequisites",
            "paragraph_rank": 87,
            "section_rank": 18
        },
        {
            "text": "Once compiled, the libraries can either be used dynamically by using a macro interpreted with the ROOT interpreter (CINT and CLING for version 5 and 6 of ROOT, respectively), or by using a C++ program compiled into an executable with a software like gcc. ",
            "section": "Structure and prerequisites",
            "paragraph_rank": 87,
            "section_rank": 18,
            "entity_spans": [
                {
                    "start": 98,
                    "end": 102,
                    "type": "software",
                    "rawForm": "ROOT",
                    "resp": "service",
                    "id": "software-simple-s11"
                },
                {
                    "start": 154,
                    "end": 158,
                    "type": "software",
                    "rawForm": "ROOT",
                    "resp": "service",
                    "id": "software-simple-s12"
                }
            ]
        },
        {
            "text": "Two simple examples, working for both cases, are available in the examples sub-directory.",
            "section": "Structure and prerequisites",
            "paragraph_rank": 87,
            "section_rank": 18
        },
        {
            "text": "As the statistical method relies on pseudo-experiments, pseudo-random number generators are used. ",
            "section": "Structure and prerequisites",
            "paragraph_rank": 88,
            "section_rank": 18
        },
        {
            "text": "ROOT provides in its TRandom3 class an implementation of the MT19937 Mersenne twister [7]. ",
            "section": "Structure and prerequisites",
            "paragraph_rank": 88,
            "section_rank": 18,
            "ref_spans": [
                {
                    "start": 86,
                    "end": 89,
                    "type": "bibr",
                    "ref_id": "b4",
                    "text": "[7]"
                }
            ],
            "entity_spans": [
                {
                    "start": 0,
                    "end": 4,
                    "type": "software",
                    "rawForm": "ROOT",
                    "resp": "service",
                    "id": "software-simple-s13"
                }
            ]
        },
        {
            "text": "The C++ standard library in its recent C++11 standard [8] also provides various pseudo-random number engines, which generate numbers distributed with the various probability distributions mentioned in this paper. ",
            "section": "Structure and prerequisites",
            "paragraph_rank": 88,
            "section_rank": 18,
            "ref_spans": [
                {
                    "start": 54,
                    "end": 57,
                    "type": "bibr",
                    "ref_id": "b5",
                    "text": "[8]"
                }
            ]
        },
        {
            "text": "Therefore, if the available compiler or ROOT version makes the use of the C++11 standard possible, the user has the possibility to chose these pseudo-random engines instead of the TRandom3 class. ",
            "section": "Structure and prerequisites",
            "paragraph_rank": 88,
            "section_rank": 18,
            "entity_spans": [
                {
                    "start": 40,
                    "end": 45,
                    "type": "software",
                    "rawForm": "ROOT",
                    "resp": "service",
                    "id": "software-simple-s14"
                }
            ]
        },
        {
            "text": "Thanks to relevant preprocessor directives, the portions of the code specific to the C++11 standard are ignored, either by the interpreter or by the compiler, when its use is not possible.",
            "section": "Structure and prerequisites",
            "paragraph_rank": 88,
            "section_rank": 18
        },
        {
            "text": "If used as a compiled executable, the examples have been tested to be fully functional with gcc version 4.8.2 (4.3.0) or newer, with ROOT version 5.28/00b, when C++11 features are (are not) used. ",
            "section": "Structure and prerequisites",
            "paragraph_rank": 89,
            "section_rank": 18,
            "entity_spans": [
                {
                    "start": 104,
                    "end": 116,
                    "type": "version",
                    "rawForm": "4.8.2 (4.3.0",
                    "resp": "service",
                    "id": "#software-simple-s14"
                }
            ]
        },
        {
            "text": "If used as interpreted macros, the examples have been tested to be fully functional with ROOT versions as old as 6.02/03 (5.28/00b), when C++11 features are (are not) used. ",
            "section": "Structure and prerequisites",
            "paragraph_rank": 89,
            "section_rank": 18,
            "entity_spans": [
                {
                    "start": 89,
                    "end": 94,
                    "type": "software",
                    "rawForm": "ROOT",
                    "resp": "service",
                    "id": "software-simple-s15"
                }
            ]
        },
        {
            "text": "Older versions of gcc and ROOT may also be used but have not been tested. ",
            "section": "Structure and prerequisites",
            "paragraph_rank": 89,
            "section_rank": 18,
            "entity_spans": [
                {
                    "start": 26,
                    "end": 30,
                    "type": "software",
                    "rawForm": "ROOT",
                    "resp": "service",
                    "id": "software-simple-s16"
                }
            ]
        },
        {
            "text": "Other compilers than gcc could also have been chosen, but have not been considered in the installation procedure described below.",
            "section": "Structure and prerequisites",
            "paragraph_rank": 89,
            "section_rank": 18
        },
        {
            "text": "The usage instructions given below corresponds to version 2.00 of OpTHyLiC.",
            "section": "Structure and prerequisites",
            "paragraph_rank": 90,
            "section_rank": 18
        },
        {
            "text": "Installation and examples",
            "section_rank": 19
        },
        {
            "text": "OpTHyLiC is installed in three steps:",
            "section": "Installation and examples",
            "paragraph_rank": 91,
            "section_rank": 19
        },
        {
            "text": "1. running the INSTALL script to prepare the compilation by creating a",
            "section": "Installation and examples",
            "paragraph_rank": 92,
            "section_rank": 19
        },
        {
            "text": "Makefile which structure depends on how OpTHyLiC is intended to be used; ",
            "section": "Installation and examples",
            "paragraph_rank": 93,
            "section_rank": 19
        },
        {
            "text": "2. running make to compile the shared libraries according to the Makefile; ",
            "section": "Installation and examples",
            "paragraph_rank": 93,
            "section_rank": 19
        },
        {
            "text": "3. running the setup.",
            "section": "Installation and examples",
            "paragraph_rank": 93,
            "section_rank": 19
        },
        {
            "text": "[c]sh script created in the first step, to update the LD_LIBRARY_PATH environment variable with the directory where the shared libraries are available.",
            "section": "Installation and examples",
            "paragraph_rank": 94,
            "section_rank": 19
        },
        {
            "text": "The INSTALL shell script is in the main directory. ",
            "section": "Installation and examples",
            "paragraph_rank": 95,
            "section_rank": 19
        },
        {
            "text": "Using INSTALL --help (or INSTALL -h) displays a help detailing the different options, which allows the user to configure the Makefile:",
            "section": "Installation and examples",
            "paragraph_rank": 95,
            "section_rank": 19
        },
        {
            "text": "\u2022 --executable (or -e) to compile executables with gcc; if this option is not used, two ROOT macros, Compile.C and examples/load.C, needed for the compilation and for loading the shared libraries, are created in addition to the Makefile;",
            "section": "Installation and examples",
            "paragraph_rank": 96,
            "section_rank": 19
        },
        {
            "text": "\u2022 --C++11 (or -C) to enable the C++11 features; in this case, the script checks if the gcc or ROOT versions are recent enough to do so;",
            "section": "Installation and examples",
            "paragraph_rank": 97,
            "section_rank": 19,
            "entity_spans": [
                {
                    "start": 94,
                    "end": 99,
                    "type": "software",
                    "rawForm": "ROOT",
                    "resp": "service",
                    "id": "software-simple-s17"
                }
            ]
        },
        {
            "text": "\u2022 --permissive to override the check of the gcc or ROOT versions when using the previous option.",
            "section": "Installation and examples",
            "paragraph_rank": 98,
            "section_rank": 19,
            "entity_spans": [
                {
                    "start": 51,
                    "end": 56,
                    "type": "software",
                    "rawForm": "ROOT",
                    "resp": "service",
                    "id": "software-simple-s18"
                }
            ]
        },
        {
            "text": "If no option is used, the libraries will be compiled by ROOT to be used with an interpreted macro, without the C++11 features. ",
            "section": "Installation and examples",
            "paragraph_rank": 99,
            "section_rank": 19
        },
        {
            "text": "Once installed, OpTHyLiC can be used from any location when opening a new shell, by running the script setup.",
            "section": "Installation and examples",
            "paragraph_rank": 99,
            "section_rank": 19
        },
        {
            "text": "[c]sh. ",
            "section": "Installation and examples",
            "paragraph_rank": 100,
            "section_rank": 19
        },
        {
            "text": "Two examples of programs using OpTHyLiC, runLimits.C and runSignificance.C, are provided in the examples sub-directory, together with examples of input files \"input1.dat\", \"input2.dat\", \"inputHistos.dat\" and \"inputHistosAlternativeSyntax.dat\", the syntax of which is detailed in Sec. 5.3 (\"input1.dat\" and \"input2.dat\" illustrate the syntax for counting experiments and \"inputHistos.dat\" and \"inputHistosAlternativeSyntax.dat\" for multi-bin experiments). ",
            "section": "Installation and examples",
            "paragraph_rank": 100,
            "section_rank": 19,
            "entity_spans": [
                {
                    "start": 187,
                    "end": 198,
                    "type": "software",
                    "rawForm": "inputHistos",
                    "resp": "service",
                    "id": "software-simple-s19"
                },
                {
                    "start": 371,
                    "end": 382,
                    "type": "software",
                    "rawForm": "inputHistos",
                    "resp": "service",
                    "id": "software-simple-s20"
                }
            ]
        },
        {
            "text": "The example runLimits.C illustrates the calculation of expected and observed limits, while runSignificance.C shows how to plot the test statistic distribution under the background only and signal plus background hypotheses and calculate the observed and expected p-values and significances. ",
            "section": "Installation and examples",
            "paragraph_rank": 100,
            "section_rank": 19
        },
        {
            "text": "The syntax of the main functions used in both examples is explained in Sec. 5.4.",
            "section": "Installation and examples",
            "paragraph_rank": 100,
            "section_rank": 19
        },
        {
            "text": "These example programs can be run using the following syntax:",
            "section": "Installation and examples",
            "paragraph_rank": 101,
            "section_rank": 19
        },
        {
            "text": "\u2022 root -l load.C 'runLimits.C(\"input1.dat\", \"input2.dat\")' when used as a ROOT macro;",
            "section": "Installation and examples",
            "paragraph_rank": 102,
            "section_rank": 19
        },
        {
            "text": "\u2022 .",
            "section": "Installation and examples",
            "paragraph_rank": 103,
            "section_rank": 19
        },
        {
            "text": "/runLimits.exe --files input1.dat input2.dat when used as an executable.",
            "section": "Installation and examples",
            "paragraph_rank": 103,
            "section_rank": 19
        },
        {
            "text": "Here, files for counting experiments are provided. ",
            "section": "Installation and examples",
            "paragraph_rank": 104,
            "section_rank": 19
        },
        {
            "text": "Files for multi-bin experiments are provided using exactly the same syntax (OpTHyLiC automatically recognises what type of input files are provided by the user and applies the right treatment in each case). ",
            "section": "Installation and examples",
            "paragraph_rank": 104,
            "section_rank": 19
        },
        {
            "text": "The input files don't have to be of the same type. ",
            "section": "Installation and examples",
            "paragraph_rank": 104,
            "section_rank": 19
        },
        {
            "text": "For example, it is possible to provide one file using the counting experiment syntax and another file using the multi-bin experiment syntax :",
            "section": "Installation and examples",
            "paragraph_rank": 104,
            "section_rank": 19
        },
        {
            "text": "\u2022 root -l load.C 'runLimits.C(\"input1.dat\", \"inputHistosAlternativeSyntax.dat\")' ;",
            "section": "Installation and examples",
            "paragraph_rank": 105,
            "section_rank": 19
        },
        {
            "text": "\u2022 .",
            "section": "Installation and examples",
            "paragraph_rank": 106,
            "section_rank": 19
        },
        {
            "text": "/runLimits.exe --files input1.dat inputHistosAlternativeSyntax.dat",
            "section": "Installation and examples",
            "paragraph_rank": 106,
            "section_rank": 19
        },
        {
            "text": "In these examples, preprocessor directives are used to allow their use in both modes, or to enable the C++11 features. ",
            "section": "Installation and examples",
            "paragraph_rank": 107,
            "section_rank": 19
        },
        {
            "text": "In the first mode, these examples can also be run from any location, if the load.C macro written to load the shared libraries is run before. ",
            "section": "Installation and examples",
            "paragraph_rank": 107,
            "section_rank": 19
        },
        {
            "text": "In the second mode, the executable can be moved to any location; furthermore, any program located in the examples sub-directory would be compiled when running the make command, as long as its name is of the form run*.",
            "section": "Installation and examples",
            "paragraph_rank": 107,
            "section_rank": 19
        },
        {
            "text": "C.",
            "section": "Installation and examples",
            "paragraph_rank": 107,
            "section_rank": 19
        },
        {
            "text": "Input file format",
            "section_rank": 20
        },
        {
            "text": "The input file format depends on the type of experiment. ",
            "section": "Input file format",
            "paragraph_rank": 108,
            "section_rank": 20
        },
        {
            "text": "The format for counting experiments is described in Sec. 5.3.1 and the one for multi-bin experiments is described in Sec. 5.3.2. ",
            "section": "Input file format",
            "paragraph_rank": 108,
            "section_rank": 20
        },
        {
            "text": "In both cases, users must create one input file per channel.",
            "section": "Input file format",
            "paragraph_rank": 108,
            "section_rank": 20
        },
        {
            "text": "Counting experiment",
            "section_rank": 21
        },
        {
            "text": "The general structure of the files is shown if Fig. 4.  ",
            "section": "Counting experiment",
            "paragraph_rank": 109,
            "section_rank": 21,
            "ref_spans": [
                {
                    "start": 47,
                    "end": 53,
                    "type": "figure",
                    "ref_id": "fig_5",
                    "text": "Fig. 4"
                }
            ]
        },
        {
            "text": "The block starting with the +sig tag defines the signal sample. ",
            "section": "Counting experiment",
            "paragraph_rank": 109,
            "section_rank": 21
        },
        {
            "text": "Blocks starting with the +bg tag define the background samples. ",
            "section": "Counting experiment",
            "paragraph_rank": 109,
            "section_rank": 21
        },
        {
            "text": "Finally, the observation is defined with the +data tag. ",
            "section": "Counting experiment",
            "paragraph_rank": 109,
            "section_rank": 21
        },
        {
            "text": "Systematic uncertainties are declared using the .",
            "section": "Counting experiment",
            "paragraph_rank": 109,
            "section_rank": 21
        },
        {
            "text": "syst tag. ",
            "section": "Counting experiment",
            "paragraph_rank": 109,
            "section_rank": 21
        },
        {
            "text": "Fields <name> define the names for signal, backgrounds and systematic uncertainties. ",
            "section": "Counting experiment",
            "paragraph_rank": 109,
            "section_rank": 21
        },
        {
            "text": "Fields <yield> define the nominal yields for signal and backgrounds and the observed yield for data. ",
            "section": "Counting experiment",
            "paragraph_rank": 109,
            "section_rank": 21
        },
        {
            "text": "Fields <stat> define the absolute statistical uncertainty for signal and backgrounds. ",
            "section": "Counting experiment",
            "paragraph_rank": 109,
            "section_rank": 21
        },
        {
            "text": "Fields <up> and <down> define h \u2191 and h \u2193 for each systematic uncertainty. ",
            "section": "Counting experiment",
            "paragraph_rank": 109,
            "section_rank": 21
        },
        {
            "text": "When systematics for different samples (signal or backgrounds) or different channels have the same name they are supposed 100% correlated (i.e. they are described by a unique nuisance parameter \u03b7 j ). ",
            "section": "Counting experiment",
            "paragraph_rank": 109,
            "section_rank": 21
        },
        {
            "text": "Otherwise they are treated as uncorrelated. ",
            "section": "Counting experiment",
            "paragraph_rank": 109,
            "section_rank": 21
        },
        {
            "text": "Lines starting with # are not interpreted. ",
            "section": "Counting experiment",
            "paragraph_rank": 109,
            "section_rank": 21
        },
        {
            "text": "The order in which the signal, background and data block appear does not matter.",
            "section": "Counting experiment",
            "paragraph_rank": 109,
            "section_rank": 21
        },
        {
            "text": "LaTeX tables summarizing yields and uncertainties can be produced (see Sec. 5.4.2 for instructions on how to do this). ",
            "section": "Counting experiment",
            "paragraph_rank": 110,
            "section_rank": 21,
            "entity_spans": [
                {
                    "start": 0,
                    "end": 6,
                    "type": "software",
                    "rawForm": "LaTeX",
                    "resp": "service",
                    "id": "software-simple-s21"
                }
            ]
        },
        {
            "text": "By default, the sample and systematic names used in these tables are the ones specified in the input files in the <name> fields. ",
            "section": "Counting experiment",
            "paragraph_rank": 110,
            "section_rank": 21
        },
        {
            "text": "The user can change background sample names by adding .",
            "section": "Counting experiment",
            "paragraph_rank": 110,
            "section_rank": 21
        },
        {
            "text": "nameLaTeX tags in background sample blocks. ",
            "section": "Counting experiment",
            "paragraph_rank": 110,
            "section_rank": 21
        },
        {
            "text": "Systematic names can be changed by creating a dictionnary file mapping names as specified in the <name> fields to names used for LaTeX tables. ",
            "section": "Counting experiment",
            "paragraph_rank": 110,
            "section_rank": 21,
            "entity_spans": [
                {
                    "start": 129,
                    "end": 135,
                    "type": "software",
                    "rawForm": "LaTeX",
                    "resp": "service",
                    "id": "software-simple-s22"
                }
            ]
        },
        {
            "text": "Channel names used for LaTeX tables can also be specified by adding +nameLaTeX tags in the input files.  ",
            "section": "Counting experiment",
            "paragraph_rank": 110,
            "section_rank": 21,
            "entity_spans": [
                {
                    "start": 23,
                    "end": 29,
                    "type": "software",
                    "rawForm": "LaTeX",
                    "resp": "service",
                    "id": "software-simple-s23"
                }
            ]
        },
        {
            "text": "sance parameters \u03b7 j ) is 4. ",
            "section": "Counting experiment",
            "paragraph_rank": 110,
            "section_rank": 21
        },
        {
            "text": "The one called Syst1 in the input files (JES in the LaTeX tables) affects the background yield of the first channel and signal yields of the two channels. ",
            "section": "Counting experiment",
            "paragraph_rank": 110,
            "section_rank": 21,
            "entity_spans": [
                {
                    "start": 52,
                    "end": 58,
                    "type": "software",
                    "rawForm": "LaTeX",
                    "resp": "service",
                    "id": "software-simple-s24"
                }
            ]
        },
        {
            "text": "LaTeX tables produced by OpTHyLiC for this example are shown in Tab. ",
            "section": "Counting experiment",
            "paragraph_rank": 110,
            "section_rank": 21,
            "entity_spans": [
                {
                    "start": 0,
                    "end": 6,
                    "type": "software",
                    "rawForm": "LaTeX",
                    "resp": "service",
                    "id": "software-simple-s25"
                }
            ]
        },
        {
            "text": "4, 5, 6 and 7, including captions that are generated automatically. ",
            "section": "Counting experiment",
            "paragraph_rank": 110,
            "section_rank": 21
        },
        {
            "text": "Tab. ",
            "section": "Counting experiment",
            "paragraph_rank": 110,
            "section_rank": 21
        },
        {
            "text": "4 gives the observed yields in all channels. ",
            "section": "Counting experiment",
            "paragraph_rank": 110,
            "section_rank": 21
        },
        {
            "text": "Expected nominal yields together with their statistical and total systematic uncertainties for all samples are also given. ",
            "section": "Counting experiment",
            "paragraph_rank": 110,
            "section_rank": 21
        },
        {
            "text": "Expected nominal yields and statistical uncertainties are those given by the user in the input files. ",
            "section": "Counting experiment",
            "paragraph_rank": 110,
            "section_rank": 21
        },
        {
            "text": "The total systematic uncertainties are given by the squared sum of the systematic uncertainties provided by the user in the input files. ",
            "section": "Counting experiment",
            "paragraph_rank": 110,
            "section_rank": 21
        },
        {
            "text": "Table. ",
            "section": "Counting experiment",
            "paragraph_rank": 110,
            "section_rank": 21,
            "ref_spans": [
                {
                    "start": 0,
                    "end": 6,
                    "type": "table",
                    "text": "Table."
                }
            ]
        },
        {
            "text": "5 also gives observed and expected yields with uncertainties for all samples in all channels. ",
            "section": "Counting experiment",
            "paragraph_rank": 110,
            "section_rank": 21
        },
        {
            "text": "However, expected yields and their uncertainties are now computed from quantiles of the marginal distribution of the yield (where the marginalization is performed over all nuisance parameters, statistical and systematic). ",
            "section": "Counting experiment",
            "paragraph_rank": 110,
            "section_rank": 21
        },
        {
            "text": "The expected yields are given by the medians of the marginal distributions and the intervals between the lower and upper uncertainty are the 1\u03c3 confidence level interval.     ",
            "section": "Counting experiment",
            "paragraph_rank": 110,
            "section_rank": 21
        },
        {
            "text": "Table 7: List of relative systematic uncertainties (in %) for channel \u00b5\u00b5.",
            "section": "Counting experiment",
            "paragraph_rank": 110,
            "section_rank": 21,
            "ref_spans": [
                {
                    "start": 0,
                    "end": 7,
                    "type": "table",
                    "text": "Table 7"
                }
            ]
        },
        {
            "text": "Multi-bin experiment",
            "section_rank": 22
        },
        {
            "text": "Two syntaxes can be used. ",
            "section": "Multi-bin experiment",
            "paragraph_rank": 111,
            "section_rank": 22
        },
        {
            "text": "Both are similar to that for counting experiments, except that ROOT files containing histograms are provided instead of numbers. ",
            "section": "Multi-bin experiment",
            "paragraph_rank": 111,
            "section_rank": 22
        },
        {
            "text": "Only differences with respect to the syntax described in Sec. 5.3.1 are therefore described.",
            "section": "Multi-bin experiment",
            "paragraph_rank": 111,
            "section_rank": 22
        },
        {
            "text": "Syntax 1:. ",
            "section": "Multi-bin experiment",
            "paragraph_rank": 112,
            "section_rank": 22
        },
        {
            "text": "This syntax can be used only if all ROOT files are in the same directory and all histograms inside them have the same name. ",
            "section": "Multi-bin experiment",
            "paragraph_rank": 112,
            "section_rank": 22
        },
        {
            "text": "The general structure of the files is shown in Fig. 7. ",
            "section": "Multi-bin experiment",
            "paragraph_rank": 112,
            "section_rank": 22,
            "ref_spans": [
                {
                    "start": 47,
                    "end": 53,
                    "type": "figure",
                    "ref_id": "fig_8",
                    "text": "Fig. 7"
                }
            ]
        },
        {
            "text": "An example of such a file is \"inputHistos.dat\" in the examples sub-directory.  ",
            "section": "Multi-bin experiment",
            "paragraph_rank": 112,
            "section_rank": 22
        },
        {
            "text": "The block starting with the +setup tag defines the fields that are common to all samples declared in the file (signal, backgrounds and data). ",
            "section": "Multi-bin experiment",
            "paragraph_rank": 112,
            "section_rank": 22
        },
        {
            "text": "Field <dir> defines the directory containing all the ROOT files. ",
            "section": "Multi-bin experiment",
            "paragraph_rank": 112,
            "section_rank": 22
        },
        {
            "text": "Field <hname> defines the name of the histograms inside the ROOT files. ",
            "section": "Multi-bin experiment",
            "paragraph_rank": 112,
            "section_rank": 22
        },
        {
            "text": "Fields <root-file> define the names of the ROOT files located in the <dir> directory containing the nominal histograms. ",
            "section": "Multi-bin experiment",
            "paragraph_rank": 112,
            "section_rank": 22
        },
        {
            "text": "Bin uncertainties are used for absolute statistical uncertainties. ",
            "section": "Multi-bin experiment",
            "paragraph_rank": 112,
            "section_rank": 22
        },
        {
            "text": "Therefore, care must be taken in the case of histograms filled with weighted entries. ",
            "section": "Multi-bin experiment",
            "paragraph_rank": 112,
            "section_rank": 22
        },
        {
            "text": "Fields <root-file up> and <root-file down> define the names of the ROOT files located in the <dir> directory containing the varied histograms when systematic uncertainties are shifted by +1\u03c3 and \u22121\u03c3 respectively. ",
            "section": "Multi-bin experiment",
            "paragraph_rank": 112,
            "section_rank": 22
        },
        {
            "text": "These histograms must contain yields in each bin (that is, as opposed to the counting experiment case, yields after systematic variation are provided rather than relative variations). ",
            "section": "Multi-bin experiment",
            "paragraph_rank": 112,
            "section_rank": 22
        },
        {
            "text": "In addition, bin uncertainties for systematic histograms are not used and can be set to 0 or any other value.",
            "section": "Multi-bin experiment",
            "paragraph_rank": 112,
            "section_rank": 22
        },
        {
            "text": "+setup",
            "section_rank": 23
        },
        {
            "text": "Syntax 2:",
            "section_rank": 24
        },
        {
            "text": ". This syntax can be used in all cases, even if all ROOT files aren't in the same directory and all histograms inside them don't have the same name. The general structure of the files is shown in Fig. 8. An example of such file is \"inputHistosAlternativeSyntax.dat\" in the examples subdirectory.",
            "section": "Syntax 2:",
            "paragraph_rank": 113,
            "section_rank": 24,
            "ref_spans": [
                {
                    "start": 196,
                    "end": 202,
                    "type": "figure",
                    "ref_id": "fig_9",
                    "text": "Fig. 8"
                }
            ]
        },
        {
            "text": "+sig <sig_name> <root-file>(<hname>) .",
            "section": "Syntax 2:",
            "paragraph_rank": 114,
            "section_rank": 24
        },
        {
            "text": "syst <sys1_name> <root-file up>(<hname>) <root-file down>(<hname>) .",
            "section": "Syntax 2:",
            "paragraph_rank": 114,
            "section_rank": 24
        },
        {
            "text": "syst <sys2_name> <root-file up>(<hname>) <root-file down>(<hname>) +bg <bkg1_name> <root-file>(<hname>) .",
            "section": "Syntax 2:",
            "paragraph_rank": 114,
            "section_rank": 24
        },
        {
            "text": "syst <sys1_name> <root-file up>(<hname>) <root-file down>(<hname>) .",
            "section": "Syntax 2:",
            "paragraph_rank": 114,
            "section_rank": 24
        },
        {
            "text": "syst <sys2_name> <root-file up>(<hname>) <root-file down>(<hname>) +bg <bkg2_name> <root-file>(<hname>) .",
            "section": "Syntax 2:",
            "paragraph_rank": 114,
            "section_rank": 24
        },
        {
            "text": "syst <sys1_name> <root-file up>(<hname>) <root-file down>(<hname>) .",
            "section": "Syntax 2:",
            "paragraph_rank": 114,
            "section_rank": 24
        },
        {
            "text": "syst <sys2_name> <root-file up>(<hname>) <root-file down>(<hname>) # ... # add as many backgrounds as needed # ... ",
            "section": "Syntax 2:",
            "paragraph_rank": 114,
            "section_rank": 24
        },
        {
            "text": "Fields <root-file>, <root-file up> and <root-file down> define the full path names of the ROOT files containing the nominal and varied histograms. ",
            "section": "Syntax 2:",
            "paragraph_rank": 114,
            "section_rank": 24
        },
        {
            "text": "Fields <hname> define the names of the histograms inside the ROOT files. ",
            "section": "Syntax 2:",
            "paragraph_rank": 114,
            "section_rank": 24
        },
        {
            "text": "They must be between parentheses with no blank space between the left parenthesis and the ROOT file name.",
            "section": "Syntax 2:",
            "paragraph_rank": 114,
            "section_rank": 24
        },
        {
            "text": "+data <root file>(<hname>)",
            "section_rank": 25
        },
        {
            "text": "Running the software 5.4.1. ",
            "section_rank": 26
        },
        {
            "text": "Configuration",
            "section_rank": 26
        },
        {
            "text": "In order to use the software, users need to load the OpTHyLiC library, instantiate an object of type OpTHyLiC and add channels. ",
            "section": "Running the software 5.4.1. Configuration",
            "paragraph_rank": 115,
            "section_rank": 26
        },
        {
            "text": "This can be done interactively in a ROOT session as follows:",
            "section": "Running the software 5.4.1. Configuration",
            "paragraph_rank": 115,
            "section_rank": 26
        },
        {
            "text": "gSystem->Load(\"OpTHyLiC_C\"); OpTHyLiC oth(OTH::SystMclimit, OTH::StatNormal,OTH::TR3,0, OTH::CombAutomatic); oth.addChannel(\"channel 1 name\",file1); oth.addChannel(\"channel 2 name\",file2); ... ",
            "section": "Running the software 5.4.1. Configuration",
            "paragraph_rank": 116,
            "section_rank": 26,
            "entity_spans": [
                {
                    "start": 65,
                    "end": 75,
                    "type": "software",
                    "rawForm": "StatNormal",
                    "resp": "service",
                    "id": "software-simple-s26"
                },
                {
                    "start": 93,
                    "end": 106,
                    "type": "software",
                    "rawForm": "CombAutomatic",
                    "resp": "service",
                    "id": "software-simple-s27"
                }
            ]
        },
        {
            "text": "In addition, three optional parameters can be provided. ",
            "section": "Running the software 5.4.1. Configuration",
            "paragraph_rank": 116,
            "section_rank": 26
        },
        {
            "text": "The first one is the type of pseudo-random number engine: the possible values are OTH::TR3 (used by default), and, if C++11 features are available, OTH::STD_ followed by the name of one of the nine engines implemented in the C++11 standard library (mt19937, mt19937_64, minstd_rand, minstd_rand0, ranlux24_base, ranlux48_base, ranlux24, ranlux48, knuth_b). ",
            "section": "Running the software 5.4.1. Configuration",
            "paragraph_rank": 116,
            "section_rank": 26
        },
        {
            "text": "The second one is the seed of this engine; the default value 0 has the effect of setting a randomly generated seed. ",
            "section": "Running the software 5.4.1. Configuration",
            "paragraph_rank": 116,
            "section_rank": 26
        },
        {
            "text": "The third one is the chosen solution for the combination of systematic uncertainties, as described in Sec. 4.3: the possible values are OTH::CombAdditive, OTH::CombMultiplicative, or OTH::CombAutomatic (used by default), the latter requesting additive (multiplicative) combination when the OTH::SystLinear or OTH::SystMclimit (OTH::SystExpo or OTH::SystPolyexpo) options is used for the interpolation/extrapolation method.",
            "section": "Running the software 5.4.1. Configuration",
            "paragraph_rank": 116,
            "section_rank": 26,
            "entity_spans": [
                {
                    "start": 188,
                    "end": 202,
                    "type": "software",
                    "rawForm": "CombAutomatic",
                    "resp": "service",
                    "id": "software-simple-s28"
                }
            ]
        },
        {
            "text": "The addChannel member function takes three parameters. ",
            "section": "Running the software 5.4.1. Configuration",
            "paragraph_rank": 117,
            "section_rank": 26
        },
        {
            "text": "The first two ones are of std::string type and correspond to the name of the channel and the name of the input file (see Sec. 5.3) respectively. ",
            "section": "Running the software 5.4.1. Configuration",
            "paragraph_rank": 117,
            "section_rank": 26,
            "ref_spans": [
                {
                    "start": 126,
                    "end": 127,
                    "type": "bibr",
                    "ref_id": "b3",
                    "text": "5"
                }
            ]
        },
        {
            "text": "The third one, used only in the case of multi-bin experiments, is a boolean set by default to true. ",
            "section": "Running the software 5.4.1. Configuration",
            "paragraph_rank": 117,
            "section_rank": 26
        },
        {
            "text": "In the case of multi-bin experiments, OpTHyLiC converts the input file and ROOT files provided by the user into multiple counting experiment files (written using the syntax described in Sec. 5.3.1). ",
            "section": "Running the software 5.4.1. Configuration",
            "paragraph_rank": 117,
            "section_rank": 26,
            "entity_spans": [
                {
                    "start": 75,
                    "end": 80,
                    "type": "software",
                    "rawForm": "ROOT",
                    "resp": "service",
                    "id": "software-simple-s29"
                }
            ]
        },
        {
            "text": "More precisely, OpTHyLiC creates one counting experiment file per bin of discriminating variable (only bins containing either a non-zero yield or a non-zero statistical uncertainty for the signal and total background are considered). ",
            "section": "Running the software 5.4.1. Configuration",
            "paragraph_rank": 117,
            "section_rank": 26
        },
        {
            "text": "If the third parameter is set to false, counting experiment files created by OpTHyLiC are dumped on disk, in the same directory as the input file. ",
            "section": "Running the software 5.4.1. Configuration",
            "paragraph_rank": 117,
            "section_rank": 26
        },
        {
            "text": "Their names are of the form fileName_bin\u03b8.",
            "section": "Running the software 5.4.1. Configuration",
            "paragraph_rank": 117,
            "section_rank": 26
        },
        {
            "text": "ext, where fileName is the name of the input file, ext its extension and \u03b8 is the bin index. ",
            "section": "Running the software 5.4.1. Configuration",
            "paragraph_rank": 117,
            "section_rank": 26
        },
        {
            "text": "These files can be useful for debugging or for running OpTHyLiC over a subset of bins.",
            "section": "Running the software 5.4.1. Configuration",
            "paragraph_rank": 117,
            "section_rank": 26
        },
        {
            "text": "As mentioned in Sec. 4.1, for multi-bin experiments the histogram bins are treated in the same way as channels in counting experiments. ",
            "section": "Running the software 5.4.1. Configuration",
            "paragraph_rank": 118,
            "section_rank": 26
        },
        {
            "text": "Therefore, in the rest of this paper the term \"channel\" refers in such case to a bin of the discriminating variable distribution in one channel, reflecting the software structure.",
            "section": "Running the software 5.4.1. Configuration",
            "paragraph_rank": 118,
            "section_rank": 26
        },
        {
            "text": "LaTeX tables production",
            "section_rank": 27,
            "entity_spans": [
                {
                    "start": 0,
                    "end": 6,
                    "type": "software",
                    "rawForm": "LaTeX",
                    "resp": "service",
                    "id": "software-simple-s30"
                }
            ]
        },
        {
            "text": "LaTeX tables are produced as follows:",
            "section": "LaTeX tables production",
            "paragraph_rank": 119,
            "section_rank": 27,
            "entity_spans": [
                {
                    "start": 0,
                    "end": 6,
                    "type": "software",
                    "rawForm": "LaTeX",
                    "resp": "service",
                    "id": "software-simple-s31"
                }
            ]
        },
        {
            "text": "ofstream ofs(filename); int precision = -1; int NpseudoExps = 1000000; oth.createInputYieldTable(ofs,precision); oth.createGeneratedYieldTable(ofs, precision,NpseudoExps); oth.createSysteTables(ofs,\"systDict.txt\", precision);",
            "section": "LaTeX tables production",
            "paragraph_rank": 120,
            "section_rank": 27
        },
        {
            "text": "These three methods take as first parameter an output stream, which can be the standard output (std::cout). ",
            "section": "LaTeX tables production",
            "paragraph_rank": 121,
            "section_rank": 27
        },
        {
            "text": "The functions createInputYieldTable and createGeneratedYieldTable produce tables of expected and observed yields. ",
            "section": "LaTeX tables production",
            "paragraph_rank": 121,
            "section_rank": 27
        },
        {
            "text": "In the first case, the total uncertainty for each process is evaluated by summing in quadrature all uncertainties without taking into account the correlations, while in the second case the total uncertainty is assessed by using pseudo-experiments (the number of pseudo-experiments is given as the facultative third parameter). ",
            "section": "LaTeX tables production",
            "paragraph_rank": 121,
            "section_rank": 27
        },
        {
            "text": "An example of such tables are shown in Tab. ",
            "section": "LaTeX tables production",
            "paragraph_rank": 121,
            "section_rank": 27
        },
        {
            "text": "4 and 5. ",
            "section": "LaTeX tables production",
            "paragraph_rank": 121,
            "section_rank": 27
        },
        {
            "text": "The precision of the numbers in these tables can be adjusted to a fixed value (given as the second parameter) or to be automatically adjusted depending on the size of the uncertainties (when the precision parameter is set to -1, which is the default value).",
            "section": "LaTeX tables production",
            "paragraph_rank": 121,
            "section_rank": 27
        },
        {
            "text": "The function createSysteTables creates one table for each channel which summarises all the systematic uncertainties. ",
            "section": "LaTeX tables production",
            "paragraph_rank": 122,
            "section_rank": 27
        },
        {
            "text": "Examples of such tables are shown in Tab. ",
            "section": "LaTeX tables production",
            "paragraph_rank": 122,
            "section_rank": 27
        },
        {
            "text": "6 and 7. ",
            "section": "LaTeX tables production",
            "paragraph_rank": 122,
            "section_rank": 27
        },
        {
            "text": "The second parameter of createSysteTables is a string specifying the dictionary file. ",
            "section": "LaTeX tables production",
            "paragraph_rank": 122,
            "section_rank": 27
        },
        {
            "text": "An example of such a file is given in Fig. 6.",
            "section": "LaTeX tables production",
            "paragraph_rank": 122,
            "section_rank": 27,
            "ref_spans": [
                {
                    "start": 38,
                    "end": 44,
                    "type": "figure",
                    "text": "Fig. 6"
                }
            ]
        },
        {
            "text": "Observed limit computation",
            "section_rank": 28
        },
        {
            "text": "Observed limits are computed as follows: double cls; double limit=oth.sigStrengthExclusion( OTH::LimObserved,nbExp,cls);",
            "section": "Observed limit computation",
            "paragraph_rank": 123,
            "section_rank": 28
        },
        {
            "text": "The first parameter of function sigStrengthExclusion defines the limit type (here observed). ",
            "section": "Observed limit computation",
            "paragraph_rank": 124,
            "section_rank": 28
        },
        {
            "text": "Other types can be used for expected limits (see Sec. 5.4.4).",
            "section": "Observed limit computation",
            "paragraph_rank": 124,
            "section_rank": 28
        },
        {
            "text": "The second parameter (nbExp) is the number of pseudo-experiments and the third parameter the final CL s value (corresponding to the exclusion). ",
            "section": "Observed limit computation",
            "paragraph_rank": 125,
            "section_rank": 28
        },
        {
            "text": "An optional fourth parameter may be provided and corresponds to a hint of the observed limit. ",
            "section": "Observed limit computation",
            "paragraph_rank": 125,
            "section_rank": 28
        },
        {
            "text": "This value does not affect the result of the computation but only its speed: giving a hint that is rather close to the final value would most probably speed up the process. ",
            "section": "Observed limit computation",
            "paragraph_rank": 125,
            "section_rank": 28
        },
        {
            "text": "Finally, an optional fifth parameter may be used to determine which method to use for the computation. ",
            "section": "Observed limit computation",
            "paragraph_rank": 125,
            "section_rank": 28
        },
        {
            "text": "The default value (OTH::MethDichotomy) is the most accurate one. ",
            "section": "Observed limit computation",
            "paragraph_rank": 125,
            "section_rank": 28
        },
        {
            "text": "The other possibility is to use an extrapolation method (OTH::MethExtrapol) that is faster but sometimes less accurate. ",
            "section": "Observed limit computation",
            "paragraph_rank": 125,
            "section_rank": 28
        },
        {
            "text": "By default, the computed limits are for a 95% confidence level. ",
            "section": "Observed limit computation",
            "paragraph_rank": 125,
            "section_rank": 28
        },
        {
            "text": "It is possible to modify this confidence level as follows:",
            "section": "Observed limit computation",
            "paragraph_rank": 125,
            "section_rank": 28
        },
        {
            "text": "oth.setConfLevel(0.9); for example for a 90% confidence level.",
            "section": "Observed limit computation",
            "paragraph_rank": 126,
            "section_rank": 28
        },
        {
            "text": "Expected limits computation",
            "section_rank": 29
        },
        {
            "text": "Two methods are provided to compute expected limits as described in Sec. 4.5.",
            "section": "Expected limits computation",
            "paragraph_rank": 127,
            "section_rank": 29
        },
        {
            "text": "Significance computation",
            "section_rank": 30
        },
        {
            "text": "In addition to observed and expected upper limits, OpTHyLiC can be used to compute the significance of an observation using: std::pair<double, double> r = oth.significance(type,nbExp,mu);",
            "section": "Significance computation",
            "paragraph_rank": 128,
            "section_rank": 30
        },
        {
            "text": "where type is the type of significance, nbExp the number of pseudoexperiments and mu the signal strength (set by default to 1 if not specified).",
            "section": "Significance computation",
            "paragraph_rank": 129,
            "section_rank": 30
        },
        {
            "text": "The possible values for type are OTH::SignifObserved, OTH::SignifExpectedP2sig, OTH::SignifExpectedP1sig, OTH::SignifExpectedMed, OTH::SignifExpectedM1sig, OTH::SignifExpectedM2sig.",
            "section": "Significance computation",
            "paragraph_rank": 130,
            "section_rank": 30
        },
        {
            "text": "If OTH::SignifObserved is used, the observed significance is computed. ",
            "section": "Significance computation",
            "paragraph_rank": 131,
            "section_rank": 30
        },
        {
            "text": "Otherwise, expected significances under the signal plus background hypothesis are computed.",
            "section": "Significance computation",
            "paragraph_rank": 131,
            "section_rank": 30
        },
        {
            "text": "The significance method returns a std::pair<double, double>. ",
            "section": "Significance computation",
            "paragraph_rank": 132,
            "section_rank": 30
        },
        {
            "text": "The first element of the pair corresponds to the p-value given by:",
            "section": "Significance computation",
            "paragraph_rank": 132,
            "section_rank": 30
        },
        {
            "text": "and the second one to the significance z in units of normal distribution standard deviation. ",
            "section": "Significance computation",
            "paragraph_rank": 133,
            "section_rank": 30
        },
        {
            "text": "It is given by:",
            "section": "Significance computation",
            "paragraph_rank": 133,
            "section_rank": 30
        },
        {
            "text": "5.4.7. ",
            "section": "Significance computation",
            "paragraph_rank": 134,
            "section_rank": 30
        },
        {
            "text": "Access to histograms During the limit computation, several histograms are produced. ",
            "section": "Significance computation",
            "paragraph_rank": 134,
            "section_rank": 30
        },
        {
            "text": "After the computation, some of these histograms are available.",
            "section": "Significance computation",
            "paragraph_rank": 134,
            "section_rank": 30
        },
        {
            "text": "The final q \u00b5 distributions can be accessed using the following commands:",
            "section": "Significance computation",
            "paragraph_rank": 135,
            "section_rank": 30
        },
        {
            "text": "oth.getHistoLLRb()->Draw(); oth.getHistoLLRsb()->Draw(\"same\");",
            "section": "Significance computation",
            "paragraph_rank": 136,
            "section_rank": 30
        },
        {
            "text": "In the case of the alternative expected limit computation, the q \u00b5 distributions are not accessible but two other histograms are available:",
            "section": "Significance computation",
            "paragraph_rank": 137,
            "section_rank": 30
        },
        {
            "text": "oth.getDistrExpMu()->Draw(); oth.getDistrCLs()->Draw();",
            "section": "Significance computation",
            "paragraph_rank": 138,
            "section_rank": 30
        },
        {
            "text": "where the first one is the expected distribution of \u00b5 up from which the expected limits are derived and the last one is the full distribution of computed CL s (that should peak at 1-confidence level).",
            "section": "Significance computation",
            "paragraph_rank": 139,
            "section_rank": 30
        },
        {
            "text": "Other interesting distributions are channel dependent, therefore the user must first access a specific channel. ",
            "section": "Significance computation",
            "paragraph_rank": 140,
            "section_rank": 30
        },
        {
            "text": "There are two ways to do so:",
            "section": "Significance computation",
            "paragraph_rank": 140,
            "section_rank": 30
        },
        {
            "text": "\u2022 oth.getChannel(\"name\") where name is the name of the channel,",
            "section": "Significance computation",
            "paragraph_rank": 141,
            "section_rank": 30
        },
        {
            "text": "\u2022 oth.getChannel(index) where index is the index of the channel returned by the addChannel function.",
            "section": "Significance computation",
            "paragraph_rank": 142,
            "section_rank": 30
        },
        {
            "text": "In the case of multi-bin experiment, \"name\" should be of the form channelName_bin\u03b8, where channelName is the name of the channel specified by the user (first parameter of the addChannel method) and \u03b8 is the bin index. ",
            "section": "Significance computation",
            "paragraph_rank": 143,
            "section_rank": 30
        },
        {
            "text": "The final q \u00b5 distributions for a single channel can be accessed using the following commands:",
            "section": "Significance computation",
            "paragraph_rank": 143,
            "section_rank": 30
        },
        {
            "text": "oth.getChannel(index) ->getHistoLLRb()->Draw(); oth.getChannel(index) ->getHistoLLRsb()->Draw(\"same\");",
            "section": "Significance computation",
            "paragraph_rank": 144,
            "section_rank": 30
        },
        {
            "text": "as well as the distributions of number of events:",
            "section": "Significance computation",
            "paragraph_rank": 145,
            "section_rank": 30
        },
        {
            "text": "oth.getChannel(index) ->getHisto(OTH::Channel::hDistrBg) ->Draw(); oth.getChannel(index) ->getHisto(OTH::Channel::hDistrSB) ->Draw(\"same\");",
            "section": "Significance computation",
            "paragraph_rank": 146,
            "section_rank": 30
        },
        {
            "text": "Other interesting histograms are the distributions of the systematic uncertainties, for example:",
            "section": "Significance computation",
            "paragraph_rank": 147,
            "section_rank": 30
        },
        {
            "text": "oth.getChannel(index) ->getSigSystDistr(\"Syst1\") ->Draw(); oth.getChannel(index) ->getBkgSystDistr(\"Bkg\",\"Syst2\") ->Draw();",
            "section": "Significance computation",
            "paragraph_rank": 148,
            "section_rank": 30
        },
        {
            "text": "where the last parameter is the name of the systematic uncertainty and the first parameter of the getBkgSystDistr function is the name of the background.",
            "section": "Significance computation",
            "paragraph_rank": 149,
            "section_rank": 30
        },
        {
            "text": "Single channel computations",
            "section_rank": 31
        },
        {
            "text": "To compute the limits for a single channel, not combining with the others, the following function is available: where the second one is the expected \u00b5 up as a function of the number of observed events. ",
            "section": "Single channel computations",
            "paragraph_rank": 150,
            "section_rank": 31
        },
        {
            "text": "It is also possible to study the distribution of the yields after the statistical and systematic variations. ",
            "section": "Single channel computations",
            "paragraph_rank": 150,
            "section_rank": 31
        },
        {
            "text": "In order to generate these distributions, the following function must be called: where the first function gives the distribution for the signal, the second one for a single background sample, and the third one is the distribution for the total background. ",
            "section": "Single channel computations",
            "paragraph_rank": 150,
            "section_rank": 31
        },
        {
            "text": "These distributions are also available after a call to createGeneratedYieldTable.",
            "section": "Single channel computations",
            "paragraph_rank": 150,
            "section_rank": 31
        },
        {
            "text": "Test statistic distribution and derived quantities",
            "section_rank": 32
        },
        {
            "text": "The test statistic distributions under background and signal plus background hypotheses for a desired value of the signal strength \u00b5 can be computed as follows:",
            "section": "Test statistic distribution and derived quantities",
            "paragraph_rank": 151,
            "section_rank": 32
        },
        {
            "text": "oth.setSigStrength(mu); oth.generateDistrLLR(nbExp);",
            "section": "Test statistic distribution and derived quantities",
            "paragraph_rank": 152,
            "section_rank": 32
        },
        {
            "text": "where mu is the desired \u00b5 value and nbExp is the number of pseudoexperiments. ",
            "section": "Test statistic distribution and derived quantities",
            "paragraph_rank": 153,
            "section_rank": 32
        },
        {
            "text": "Once this is done, distributions can be accessed as described in Sec. 5.4.7. ",
            "section": "Test statistic distribution and derived quantities",
            "paragraph_rank": 153,
            "section_rank": 32
        },
        {
            "text": "The p-value of the observation under the background hypothesis and the CL s can be computed as follows: where nObs is the observed yield. ",
            "section": "Test statistic distribution and derived quantities",
            "paragraph_rank": 153,
            "section_rank": 32
        },
        {
            "text": "For a single channel, the user can also compute the excluded yield for the chosen \u00b5 value using:",
            "section": "Test statistic distribution and derived quantities",
            "paragraph_rank": 153,
            "section_rank": 32
        },
        {
            "text": "int yield=oth.getChannel(index) ->findObsExclusion(); 5.5. ",
            "section": "Test statistic distribution and derived quantities",
            "paragraph_rank": 154,
            "section_rank": 32
        },
        {
            "text": "Improvement of the software performance Thanks to the absence of profiling, the computation of the pseudoexperiments could be optimised to minimise the number of random numbers that need to be drawn. ",
            "section": "Test statistic distribution and derived quantities",
            "paragraph_rank": 154,
            "section_rank": 32
        },
        {
            "text": "Moreover, when searching for the signal strength that corresponds to a given CL s , it is possible to use a simple extrapolation from two pairs of (CL s ,\u00b5) values, that is much faster than a real scan, but has a larger uncertainty on the result. ",
            "section": "Test statistic distribution and derived quantities",
            "paragraph_rank": 154,
            "section_rank": 32
        },
        {
            "text": "For a more precise but slower result, dichotomy is used, optimised by taking into account the logarithmic dependence between the CL s and the signal strength.",
            "section": "Test statistic distribution and derived quantities",
            "paragraph_rank": 154,
            "section_rank": 32
        },
        {
            "text": "As will be shown in Sec. 6.2, even with the dichotomy choice, observed and expected limits are in general computed very fast with OpTHyLiC compared to other software tools. ",
            "section": "Test statistic distribution and derived quantities",
            "paragraph_rank": 155,
            "section_rank": 32
        },
        {
            "text": "Speedups well over a factor of 10 have for example been achieved with respect to McLimit.",
            "section": "Test statistic distribution and derived quantities",
            "paragraph_rank": 155,
            "section_rank": 32
        },
        {
            "text": "Software validation",
            "section_rank": 33
        },
        {
            "text": "The computation of upper limits and observation significances with OpTHyLiC involves many calculations of different types: generation of random numbers, calculation of p-values (CL s+b and CL b ), scanning over \u00b5 values to solve Eq. ",
            "section": "Software validation",
            "paragraph_rank": 156,
            "section_rank": 33
        },
        {
            "text": "1, combination of channels, interpolation and extrapolation of systematic uncertainties, marginalization of statistical and systematic uncertainties, calculation of quantiles for expected limits, etc. ",
            "section": "Software validation",
            "paragraph_rank": 156,
            "section_rank": 33
        },
        {
            "text": "Several studies have been performed in order to validate these calculations. ",
            "section": "Software validation",
            "paragraph_rank": 156,
            "section_rank": 33
        },
        {
            "text": "OpTHyLiC is compared either to a theoretical solution in situations where such a solution exists, to Bayesian calculations in situations where they are equivalent to the hybrid CL s under interest or to results obtained with the McLimit software which is equivalent to OpTHyLiC when specific choices for the interpolation/extrapolation of systematics and constraints for statistical uncertainties are made. ",
            "section": "Software validation",
            "paragraph_rank": 156,
            "section_rank": 33,
            "entity_spans": [
                {
                    "start": 229,
                    "end": 237,
                    "type": "software",
                    "rawForm": "McLimit",
                    "resp": "service",
                    "id": "software-simple-s32"
                }
            ]
        },
        {
            "text": "These studies are summarized in the following sections.",
            "section": "Software validation",
            "paragraph_rank": 156,
            "section_rank": 33
        },
        {
            "text": "Validation of calculations without uncertainties",
            "section_rank": 34
        },
        {
            "text": "OpTHyLiC has first been validated in the simplest situation where signal and background yields have no uncertainties (neither systematic nor statistical), both in the single and multiple channels cases.",
            "section": "Validation of calculations without uncertainties",
            "paragraph_rank": 157,
            "section_rank": 34
        },
        {
            "text": "In the single channel case, an analytical solution for \u00b5 up exists. ",
            "section": "Validation of calculations without uncertainties",
            "paragraph_rank": 158,
            "section_rank": 34
        },
        {
            "text": "Indeed, CL s+b and CL b are given by:",
            "section": "Validation of calculations without uncertainties",
            "paragraph_rank": 158,
            "section_rank": 34
        },
        {
            "text": "e \u2212(\u00b5s nom +b nom ) = 1 \u2212 F \u03c7 2 2 (\u00b5s nom + b nom ) ; 2 N obs + 1",
            "section": "Validation of calculations without uncertainties",
            "paragraph_rank": 159,
            "section_rank": 34
        },
        {
            "text": "and:",
            "section": "Validation of calculations without uncertainties",
            "paragraph_rank": 160,
            "section_rank": 34
        },
        {
            "text": "where F \u03c7 2 (x; d) is the cumulative distribution function of the chi-squared distribution with d degrees of freedom at x. ",
            "section": "Validation of calculations without uncertainties",
            "paragraph_rank": 161,
            "section_rank": 34
        },
        {
            "text": "Eq. ",
            "section": "Validation of calculations without uncertainties",
            "paragraph_rank": 161,
            "section_rank": 34
        },
        {
            "text": "1 then yields:  In the multiple channels case, two validations were made. ",
            "section": "Validation of calculations without uncertainties",
            "paragraph_rank": 161,
            "section_rank": 34
        },
        {
            "text": "In the first one, upper limits calculated with several channels were compared to upper limits calculated with a single channel in situations where the two are expected to give identical results. ",
            "section": "Validation of calculations without uncertainties",
            "paragraph_rank": 161,
            "section_rank": 34
        },
        {
            "text": "Such situations occur when yields in the various channels are related to each other by a simple multiplicative factor. ",
            "section": "Validation of calculations without uncertainties",
            "paragraph_rank": 161,
            "section_rank": 34
        },
        {
            "text": "For example, the same limits should be obtained in these two cases:",
            "section": "Validation of calculations without uncertainties",
            "paragraph_rank": 161,
            "section_rank": 34
        },
        {
            "text": "\u2022 n channels each with:",
            "section": "Validation of calculations without uncertainties",
            "paragraph_rank": 162,
            "section_rank": 34
        },
        {
            "text": "background yield=b nom /n signal yield=s nom /n observed yield=N obs /n",
            "section": "Validation of calculations without uncertainties",
            "paragraph_rank": 163,
            "section_rank": 34
        },
        {
            "text": "\u2022 a single channel with:",
            "section": "Validation of calculations without uncertainties",
            "paragraph_rank": 164,
            "section_rank": 34
        },
        {
            "text": "It has been checked for several values of s nom , b nom , N obs and n that OpTHyLiC indeed finds the same limits in both cases. ",
            "section": "Validation of calculations without uncertainties",
            "paragraph_rank": 165,
            "section_rank": 34
        },
        {
            "text": "In the second one, the general case where yields in the various channels can't be related to each other by a simple multiplicative factor has been considered. ",
            "section": "Validation of calculations without uncertainties",
            "paragraph_rank": 165,
            "section_rank": 34
        },
        {
            "text": "It can be seen from Eq. ",
            "section": "Validation of calculations without uncertainties",
            "paragraph_rank": 165,
            "section_rank": 34
        },
        {
            "text": "30 and Eq. ",
            "section": "Validation of calculations without uncertainties",
            "paragraph_rank": 165,
            "section_rank": 34
        },
        {
            "text": "31 that the upper limit can be computed using the following test:",
            "section": "Validation of calculations without uncertainties",
            "paragraph_rank": 165,
            "section_rank": 34
        },
        {
            "text": "In the asymptotic limit, N c is normally distributed. ",
            "section": "Validation of calculations without uncertainties",
            "paragraph_rank": 166,
            "section_rank": 34
        },
        {
            "text": "Thus:",
            "section": "Validation of calculations without uncertainties",
            "paragraph_rank": 166,
            "section_rank": 34
        },
        {
            "text": "under the signal plus background hypothesis and:",
            "section": "Validation of calculations without uncertainties",
            "paragraph_rank": 167,
            "section_rank": 34
        },
        {
            "text": "under the background only hypothesis (N (a, b) is the normal distribution with mean a and variance b). ",
            "section": "Validation of calculations without uncertainties",
            "paragraph_rank": 168,
            "section_rank": 34,
            "ref_spans": [
                {
                    "start": 37,
                    "end": 46,
                    "type": "figure",
                    "text": "(N (a, b)"
                }
            ]
        },
        {
            "text": "CL s is therefore given by:",
            "section": "Validation of calculations without uncertainties",
            "paragraph_rank": 168,
            "section_rank": 34
        },
        {
            "text": "where \u03a6 is the cumulative distribution function of the standard normal distribution. ",
            "section": "Validation of calculations without uncertainties",
            "paragraph_rank": 169,
            "section_rank": 34
        },
        {
            "text": "Eq. ",
            "section": "Validation of calculations without uncertainties",
            "paragraph_rank": 169,
            "section_rank": 34
        },
        {
            "text": "1 with Eq. ",
            "section": "Validation of calculations without uncertainties",
            "paragraph_rank": 169,
            "section_rank": 34
        },
        {
            "text": "43 can easily be solved by dichotomy. ",
            "section": "Validation of calculations without uncertainties",
            "paragraph_rank": 169,
            "section_rank": 34
        },
        {
            "text": "This result has been used to validate the channel combination procedure implemented in OpTHyLiC against the asymptotic limit.  ",
            "section": "Validation of calculations without uncertainties",
            "paragraph_rank": 169,
            "section_rank": 34
        },
        {
            "text": "As can be seen from Fig. 10, OpTHyLiC converges, as expected, to the asymptotic result as the number of events increases.",
            "section": "Validation of calculations without uncertainties",
            "paragraph_rank": 169,
            "section_rank": 34,
            "ref_spans": [
                {
                    "start": 20,
                    "end": 27,
                    "type": "figure",
                    "ref_id": "fig_2",
                    "text": "Fig. 10"
                }
            ]
        },
        {
            "text": "Validation of calculations with statistical and systematic uncertainties",
            "section_rank": 35
        },
        {
            "text": "Several other studies have been performed in order to validate the treatment of statistical and systematic uncertainties in OpTHyLiC. ",
            "section": "Validation of calculations with statistical and systematic uncertainties",
            "paragraph_rank": 170,
            "section_rank": 35
        },
        {
            "text": "As already explained, OpTHyLiC treats uncertainties in a Bayesian way by marginalizing the likelihood. ",
            "section": "Validation of calculations with statistical and systematic uncertainties",
            "paragraph_rank": 170,
            "section_rank": 35
        },
        {
            "text": "A simple check of the marginalization procedure has been performed in the single channel case by comparing marginal distributions of the yield as computed by OpTHyLiC to analytical distributions in the case where a single background affected by a statistical uncertainty constrained with a gamma p. ",
            "section": "Validation of calculations with statistical and systematic uncertainties",
            "paragraph_rank": 170,
            "section_rank": 35
        },
        {
            "text": "d. ",
            "section": "Validation of calculations with statistical and systematic uncertainties",
            "paragraph_rank": 170,
            "section_rank": 35
        },
        {
            "text": "f. ",
            "section": "Validation of calculations with statistical and systematic uncertainties",
            "paragraph_rank": 170,
            "section_rank": 35
        },
        {
            "text": "contributes to the expected yield. ",
            "section": "Validation of calculations with statistical and systematic uncertainties",
            "paragraph_rank": 170,
            "section_rank": 35
        },
        {
            "text": "Indeed, it is known that, in this case, the marginal distribution of the yield, given by the compound of a Poisson and a gamma distribution, is negative binomial:",
            "section": "Validation of calculations with statistical and systematic uncertainties",
            "paragraph_rank": 170,
            "section_rank": 35
        },
        {
            "text": "where N is the observed yield, b is the background yield, b nom its nominal value, \u03c3 its statistical uncertainty, P (N = n|b) the Poisson distribution with parameter b, f (b; b nom , \u03c3) the gamma distribution for b with mean b nom and standard deviation \u03c3 (given by Eq. 16c) and P (N = n|b nom , \u03c3) the marginal (negative binomial) distribution of the yield N . ",
            "section": "Validation of calculations with statistical and systematic uncertainties",
            "paragraph_rank": 171,
            "section_rank": 35
        },
        {
            "text": "Fig. 11 shows that the agreement between Eq. ",
            "section": "Validation of calculations with statistical and systematic uncertainties",
            "paragraph_rank": 171,
            "section_rank": 35,
            "ref_spans": [
                {
                    "start": 0,
                    "end": 7,
                    "type": "figure",
                    "ref_id": "fig_2",
                    "text": "Fig. 11"
                }
            ]
        },
        {
            "text": "44 and marginal distributions calculated by OpTHyLiC is very good. ",
            "section": "Validation of calculations with statistical and systematic uncertainties",
            "paragraph_rank": 171,
            "section_rank": 35
        },
        {
            "text": "Excellent agreement has also been observed for the two other gamma definitions available in OpTHyLiC (Eq. 16a and 16b).",
            "section": "Validation of calculations with statistical and systematic uncertainties",
            "paragraph_rank": 171,
            "section_rank": 35
        },
        {
            "text": "In order to validate not only the treatment of statistical uncertainties but also that of systematic uncertainties, upper limits calculated with OpTHyLiC have been compared to upper limits calculated using a Bayesian method. ",
            "section": "Validation of calculations with statistical and systematic uncertainties",
            "paragraph_rank": 172,
            "section_rank": 35
        },
        {
            "text": "It can indeed be shown that, in the single channel case, the hybrid CL s method implemented in OpTHyLiC is equivalent to the Bayesian method when a uniform prior on the signal strength \u00b5 is used and when the signal has no uncertainties (neither statistical nor systematic) associated to it [9]. ",
            "section": "Validation of calculations with statistical and systematic uncertainties",
            "paragraph_rank": 172,
            "section_rank": 35,
            "ref_spans": [
                {
                    "start": 290,
                    "end": 293,
                    "type": "bibr",
                    "ref_id": "b6",
                    "text": "[9]"
                }
            ]
        },
        {
            "text": "This equivalence holds for any number of background sources, any number of statistical and systematic uncertainties associated to them and any type of correlation between systematic uncertainties across background sources. ",
            "section": "Validation of calculations with statistical and systematic uncertainties",
            "paragraph_rank": 172,
            "section_rank": 35
        },
        {
            "text": "This result is used to complete the validation of the treatment of statistical uncertainties and to validate the treatment of systematic uncertainties. ",
            "section": "Validation of calculations with statistical and systematic uncertainties",
            "paragraph_rank": 172,
            "section_rank": 35
        },
        {
            "text": "In order to perform this validation, an independent Bayesian software, based on RooStats, has been developed. ",
            "section": "Validation of calculations with statistical and systematic uncertainties",
            "paragraph_rank": 172,
            "section_rank": 35
        },
        {
            "text": "This software implements exactly the same likelihood as OpTHyLiC and takes as input the same files, hence allowing direct comparison to OpTHyLiC. ",
            "section": "Validation of calculations with statistical and systematic uncertainties",
            "paragraph_rank": 172,
            "section_rank": 35
        },
        {
            "text": "Several comparisons between OpTHyLiC and Bayesian results have been performed by changing the number of background sources and the number of systematic and statistical uncertainties. ",
            "section": "Validation of calculations with statistical and systematic uncertainties",
            "paragraph_rank": 172,
            "section_rank": 35
        },
        {
            "text": "One such comparison has been performed using the configuration given in Fig. 12, with L = 1, . . . , 7. ",
            "section": "Validation of calculations with statistical and systematic uncertainties",
            "paragraph_rank": 172,
            "section_rank": 35,
            "ref_spans": [
                {
                    "start": 72,
                    "end": 79,
                    "type": "figure",
                    "ref_id": "fig_2",
                    "text": "Fig. 12"
                }
            ]
        },
        {
            "text": "The result is shown in Fig. 13. ",
            "section": "Validation of calculations with statistical and systematic uncertainties",
            "paragraph_rank": 172,
            "section_rank": 35,
            "ref_spans": [
                {
                    "start": 23,
                    "end": 30,
                    "type": "figure",
                    "ref_id": "fig_2",
                    "text": "Fig. 13"
                }
            ]
        },
        {
            "text": "This example has been chosen because uncertainties are large and their effect on upper limits is very pronounced (as can be seen by comparing plots on the left and right of Fig. 13). ",
            "section": "Validation of calculations with statistical and systematic uncertainties",
            "paragraph_rank": 172,
            "section_rank": 35,
            "ref_spans": [
                {
                    "start": 173,
                    "end": 180,
                    "type": "figure",
                    "ref_id": "fig_2",
                    "text": "Fig. 13"
                }
            ]
        },
        {
            "text": "Thus, any mis-treatment of uncertainties in OpTHyLiC should be visible. ",
            "section": "Validation of calculations with statistical and systematic uncertainties",
            "paragraph_rank": 172,
            "section_rank": 35
        },
        {
            "text": "Very good agreement between OpTHyLiC and the Bayesian calculation with uniform prior is found for this example. ",
            "section": "Validation of calculations with statistical and systematic uncertainties",
            "paragraph_rank": 172,
            "section_rank": 35
        },
        {
            "text": "Similar agreements are found in other cases. ",
            "section": "Validation of calculations with statistical and systematic uncertainties",
            "paragraph_rank": 172,
            "section_rank": 35
        },
        {
            "text": "Rigorously, these comparisons validate only the treatment of statistical and systematic uncertaintes for backgrounds. ",
            "section": "Validation of calculations with statistical and systematic uncertainties",
            "paragraph_rank": 172,
            "section_rank": 35
        },
        {
            "text": "However, signal uncertainties are treated by the same code as background uncertainties. ",
            "section": "Validation of calculations with statistical and systematic uncertainties",
            "paragraph_rank": 172,
            "section_rank": 35
        },
        {
            "text": "Signal uncertainties are therefore expected to be treated properly. ",
            "section": "Validation of calculations with statistical and systematic uncertainties",
            "paragraph_rank": 172,
            "section_rank": 35
        },
        {
            "text": "As will be seen below, the comparison between McLimit and OpTHyLiC gives confidence that signal uncertainties are indeed treated properly.  ",
            "section": "Validation of calculations with statistical and systematic uncertainties",
            "paragraph_rank": 172,
            "section_rank": 35
        },
        {
            "text": "The last validation compares observed and expected (-2\u03c3, -1\u03c3, median, +1\u03c3 and +2\u03c3) upper limits calculated with OpTHyLiC to upper limits calculated with McLimit. ",
            "section": "Validation of calculations with statistical and systematic uncertainties",
            "paragraph_rank": 172,
            "section_rank": 35
        },
        {
            "text": "McLimit, as OpTHyLiC, is a hybrid frequentist-Bayesian tool, using the interpolation/extrapolation described in Sec. 4.3.4 and normal constraints for statistical uncertainties. ",
            "section": "Validation of calculations with statistical and systematic uncertainties",
            "paragraph_rank": 172,
            "section_rank": 35
        },
        {
            "text": "When configured appropriately, OpTHyLiC is therefore expected to give the same upper limits as McLimit 3 . ",
            "section": "Validation of calculations with statistical and systematic uncertainties",
            "paragraph_rank": 172,
            "section_rank": 35
        },
        {
            "text": "For this comparison, typical inputs from high energy physics analysis have been used. ",
            "section": "Validation of calculations with statistical and systematic uncertainties",
            "paragraph_rank": 172,
            "section_rank": 35
        },
        {
            "text": "Fig. 14   function of the mass of a hypothetical new particle obtained by combining three channels. ",
            "section": "Validation of calculations with statistical and systematic uncertainties",
            "paragraph_rank": 172,
            "section_rank": 35,
            "ref_spans": [
                {
                    "start": 0,
                    "end": 7,
                    "type": "figure",
                    "ref_id": "fig_2",
                    "text": "Fig. 14"
                }
            ]
        },
        {
            "text": "Six mass points have been considered and seven background processes contribute to the yield in each channel. ",
            "section": "Validation of calculations with statistical and systematic uncertainties",
            "paragraph_rank": 172,
            "section_rank": 35
        },
        {
            "text": "Signal and background processes are all affected by statistical and systematic uncertainties. ",
            "section": "Validation of calculations with statistical and systematic uncertainties",
            "paragraph_rank": 172,
            "section_rank": 35
        },
        {
            "text": "For each mass, the total number of nuisance parameters is 51 (27 are associated to systematic uncertainties and 24 to statistical uncertainties). ",
            "section": "Validation of calculations with statistical and systematic uncertainties",
            "paragraph_rank": 172,
            "section_rank": 35
        },
        {
            "text": "In both cases, 50 000 pseudo-experiments are used. ",
            "section": "Validation of calculations with statistical and systematic uncertainties",
            "paragraph_rank": 172,
            "section_rank": 35
        },
        {
            "text": "Limits found with OpTHyLiC are in good agreement with those found with McLimit. ",
            "section": "Validation of calculations with statistical and systematic uncertainties",
            "paragraph_rank": 172,
            "section_rank": 35
        },
        {
            "text": "The main difference between the two programs is the computing time. ",
            "section": "Validation of calculations with statistical and systematic uncertainties",
            "paragraph_rank": 172,
            "section_rank": 35
        },
        {
            "text": "For example, on the same computer, it took 25 minutes (8 seconds) to calculate the observed limit for the 1 TeV point with McLimit (OpTHyLiC). ",
            "section": "Validation of calculations with statistical and systematic uncertainties",
            "paragraph_rank": 172,
            "section_rank": 35
        },
        {
            "text": "The full plot is produced in less than 6 minutes with OpTHyLiC while it takes several hours with McLimit.",
            "section": "Validation of calculations with statistical and systematic uncertainties",
            "paragraph_rank": 172,
            "section_rank": 35
        },
        {
            "text": "Conclusion",
            "section_rank": 36
        },
        {
            "text": "A tool computing observed and expected limits has been presented. ",
            "section": "Conclusion",
            "paragraph_rank": 173,
            "section_rank": 36
        },
        {
            "text": "This tool, named OpTHyLiC, is written in C++ and uses the ROOT library. ",
            "section": "Conclusion",
            "paragraph_rank": 173,
            "section_rank": 36,
            "entity_spans": [
                {
                    "start": 58,
                    "end": 63,
                    "type": "software",
                    "rawForm": "ROOT",
                    "resp": "service",
                    "id": "software-simple-s33"
                }
            ]
        },
        {
            "text": "It implements the hybrid frequentist-Bayesian CL s method for hypothesis testing. ",
            "section": "Conclusion",
            "paragraph_rank": 173,
            "section_rank": 36
        },
        {
            "text": "It can be used with an arbitrary number of channels and both for counting and multi-bin experiments. ",
            "section": "Conclusion",
            "paragraph_rank": 173,
            "section_rank": 36
        },
        {
            "text": "Statistical and systematic uncertainties are accounted for as well as correlations between systematic uncertainties. ",
            "section": "Conclusion",
            "paragraph_rank": 173,
            "section_rank": 36
        },
        {
            "text": "Several types of interpolation/extrapolation for systematic uncertainties and constraint terms for statistical uncertainties are provided. ",
            "section": "Conclusion",
            "paragraph_rank": 173,
            "section_rank": 36
        },
        {
            "text": "OpTHyLiC has been validated by comparing it to known analytical and Bayesian results and to McLimit in situations where they are expected to give identical limits. ",
            "section": "Conclusion",
            "paragraph_rank": 173,
            "section_rank": 36
        },
        {
            "text": "Very good agreement has been found in all cases, hence validating the software.",
            "section": "Conclusion",
            "paragraph_rank": 173,
            "section_rank": 36
        },
        {
            "text": "One of the main advantages of OpTHyLiC is its speed. ",
            "section": "Conclusion",
            "paragraph_rank": 174,
            "section_rank": 36
        },
        {
            "text": "Even in realistic cases with dozens of nuisance parameters and several channels and bins, the duration of limits computation remains of the order a few minutes or less.",
            "section": "Conclusion",
            "paragraph_rank": 174,
            "section_rank": 36
        },
        {
            "text": "a+ b 2 2 and e a+ b 2 2 e b 2",
            "section_rank": 37
        },
        {
            "text": "\u2212 1 ,",
            "section": "a+ b 2 2 and e a+ b 2 2 e b 2",
            "paragraph_rank": 175,
            "section_rank": 37
        },
        {
            "text": "Figure 1 :",
            "section_rank": 38
        },
        {
            "text": "Figure 1: Comparison of normal, log-normal and gamma probability density functions used for statistical uncertainties for three values of y nom and \u03c3.",
            "section": "Figure 1 :",
            "paragraph_rank": 176,
            "section_rank": 38
        },
        {
            "text": "Figure 2 :",
            "section_rank": 39
        },
        {
            "text": "Figure 2: Illustration of interpolation and extrapolation functions implemented in OpTHyLiC for h \u2193 j = \u22120.03 and h \u2191 j = 0.5 (top left), h \u2193 j = \u22120.5 and h \u2191 j = 0.5 (top right), h \u2193 j = 0.2 and h \u2191 j = \u22120.5 (bottom left) and h \u2193 j = \u22120.5 and h \u2191 j = \u22120.5 (bottom right).",
            "section": "Figure 2 :",
            "paragraph_rank": 177,
            "section_rank": 39
        },
        {
            "text": "Figure 3 :",
            "section_rank": 40
        },
        {
            "text": "Figure 3: Example of distributions of q \u00b5 under signal+background (\u00b5 = \u00b5) and background only hypotheses (\u00b5 = 0).",
            "section": "Figure 3 :",
            "paragraph_rank": 178,
            "section_rank": 40
        },
        {
            "text": "Figure 4 :",
            "section_rank": 41
        },
        {
            "text": "Figure 4: General structure of OpTHyLiC's input files for counting experiments.",
            "section": "Figure 4 :",
            "paragraph_rank": 179,
            "section_rank": 41
        },
        {
            "text": "Fig. 5",
            "section_rank": 42
        },
        {
            "text": "and 6 show an example of what could be the two files in an analysis combining two channels and the dictionnary file defining systematic names for LaTeX tables. ",
            "section": "Fig. 5",
            "paragraph_rank": 180,
            "section_rank": 42,
            "entity_spans": [
                {
                    "start": 146,
                    "end": 152,
                    "type": "software",
                    "rawForm": "LaTeX",
                    "resp": "service",
                    "id": "software-simple-s34"
                }
            ]
        },
        {
            "text": "+nameLaTeX $e\\mu$ +bg Bkg1 0.8 0.1 .",
            "section": "Fig. 5",
            "paragraph_rank": 180,
            "section_rank": 42
        },
        {
            "text": "nameLaTeX $t\\bar{t}$ .",
            "section": "Fig. 5",
            "paragraph_rank": 180,
            "section_rank": 42
        },
        {
            "text": "syst Syst1 -0.05 0.12 .",
            "section": "Fig. 5",
            "paragraph_rank": 180,
            "section_rank": 42
        },
        {
            "text": "syst Syst2 0.04 -0",
            "section": "Fig. 5",
            "paragraph_rank": 180,
            "section_rank": 42
        },
        {
            "text": "Figure 5 :Figure 6 :",
            "section_rank": 43
        },
        {
            "text": "Figure 5: Example of input text files for a two channels combination.",
            "section": "Figure 5 :Figure 6 :",
            "paragraph_rank": 181,
            "section_rank": 43
        },
        {
            "text": "Figure 7 :",
            "section_rank": 44
        },
        {
            "text": "Figure 7: General structure of OpTHyLiC's input files for multi-bin experiments using syntax 1.",
            "section": "Figure 7 :",
            "paragraph_rank": 182,
            "section_rank": 44
        },
        {
            "text": "Figure 8 :",
            "section_rank": 45
        },
        {
            "text": "Figure 8: General structure of OpTHyLiC's input files for multi-bin experiments using syntax 2.",
            "section": "Figure 8 :",
            "paragraph_rank": 183,
            "section_rank": 45
        },
        {
            "text": "The constructor requires at least two parameters. ",
            "paragraph_rank": 184,
            "section_rank": 46
        },
        {
            "text": "The first one is the interpolation/extrapolation method: the possible values are OTH::SystLinear, OTH::SystExpo, OTH::SystPolyexpo, and OTH::SystMclimit, corresponding to the four possibilities described in Sec. 4.3. ",
            "paragraph_rank": 184,
            "section_rank": 46
        },
        {
            "text": "The second one is the type of constraint for statistical uncertainties: the possible values are OTH::StatNormal, OTH::StatLogN, OTH::StatGammaHyper, OTH::StatGammaUni, and OTH::StatGammaJeffreys, corresponding to the five possibilities described in Sec. 4.2.",
            "paragraph_rank": 184,
            "section_rank": 46,
            "entity_spans": [
                {
                    "start": 101,
                    "end": 111,
                    "type": "software",
                    "rawForm": "StatNormal",
                    "resp": "service",
                    "id": "software-simple-s35"
                }
            ]
        },
        {
            "text": "double limit=oth.getChannel(index) ->sigStrengthExclusion(OTH::LimObserved, nbExp,cls); After this call, channel dependent histograms (as described in the previous section) are available. ",
            "paragraph_rank": 185,
            "section_rank": 47
        },
        {
            "text": "For the alternative expected limit computation, the following function may be invoked: double limit=oth.getChannel(index) ->expectedSigStrengthExclusion(nbMu,nbExp); In this case, all previous histograms are available as well as a few more: oth.getChannel(index) ->getDistrExpMu()->Draw(); oth.getChannel(index) ->getExpMuVsObs()->Draw(\"alp\"); oth.getChannel(index) ->getDistrCLs()->Draw();",
            "paragraph_rank": 185,
            "section_rank": 47
        },
        {
            "text": "oth.getChannel(index)->generateDistrYield(nbExp);then, the generated distributions are available:oth.getChannel(index) ->getSigYieldDistr() ->Draw(); oth.getChannel(index) ->getBkgYieldDistr(\"Bkg\") ->Draw(); oth.getChannel(index) ->getHisto(OTH::Channel::hYieldBg) ->Draw();",
            "paragraph_rank": 186,
            "section_rank": 48
        },
        {
            "text": "double pvalue=oth.pValueData(); double cls=oth.computeCLsData(); The p-value under the background hypothesis and the CL s for a single channel can be computed using: double pvalue=oth.getChannel(index) ->pValue(nObs); double cls=oth.getChannel(index) ->computeCLs(nObs);",
            "paragraph_rank": 187,
            "section_rank": 49
        },
        {
            "text": "Fig. 9",
            "section_rank": 50
        },
        {
            "text": "shows a comparison between this analytical result and OpTHyLiC for b nom = 0.82 \u00d7 L, s nom = 2.49 \u00d7 L and N obs = 1 \u00d7 L, with L = 1, . . . , 7. ",
            "section": "Fig. 9",
            "paragraph_rank": 188,
            "section_rank": 50
        },
        {
            "text": "Excellent agreement is found. ",
            "section": "Fig. 9",
            "paragraph_rank": 188,
            "section_rank": 50
        },
        {
            "text": "Other tests have been performed with other values of b nom , s nom and N obs , always leading to the same conclusion.",
            "section": "Fig. 9",
            "paragraph_rank": 188,
            "section_rank": 50
        },
        {
            "text": "Figure 9 :",
            "section_rank": 51
        },
        {
            "text": "Figure 9: Upper limit \u00b5 up as a function of L computed with OpTHyLiC and from the analytical result (Eq. 39) for b nom = 0.82 \u00d7 L, s nom = 2.49 \u00d7 L and N obs = 1 \u00d7 L.",
            "section": "Figure 9 :",
            "paragraph_rank": 189,
            "section_rank": 51
        },
        {
            "text": "Fig. 10 shows a comparison of this asymptotic result with OpTHyLiC in the three channels example defined by \u2022 channel 1: s nom = 5.18 \u00d7 L, b nom = 2.22 \u00d7 L and N obs = 3 \u00d7 L \u2022 channel 2: s nom = 3.05 \u00d7 L, b nom = 1.61 \u00d7 L and N obs = 4 \u00d7 L \u2022 channel 3: s nom = 4.45 \u00d7 L, b nom = 2.95 \u00d7 L and N obs = 2 \u00d7 L",
            "paragraph_rank": 190,
            "section_rank": 52
        },
        {
            "text": "Figure 10 :",
            "section_rank": 53
        },
        {
            "text": "Figure 10: Upper limit \u00b5 up as a function of L computed with OpTHyLiC and from the asymptotic result (Eq. 43) for the three channels example defined in the text.",
            "section": "Figure 10 :",
            "paragraph_rank": 191,
            "section_rank": 53
        },
        {
            "text": "Figure 11 :",
            "section_rank": 54
        },
        {
            "text": "Figure 11: Marginal distribution of the yield under the background only hypothesis in the case where the background has a statistical uncertainty constrained by a gamma p. ",
            "section": "Figure 11 :",
            "paragraph_rank": 192,
            "section_rank": 54
        },
        {
            "text": "d. ",
            "section": "Figure 11 :",
            "paragraph_rank": 192,
            "section_rank": 54
        },
        {
            "text": "f. ",
            "section": "Figure 11 :",
            "paragraph_rank": 192,
            "section_rank": 54
        },
        {
            "text": "with mean b nom = 15 and three different values of standard deviation: \u03c3 = 2, 7 and 14.",
            "section": "Figure 11 :",
            "paragraph_rank": 192,
            "section_rank": 54
        },
        {
            "text": "+bgFigure 12 :",
            "section_rank": 55
        },
        {
            "text": "Figure 12: One of the examples used to validate the treatment of uncertainties in OpTHyLiC.",
            "section": "+bgFigure 12 :",
            "paragraph_rank": 193,
            "section_rank": 55
        },
        {
            "text": "Figure 13 :",
            "section_rank": 56
        },
        {
            "text": "Figure 13: Upper limit \u00b5 up as a function of L without (left) and with (right) statistical and systematic uncertainties. ",
            "section": "Figure 13 :",
            "paragraph_rank": 194,
            "section_rank": 56
        },
        {
            "text": "It has been computed using exponential interpolation and extrapolation for systematic uncertainties and normal constraint terms for statistical uncertainty.",
            "section": "Figure 13 :",
            "paragraph_rank": 194,
            "section_rank": 56
        },
        {
            "text": "Figure 14 :",
            "section_rank": 57
        },
        {
            "text": "Figure 14: Comparison of observed and expected upper limits calculated with McLimit and OpTHyLiC in a realistic case (see text).",
            "section": "Figure 14 :",
            "paragraph_rank": 195,
            "section_rank": 57
        },
        {
            "text": "Table 1 :",
            "section_rank": 58
        },
        {
            "text": "Summary of the three gamma constraints available in OpTHyLiC. ",
            "section": "Table 1 :",
            "paragraph_rank": 196,
            "section_rank": 58
        },
        {
            "text": "The constants a and b are parameters of the posterior distribution whose general form is given in Eq. ",
            "section": "Table 1 :",
            "paragraph_rank": 196,
            "section_rank": 58
        },
        {
            "text": "10.",
            "section": "Table 1 :",
            "paragraph_rank": 196,
            "section_rank": 58
        },
        {
            "text": "Table 2 compares",
            "section_rank": 59
        },
        {
            "text": "the mode, the expectation and standard deviation for the five available constraint functions. ",
            "section": "Table 2 compares",
            "paragraph_rank": 197,
            "section_rank": 59
        },
        {
            "text": "For the normal and log-normal distribution, the expectation and standard deviation are equal to the nominal yield and statistical uncertainty (see Sec. 4.2.1). ",
            "section": "Table 2 compares",
            "paragraph_rank": 197,
            "section_rank": 59
        },
        {
            "text": "For the gamma distributions the expectation and standard deviation are equal to the nominal yield and statistical uncertainty only for the hyperbolic prior \u03c0 (\u03b3) \u221d 1/\u03b3. ",
            "section": "Table 2 compares",
            "paragraph_rank": 197,
            "section_rank": 59
        },
        {
            "text": "For the gamma constraints with the uniform and Jeffreys priors, it is not the case, but the difference vanishes in the asymptotic limit.",
            "section": "Table 2 compares",
            "paragraph_rank": 197,
            "section_rank": 59
        },
        {
            "text": "Table 2 :",
            "section_rank": 60
        },
        {
            "text": "Comparison of the mode, expectation, and standard deviation for the five constraints available in OpTHyLiC.",
            "section": "Table 2 :",
            "paragraph_rank": 198,
            "section_rank": 60
        },
        {
            "text": "Table 3 :",
            "section_rank": 61
        },
        {
            "text": "Values of probabilities associated to the quantiles available in OpTHyLiC for the calculation of expected limits. ",
            "section": "Table 3 :",
            "paragraph_rank": 199,
            "section_rank": 61
        },
        {
            "text": "limits are calculated in the same way as observed ones (see Sec. 4.4) replacing the observed CL s by median, \u22122\u03c3, \u22121\u03c3, +1\u03c3 and +2\u03c3 quantiles of the CL s distribution under background only hypothesis.",
            "section": "Table 3 :",
            "paragraph_rank": 199,
            "section_rank": 61
        },
        {
            "text": "Table 4 :",
            "section_rank": 62
        },
        {
            "text": "Observed yields and nominal expected yields. ",
            "section": "Table 4 :",
            "paragraph_rank": 200,
            "section_rank": 62
        },
        {
            "text": "For each nominal expected yield, the first quoted uncertainty represent the statistical uncertainty, while the second is an approximation of the total systematic uncertainty, without taking into account the correlations between them.",
            "section": "Table 4 :",
            "paragraph_rank": 200,
            "section_rank": 62
        },
        {
            "text": "Table 5 :",
            "section_rank": 63
        },
        {
            "text": "Observed yields and median expected yields. ",
            "section": "Table 5 :",
            "paragraph_rank": 201,
            "section_rank": 63
        },
        {
            "text": "For each median expected yield, derived with pseudo-experiments, the quoted uncertainty is a combination of the statistical and systematic uncertainties, taking into account the correlations between systematics.",
            "section": "Table 5 :",
            "paragraph_rank": 201,
            "section_rank": 63
        },
        {
            "text": "Table 6 :",
            "section_rank": 64
        },
        {
            "text": "List of relative systematic uncertainties (in %) for channel e\u00b5.",
            "section": "Table 6 :",
            "paragraph_rank": 202,
            "section_rank": 64
        },
        {
            "text": "shows a comparison of upper limits as a",
            "paragraph_rank": 203,
            "section_rank": 65
        },
        {
            "text": "Profiling of uncertainties has been turned off in McLimit so as to allow direct comparison to OpTHyLiC.",
            "paragraph_rank": 204,
            "section_rank": 65
        },
        {
            "text": "Acknowledgements",
            "section_rank": 67
        },
        {
            "text": "The authors would like to thank R. Madar and L. Val\u00e9ry for the fruitful discussions that helped improve the quality of this document. ",
            "section": "Acknowledgements",
            "paragraph_rank": 205,
            "section_rank": 67
        },
        {
            "text": "They also would like to thank J. Linnemann for drawing their attention to the possibility of changing parameters of the log-normal distribution, extending the variety of priors that can be considered for statistical uncertainties. ",
            "section": "Acknowledgements",
            "paragraph_rank": 205,
            "section_rank": 67
        },
        {
            "text": "Part of this work was supported by the regional council of Auvergne through the \"nouveau chercheur\" research funding program, and by the french \"Agence Nationale de la Recherche\".",
            "section": "Acknowledgements",
            "paragraph_rank": 205,
            "section_rank": 67
        },
        {
            "text": "Like in Sec. 5.4.3, it is possible to provide a hint of the expected limit and to use the extrapolation method when speed is preferred to accuracy.",
            "paragraph_rank": 206,
            "section_rank": 69
        },
        {
            "text": "With the alternative method, all expected (median, \u22122\u03c3, \u22121\u03c3, +1\u03c3 and +2\u03c3) limits are computed at the same time using:",
            "paragraph_rank": 207,
            "section_rank": 69
        },
        {
            "text": "oth.expectedSigStrengthExclusion(nbMu,nbExp);",
            "paragraph_rank": 208,
            "section_rank": 69
        },
        {
            "text": "where nbMu and nbExp are the number of entries in the \u00b5 up distribution (see Sec. 4.5) and the number of pseudo-experiments, respectively.",
            "paragraph_rank": 209,
            "section_rank": 69
        },
        {
            "text": "Scan of CL s as a function of the signal strength",
            "section_rank": 70
        },
        {
            "text": "It is possible to perform a scan of the CL s value for several values of the signal strength, using:",
            "section": "Scan of CL s as a function of the signal strength",
            "paragraph_rank": 210,
            "section_rank": 70
        },
        {
            "text": "oth.scanCLsVsMu(min,max,steps,nbExp, OTH::LimExpectedMed); oth.getCLsVsMu()->Draw(\"alp\");",
            "section": "Scan of CL s as a function of the signal strength",
            "paragraph_rank": 211,
            "section_rank": 70
        },
        {
            "text": "The first three parameters define the signal strength range to be scanned, steps being the number of values to be scanned. ",
            "section": "Scan of CL s as a function of the signal strength",
            "paragraph_rank": 212,
            "section_rank": 70
        },
        {
            "text": "The parameter nbExp is the number of pseudo-experiments to compute each CL s .",
            "section": "Scan of CL s as a function of the signal strength",
            "paragraph_rank": 212,
            "section_rank": 70
        },
        {
            "text": "The last parameter defines the type of observed value to be used, within the list OTH::LimExpectedM2sig, OTH::LimExpectedM1sig, OTH::LimExpectedMed, OTH::LimExpectedP1sig or OTH::LimExpectedP2sig and OTH::LimObserved.",
            "section": "Scan of CL s as a function of the signal strength",
            "paragraph_rank": 213,
            "section_rank": 70
        },
        {
            "text": "By fitting the returned graph, the user may compute the corresponding limit, alternatively to the methods presented in Sec. 5.4.3 and 5.4.4.",
            "section": "Scan of CL s as a function of the signal strength",
            "paragraph_rank": 214,
            "section_rank": 70
        }
    ]
}