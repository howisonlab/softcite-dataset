<?xml version="1.0" encoding="UTF-8"?>
<TEI xml:space="preserve" xmlns="http://www.tei-c.org/ns/1.0" 
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
xsi:schemaLocation="http://www.tei-c.org/ns/1.0 /home/lopez/grobid/grobid-home/schemas/xsd/Grobid.xsd"
 xmlns:xlink="http://www.w3.org/1999/xlink">
	<teiHeader xml:lang="en">
		<fileDesc>
			<titleStmt>
				<title level="a" type="main">Efficient Recycled Algorithms for Quantitative Trait Models on Phylogenies</title>
			</titleStmt>
			<publicationStmt>
				<publisher>Oxford University Press (OUP)</publisher>
				<availability status="unknown"><p>Copyright Oxford University Press (OUP)</p>
				</availability>
				<date type="published" when="2016-04-06">April 6, 2016</date>
			</publicationStmt>
			<sourceDesc>
				<biblStruct>
					<analytic>
						<author>
							<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Gordon</forename><surname>Hiscott</surname></persName>
							<affiliation key="aff0">
								<orgName type="department">Department of Mathematics and Statistics</orgName>
								<orgName type="institution">University of Otago</orgName>
								<address>
									<settlement>Dunedin</settlement>
									<country key="NZ">New Zealand</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Colin</forename><surname>Fox</surname></persName>
							<affiliation key="aff1">
								<orgName type="department">Department of Physics</orgName>
								<orgName type="institution">University of Otago</orgName>
								<address>
									<settlement>Dunedin</settlement>
									<country key="NZ">New Zealand</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Matthew</forename><surname>Parry</surname></persName>
							<affiliation key="aff0">
								<orgName type="department">Department of Mathematics and Statistics</orgName>
								<orgName type="institution">University of Otago</orgName>
								<address>
									<settlement>Dunedin</settlement>
									<country key="NZ">New Zealand</country>
								</address>
							</affiliation>
						</author>
						<author role="corresp">
							<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">David</forename><surname>Bryant</surname></persName>
							<email>david.bryant@otago.ac.nz.</email>
							<affiliation key="aff0">
								<orgName type="department">Department of Mathematics and Statistics</orgName>
								<orgName type="institution">University of Otago</orgName>
								<address>
									<settlement>Dunedin</settlement>
									<country key="NZ">New Zealand</country>
								</address>
							</affiliation>
						</author>
						<title level="a" type="main">Efficient Recycled Algorithms for Quantitative Trait Models on Phylogenies</title>
					</analytic>
					<monogr>
						<title level="j" type="main">Genome Biology and Evolution</title>
						<title level="j" type="abbrev">Genome Biol Evol</title>
						<idno type="eISSN">1759-6653</idno>
						<imprint>
							<publisher>Oxford University Press (OUP)</publisher>
							<biblScope unit="volume">8</biblScope>
							<biblScope unit="issue">5</biblScope>
							<biblScope unit="page" from="1338" to="1350"/>
							<date type="published" when="2016-04-06">April 6, 2016</date>
						</imprint>
					</monogr>
					<idno type="DOI">10.1093/gbe/evw064</idno>
					<idno type="PMID">27056412</idno>
					<idno type="PMCID">PMC4898791</idno>
					<ptr type="open-access" target="https://academic.oup.com/gbe/article-pdf/8/5/1338/13164969/evw064.pdf" />
					<note type="submission">Accepted: March 15, 2016</note>
				</biblStruct>
			</sourceDesc>
		</fileDesc>
		<encodingDesc>
			<appInfo>
				<application version="0.6.2-SNAPSHOT" ident="GROBID" when="2020-08-13T23:02+0000">
					<desc>GROBID - A machine learning software for extracting information from scholarly documents</desc>
					<ref target="https://github.com/kermitt2/grobid"/>
				</application>
			</appInfo>
		</encodingDesc>
		<profileDesc>
			<textClass>
				<keywords>
					<term>likelihood algorithm</term>
					<term>quantitative traits</term>
					<term>continuous traits</term>
					<term>comparative method</term>
					<term>numerical quadrature</term>
					<term>numerical integration</term>
				</keywords>
			</textClass>
			<abstract>
				<p>We present an efficient and flexible method for computing likelihoods for phenotypic traits on a phylogeny. The method does not resort to Monte Carlo computation but instead blends Felsenstein&apos;s discrete character pruning algorithm with methods for numerical quadrature. It is not limited to Gaussian models and adapts readily to model uncertainty in the observed trait values. We demonstrate the framework by developing efficient algorithms for likelihood calculation and ancestral state reconstruction under Wright&apos;s threshold model, applying our methods to a data set of trait data for extrafloral nectaries across a phylogeny of 839 Fabales species.</p>
			</abstract>
		</profileDesc>
	</teiHeader>
	<text xml:lang="en">
		<body>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Introduction</head><p>Statistical models for nucleotide or amino acid mutations and substitutions, and the algorithms for computing with them, are fundamental to the study of molecular evolution and biology. As we widen our focus from the evolution of genes to the evolution of genomes, individuals, and populations, a whole new class of modeling challenges present themselves. These include the development of realistic quantitative models for traits which vary over a continuous range of values (O'Meara 2012). Of course, the usefulness of any new model is contingent on the tools available to compute with them. The main contribution of this article is to show how, by combining ideas from statistical phylogenetics and numerical mathematics, we can compute efficiently with a far larger range of evolutionary models.</p><p>The algorithms we develop are for computation of the likelihood, that is the probability of the data given the phylogeny, evolutionary model and parameters. If we are working with an evolutionary model with only a small (finite) number of states, then likelihoods can be computed using the dynamic programming algorithm of <ref type="bibr" target="#b7">Felsenstein (1981a)</ref>. We will show how to extend this algorithm to also compute likelihoods for (essentially) arbitrary continuous trait models.</p><p>There is already a wide range of evolutionary phenomena that are studied using continuous trait models. Much of comparative genomics relies on implicit or explicit models for the evolution of morphology <ref type="bibr" target="#b34">(Stevens 1991;</ref><ref type="bibr" target="#b10">Felsenstein 2002;</ref><ref type="bibr" target="#b30">Ronquist 2004;</ref><ref type="bibr" target="#b17">Harmon et al. 2010</ref>; O'Meara 2012), many of which make gross simplifying assumptions about how traits vary over time. Continuous evolutionary models have been used in comparative transcriptomics to study heritable aspects of gene expression levels <ref type="bibr" target="#b20">(Khaitovich et al. 2005</ref><ref type="bibr" target="#b19">(Khaitovich et al. , 2006</ref>, an area with exceptional promise given recent improvements in accuracy and the ability to sample in situ <ref type="bibr">(Voelckel et al. 2002)</ref>.</p><p>Continuous trait models will be of growing importance in evolutionary studies of whole-genome single nucleotide polymorphism-databases. Inference methods based on the coalescent such as SNAPP <ref type="bibr" target="#b0">(Bryant et al. 2012)</ref> do not scale well as the number of individuals grows, while those based on continuous models of gene frequencies <ref type="bibr" target="#b1">(Cavalli-Sforza and Edwards 1967;</ref><ref type="bibr" target="#b8">Felsenstein 1981b</ref>; Siré n et al. 2011) depend only on proportions of populations with each allele, so scale extremely well. In addition, it is often easier to model the effect of selection on continuous gene frequency models than with the coalescent. Continuous evolutionary models have also been applied successfully to the study of ancestral geography distributions <ref type="bibr" target="#b25">(Lemey et al. 2010)</ref>.</p><p>Our interest is in developing techniques used to compute with these models, and to expand the range of models we can work with. Early work of <ref type="bibr" target="#b5">Felsenstein (1968</ref><ref type="bibr" target="#b6">Felsenstein ( , 1973</ref>, revisited by <ref type="bibr" target="#b15">Freckleton (2012)</ref> and <ref type="bibr" target="#b14">FitzJohn (2012)</ref>, demonstrated that if traits are evolving according to Brownian motion then we can compute likelihoods quickly and (up to numerical precision) exactly. Felsenstein's approach extends to other Gaussian processes, notably the Ornstein-Uhlenbeck (OU) process <ref type="bibr" target="#b22">(Lande 1976;</ref><ref type="bibr" target="#b9">Felsenstein 1988;</ref><ref type="bibr" target="#b16">Hansen 1997)</ref>, and for several decades, Gaussian models were used almost exclusively to model the evolution of quantitative traits. <ref type="bibr" target="#b18">Ho and Ané (2014)</ref> used clever algebraic techniques to develop an alternative algorithm for computing the likelihood and related quantities. They survey several other models which can be handled using the same approach.</p><p>These methods are very efficient, and when they can be used, they should be used. The drawback of these methods is that they are fundamentally restricted to models which are Gaussian processes or transforms of Gaussian processes, where the computational bottleneck lies in the computation of a quadratic form involving the covariance matrix of <ref type="bibr" target="#b18">Ho and Ané (2014)</ref>. Many evolutionary models cannot be handled within this framework (e.g., <ref type="bibr" target="#b30">Ronquist 2004;</ref><ref type="bibr" target="#b23">Landis et al. 2013)</ref>. Some of the properties of Gaussian processes are quite restrictive: Gaussian processes have single modes, so can only model adaptive landscapes with single peaks; Brownian motion has independent increments, so the rate of change is independent of the value of a trait. The standard strategy for computing with non-Gaussian models is to resort to Monte-Carlo strategies. Even when we are working with a model satisfying the assumptions of <ref type="bibr" target="#b18">Ho and Ané (2014)</ref>, the algorithms they describe do not give an efficient method for integrating over sets of trait values at the tips, as in the threshold models we discuss below.</p><p>Computing the probability of quantitative character evolution may be framed as a numerical integration (quadrature) problem. For most models, if we know the value of the trait at each ancestral node in the phylogeny, we can quickly compute the various transition probabilities. Because we do not usually know these ancestral trait values we integrate them out. This is a multidimensional integration problem with one dimension for each ancestral node (or two dimensions for each node if we are modeling covarying traits) see <ref type="bibr">Felsenstein (2004)</ref>.</p><p>Methods for estimating or approximating integrals are usually judged by their "rate of convergence": how quickly the error of approximation decreases as the amount of work (function evaluations) increases. Consider the problem of computing a one-dimensional integral</p><formula xml:id="formula_0">Z 1 0 f ðxÞdx<label>ð1Þ</label></formula><p>where f is a "nice" function with continuous and bounded derivatives. Simpson's rule, a simple textbook method reviewed below, can be shown to have an OðN À4 Þ rate of convergence, meaning that, asymptotically in N, evaluating ten times more points reduces the error by a factor of 10 4 . In contrast, a standard Monte Carlo method has a rate of convergence of OðN À 1 2 Þ, meaning that evaluating ten times more points will only reduce the error by a factor of around 3. For this reason, numerical analysis texts often refer to Monte Carlo approaches as "methods of last resort."</p><p>Despite this apparently lacklustre performance guarantee, Monte Carlo methods have revolutionized phylogenetics in general and the analysis of quantitative characters in particular. The reason is their partial immunity to the curse of dimensionality. Methods like Simpson's rule are not practical for a high number of dimensions as the asymptotic convergence rate, quoted above, is only achieved for an infeasibly large number of function evaluations N. The effective convergence rate for small N can be very poor, and typically worse than Monte Carlo. In contrast, there are Monte Carlo approaches which achieve close to OðN À 1 2 Þ convergence irrespective of dimension. This has been critical when computing the likelihoods of complex evolutionary models with as many dimensions as there are nodes in the phylogeny.</p><p>The main contribution of our article is to demonstrate how to efficiently and accurately compute likelihoods on a phylogeny using a sequence of one-dimensional integrations. We obtain a fast algorithm with convergence guarantees that far exceed what can be obtained by Monte Carlo integration. Our approach combines two standard tools: classical numerical integrators and Felsenstein's pruning algorithm for discrete characters <ref type="bibr" target="#b7">(Felsenstein 1981a)</ref>. Indeed, the only real difference between our approach and Felsenstein's discrete character algorithm is that we use numerical integration techniques to integrate states at ancestral nodes, instead of just carrying out a summation.</p><p>The running time of the algorithm is OðN 2 nÞ, where N is the number of points used in the numerical integration at each node and n is the number of taxa (leaves) in the tree. Using Simpson's method, we obtain a convergence rate of OðnN À4 Þ, meaning that if we increase N by a factor of 10, we will obtain an estimate which is accurate to four more decimal places.</p><p>To illustrate the application of our general framework, we develop an efficient algorithm for computing the likelihood of a tree under the threshold model of <ref type="bibr" target="#b37">Wright (1934)</ref> and <ref type="bibr" target="#b11">Felsenstein (2005</ref><ref type="bibr" target="#b12">Felsenstein ( , 2012</ref>. We also show how to infer marginal trait densities at ancestral nodes. We have implemented these algorithms and used them to study evolution of extrafloral nectaries (EFN) on an 839-taxon phylogeny of <ref type="bibr" target="#b27">Marazzi et al. (2012)</ref>. MATLAB code for computing the threshold likelihood has been posted on MATLAB Central and complete MATLAB code for all analyses and simulations can be found in supplementary material, Supplementary Material online.</p><p>The combination of numerical integrators and the pruning algorithm opens up a large range of potential models and approaches which we have only just begun to explore. It may well be that Gaussian type models provide good approximations in many contexts, however the extent to which this is true will be unknown until we have computational tools for handling richer models.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Materials and Methods</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Models for Continuous Trait Evolution</head><p>Phylogenetic models for continuous trait evolution, like those for discrete traits, are specified by the density of trait values at the root and the transition densities along the branches. We use f ðx r jy r Þ to denote the density for the trait value at the root, where r is a set of relevant model parameters. We use f ðx i jx j ; y i Þ to denote the transitional density for the value at node i, conditional on the trait value at its parent node j. Here, i represents a bundle of parameters related to node i such as branch length, population size, and mutation rate. All of these parameters can vary throughout the tree.</p><p>To see how the model works, consider how continuous traits might be simulated. A state X r is sampled from the root density f ðX r jy r Þ. We now proceed through the phylogeny from the root to the tips, each time visiting a node only after its parent has already been visited. For each node i, we generate the value at that node from the density f ðX i jx j ; y v Þ, where x j is the simulated trait value at node j, the parent of node i. In this way, we will eventually generate trait values for the tips.</p><p>We use X 1 , . . ., X n to denote the random trait values at the tips and X nþ1 ; . . . ; X 2nÀ1 to denote the random trait values at the internal nodes, ordered so that children come before parents. Hence, X 2nÀ1 is the state assigned to the root. Let EðT Þ ¼ fði; jÞ : node i is a child of node jg ð2Þ denote the set of branches in the tree. The joint density for all trait values, observed and ancestral, is given by multiplying the root density with all of the transition densities</p><formula xml:id="formula_1">f ðx 1 ; . . . ; x n ; x nþ1 ; . . . ; x 2nÀ1 jyÞ ¼ f ðx 2nÀ1 jyÞ Y ði;jÞ2EðT Þ f ðx i jx j ; y i Þ:<label>ð3Þ</label></formula><p>The probability of the observed trait values x 1 ; . . . ; x n is now determined by integrating out all of the ancestral trait values:</p><formula xml:id="formula_2">LðTÞ ¼ f ðx 1 ; . . . ; x n jyÞ ¼ Z Z Á Á Á Z f ðx 2nÀ1 jy r Þ Y ði;jÞ2EðTÞ f ðx i jx j ; y i Þdx nþ1 ; . . . ; dx 2nÀ1 :<label>ð4Þ</label></formula><p>In these integrals, the bounds of integration will vary according to the model. The oldest, and most widely used, continuous trait models assume that traits (or transformed gene frequencies) evolve like Brownian motion <ref type="bibr" target="#b1">(Cavalli-Sforza and Edwards 1967;</ref><ref type="bibr" target="#b6">Felsenstein 1973)</ref>. For these models, the root density f ðx r jyÞ is Gaussian (normal) with mean 0 and unknown variance s 2 r . The transition densities f ðx i jx j ; y v Þ are also Gaussian, with mean x j (the trait value of the parent) and variance proportional to branch length. Note that there are identifiability issues which arise with the inference of the root position under this model, necessitating a few tweaks in practice (see the discussion in Chapter 23 of <ref type="bibr">Felsenstein 2004)</ref>.</p><p>It can be shown that when the root density and transitional densities are all Gaussian, the joint density (4) is multivariate Gaussian. Furthermore, the covariance matrix for this density has a special structure which methods such as the pruning techniques of <ref type="bibr" target="#b5">Felsenstein (1968</ref><ref type="bibr" target="#b6">Felsenstein ( , 1973</ref>, <ref type="bibr" target="#b15">Freckleton (2012)</ref>, and FitzJohn (2012) exploit, as does the top-down approach of <ref type="bibr" target="#b18">Ho and Ané (2014)</ref>. This general approach continues to work when Brownian motion is replaced by an OU process <ref type="bibr" target="#b22">(Lande 1976;</ref><ref type="bibr" target="#b9">Felsenstein 1988;</ref><ref type="bibr" target="#b16">Hansen 1997)</ref>, or indeed to many linear or generalized linear models.</p><p>Gaussian models, and their relatives, are mathematically and computationally convenient, but rely on assumptions which are unrealistic and inappropriate in many contexts. Numerous researchers have implemented models which do not fit into the general Gaussian framework; most have resorted to Monte Carlo computation to carry out their analyses.</p><p>Landis et al. (2013) discuss a class of continuous trait models which are based on Lé vy processes and include jumps. At particular times, as governed by a Poisson process, the trait value jumps to a value drawn from a given density. Examples include a compound Poisson process with Gaussian jumps and a Variance Gamma model given by Brownian motion with time varying according to a gamma process. Both of these processes have analytical transition probabilities in some special cases. <ref type="bibr" target="#b26">Lepage et al. (2006)</ref> use the Cox-Ingersoll-Ross (CIR) process to model rate variation across a phylogeny. Like the OU process (but unlike Brownian motion), the CIR process is ergodic. It has a stationary Gamma density which can be used for the root density. The transition density is a particular noncentral chi-squared density and the process only assumes positive values.</p><p>Kutsukake and Innan (2013) examine a family of compound Poisson models, focusing particularly on a model where the trait values make exponentially distributed jumps upwards or downwards. In the case that the rates of upward and downward jumps are the same, the model has jumps that follow a double exponential distribution. <ref type="bibr" target="#b21">Kutsukake and Innan (2013)</ref> use approximate Bayesian computation to carry out inference.</p><p>Siré n et al. <ref type="formula">2011</ref>propose a simple and elegant model for gene frequencies whereby the root value is drawn from a Beta distribution and each transitional density is Beta with appropriately chosen parameters.</p><p>Trait values at the tips are not always observed directly. A simple, but important, example of this is the threshold model of <ref type="bibr" target="#b37">Wright (1934)</ref>, explored by <ref type="bibr" target="#b11">Felsenstein (2005)</ref>. Under this model, the trait value itself is censored and we only observe whether or not the value is positive or negative. A similar complication arises when dealing with gene frequency data as we typically do not observe the actual gene frequency but instead a binomially distributed sample based on that frequency (Siré n et al. 2011).</p><p>If the trait values at the tip are not directly observed we integrate over these values as well. Let pðz i jx i Þ denote the probability of observing z i given the trait value x i . The marginalized likelihood is then</p><formula xml:id="formula_3">LðT jz 1 ; . . . ; z n Þ ¼ Z Z Á Á Á Z f ðx r jyÞ Y ði;jÞ2EðT Þ f ðx i jx j ; y v Þ Y n i¼1 pðz i jx i Þdx 1 ; . . . ; dx 2nÀ1 :<label>ð5Þ</label></formula><p>Numerical Integration</p><p>Analytical integration can be difficult or impossible. For the most part, it is unusual for an integral to have an analytical solution and there is no general method for finding it when it does exist. In contrast, numerical integration techniques (also known as numerical quadrature) are remarkably effective and are often easy to implement. A numerical integration method computes an approximation of the integral from function values at a finite number of points. Hence, we can obtain approximate integrals of functions even when we do not have an equation for the function itself. See <ref type="bibr" target="#b2">Cheney and Kincaid (2012)</ref> for an introduction to numerical integration, and <ref type="bibr" target="#b3">Dahlquist and Bjö rck (2008)</ref> and <ref type="bibr" target="#b4">Davis and Rabinowitz (1984)</ref> for more comprehensive technical surveys. The idea behind most numerical integration techniques is to approximate the target function using a function which is easy to integrate. In this article, we will restrict our attention to Simpson's method which approximates the original function using piecewise quadratic functions. To approximate an integral R b a f ðxÞdx we first determine N + 1 equally spaced points (N even)</p><formula xml:id="formula_4">x 0 ¼ a; x 1 ¼ a þ b À a N ; x 2 ¼ a þ 2 b À a N ; . . . ; x k ¼ a þ k b À a N ; . . . ; x N ¼ b:<label>ð6Þ</label></formula><p>We now divide the integration into N=2 intervals</p><formula xml:id="formula_5">Z b a f ðxÞdx ¼ X N=2 '¼1 Z x 2' x 2'À2 f ðxÞdx:<label>ð7Þ</label></formula><p>Within each interval ½x 2'À2 ; x 2' , there is a unique quadratic function which equals f(x) at each the three points x ¼ x 2'À2 ; x ¼ x 2'À1, and x ¼ x 2' . The integral of this quadratic on the interval</p><formula xml:id="formula_6">½x 2'À2 ; x 2' is ðb À aÞ 3N f ðx 2'À2 Þ þ 4f ðx 2'À1 Þ þ f ðx 2' Þ ð Þ ð<label>8Þ</label></formula><p>Summing over ', we obtain the approximation</p><formula xml:id="formula_7">Z b a f ðxÞdx&amp; X N=2 '¼1 ðb À aÞ 3N f ðx 2'À2 Þ þ 4f ðx 2'À1 Þ þ f ðx 2' Þ ð Þ :<label>ð9Þ</label></formula><p>With a little rearrangement, the approximation can be written in the form</p><formula xml:id="formula_8">Z b a f ðxÞdx&amp; ðb À aÞ N X N k¼0 w k f ðx k Þ ð 10Þ</formula><p>where w k ¼ 4=3 when k is odd and w k ¼ 2=3 when k is even, with the exception of w 0 and w N which both equal 1/3. Simpson's method is easy to implement and has a convergence rate of OðN À4 Þ. Increasing the number of intervals by a factor of 10 decreases the error by a factor of 10 À4 . See <ref type="bibr" target="#b3">Dahlquist and Bjö rck (2008)</ref> and <ref type="bibr" target="#b4">Davis and Rabinowitz (1984)</ref> for further details. It should be remembered, however, that the convergence rate is still only an asymptotic bound, and gives no guarantees on how well the method performs for a specific function and choice of N. Simpson's method, for example, can perform quite poorly when the function being integrated has rapid changes or sharp peaks. We observed this behavior when implementing threshold models, as described below. Our response was to better tailor the integration method for the functions appearing. We noted that the numerical integrations we carried out all had the form Z b a e À ðxÀmÞ 2 2s 2 f ðxÞdx ð11Þ</p><p>where and varied. Using the same general approach as Simpson's rule, we approximated f(x), rather than the whole function e À ðxÀmÞ 2 2s 2 f ðxÞ, by a piecewise quadratic function p(x). We could then use standard techniques and tools to evaluate R b a e À ðxÀmÞ 2 2s 2 pðxÞdx numerically. The resulting integration formula, which we call the "Gaussian kernel method," gives a significant improvement in numerical accuracy.</p><p>A further complication is that, in models of continuous traits, the trait value often ranges over the whole real line, or at least over the set of positive reals. Hence, we need to approximate integrals of the form</p><formula xml:id="formula_9">Z 1 À1 f ðxÞdx or Z 1 0 f ðxÞdx<label>ð12Þ</label></formula><p>though the methods discussed above only apply to integrals on finite intervals. We truncate these integrals, determining values U and L such that the difference</p><formula xml:id="formula_10">Z 1 À1 f ðxÞdx À Z U L f ðxÞdx<label>ð13Þ</label></formula><p>between the full integral R 1 À1 f ðxÞdx and the truncated integral R U L f ðxÞdx can be bounded analytically. Other strategies are possible; see <ref type="bibr" target="#b3">Dahlquist and Bjö rck (2008)</ref> for a comprehensive review.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>A Pruning Algorithm for Integrating Continuous Traits</head><p>Felsenstein has developed pruning algorithms for both continuous and discrete characters <ref type="bibr">(Felsenstein 1981a,b)</ref>. His algorithm for continuous characters works only for Gaussian processes. Our approach is to take his algorithm for discrete characters and adapt it to continuous characters.</p><p>The (discrete character) pruning algorithm is an application of dynamic programming. For each node i, and each state x, we compute the probability of observing the states for all tips which are descendants of node i, conditional on node i having ancestral state x. This probability is called the partial likelihood at node i given state x. Our algorithm follows the same scheme, with one major difference. Since traits are continuous, we cannot store all possible partial likelihoods. Instead, we store likelihoods for a finite set of values and plug these values into a numerical integration routine.</p><p>Let i be the index of a node in the tree not equal to the root, let node j be its parent node. We define the partial likelihood, F i ðx j Þ; to be the likelihood for the observed trait values at the tips which are descendants of node i, conditional on the parent node j having trait value x j . If node i is a tip with observed trait value x i we have</p><formula xml:id="formula_11">F i ðx j Þ ¼ f ðx i jx j ; y i Þ ð<label>14Þ</label></formula><p>recalling that f ðx i jx j ; y i Þ is the density for the value of the trait at node i conditional on the value of the trait for its parent. More generally, we may only observe some value z i for which we have the conditional probability pðz i jx i Þ conditional on the trait value x i . In this case, the partial likelihood is given by</p><formula xml:id="formula_12">F i ðx j Þ ¼ Z f ðx i jx j ; y i Þpðz i jx i Þdx i :<label>ð15Þ</label></formula><p>Suppose node i is not the root and that it has two children u and v. Since trait evolution is conditionally independent on disjoint subtrees, we obtain the recursive formula</p><formula xml:id="formula_13">F i ðx j Þ ¼ Z f ðx i jx j ; y i ÞF u ðx i ÞF v ðx i Þdx i :<label>ð16Þ</label></formula><p>Finally, suppose that node i is the root and has two children u and v. We evaluate the complete tree likelihood using the density of the trait value at the root,</p><formula xml:id="formula_14">LðT Þ ¼ Z f ðxjy r ÞF u ðxÞF v ðxÞdx:<label>ð17Þ</label></formula><p>The bounds of integration in (15)-(17) will vary according to the model.</p><p>We use numerical integration techniques to approximate (15)-(17) and dynamic programming to avoid an exponential explosion in the computation time. Let N denote the number of function evaluations for each node. In practice, this might vary over the tree, but for simplicity we assume that it is constant. For each node i, we select N + 1 trait values</p><formula xml:id="formula_15">X i ½0 &lt; X i ½1 &lt; Á Á Á &lt; X i ½N:<label>ð18Þ</label></formula><p>How we do this will depend on the trait model and the numerical integration technique. If, for example, the trait values vary between a and b and we are applying Simpson's method with N intervals we would use</p><formula xml:id="formula_16">X i ½k ¼ a þ bÀa N k for k ¼ 0; 1; 2; . . . ; N.</formula><p>We traverse the tree starting at the tips and working toward the root. For each nonroot node i and k ¼ 0; 1; . . . ; N we compute and store an approximation F i ½k of F i ðX j ½kÞ, where node j is the parent of node i. Note that this is an approximation of F i ðX j ½kÞ rather than of F i ðX i ½kÞ since F i ðxÞ is the partial likelihood conditional on the trait value for the parent of node i. The value approximation F v ½i is computed by applying the numerical integration method to the appropriate integral (15)- <ref type="formula" target="#formula_14">17</ref>, where we replace function evaluations with approximations previously computed. See below for a worked example of this general approach.</p><p>The numerical integration methods we use run in time linear in the number of points being evaluated. Hence, if n is the number of tips in the tree, the algorithm will run in time OðnN 2 Þ. For the integration techniques described above, the convergence rate (in N) for the likelihood on the entire tree had the same order as the convergence rate for the individual onedimensional integrations (see below for a formal proof of a specific model). We have therefore avoided the computational blow-out typically associated with such high-dimensional integrations, and achieve this without sacrificing accuracy.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Posterior Densities for Ancestral States</head><p>The algorithms we have described compute the joint density of the states at the tips, given the tree, the branch lengths, and other parameters. As with discrete traits, the algorithms can be modified to infer ancestral states for internal nodes in the tree. Here, we show how to carry out reconstruction of the marginal posterior density of a state at a particular node. The differences between marginal and joint reconstructions are reviewed in <ref type="bibr">Yang (2006, p. 121)</ref>.</p><p>First consider marginal reconstruction of ancestral states at the root. Let u and v be the children of the root. The product F u ðxÞF v ðxÞ equals the probability of the observed character conditional on the tree, branch lengths, parameters, and a state of x at the root. The marginal probability of x, ignoring the data, is given by the root density f ðxjy r Þ. Integrating the product of F u ðxÞF v ðxÞ and f ðxjy r Þ gives the likelihood LðT Þ, as in (17). Plugging these into Bayes' rule, we obtain the posterior density of the state at the root:</p><formula xml:id="formula_17">f ðx r jz 1 ; . . . ; z n Þ ¼ F u ðx r ÞF v ðx r Þf ðx r jy r Þ LðT Þ :<label>ð19Þ</label></formula><p>With general time reversible models used in phylogenetics, the posterior distributions at other nodes can be found by changing the root of the tree. Unfortunately, the same trick does not work for many quantitative trait models. Furthermore, recomputing likelihoods for each possible root entails a large amount of unnecessary computation.</p><p>Instead, we derive a second recursion, this one starting at the root and working toward the tips. A similar trick is used to compute derivatives of the likelihood function in <ref type="bibr" target="#b13">Felsenstein and Churchill (1996)</ref>. For a node i and state x we let G i ðxÞ denote the likelihood for the trait values at tips which are not descendants of node i, conditional on node i having trait value x. If node i is the root r, then G r ðxÞ is 1 for all x.</p><p>Let node i be any node apart from the root, let node j be its parent and let node u be the other child of j (that is, the sibling of node i). We letx denote the trait value at node j. Then G i ðxÞ can be written</p><formula xml:id="formula_18">G i ðxÞ ¼ Z f ðxjx; y i ÞG j ðxÞF u ðxÞdx:<label>ð20Þ</label></formula><p>This integral can be evaluated using the same numerical integrators used when computing likelihoods. Note that f ðxj x; y i Þ is the conditional density of the parent state given the child state, which is the reverse of the transition densities used to formulate the model. It should be noted that while Brownian motion has reversible transition probabilities, the OU process does not. How G i ðxÞ is computed will depend on the model and its properties; see below for an implementation of this calculation in the threshold model.</p><p>Once G i ðxÞ has been computed for all nodes, the actual (marginal) posterior densities are computed from Bayes' rule. Letting u, v be the children of node i,</p><formula xml:id="formula_19">f ðx i jz 1 ; . . . ; z n Þ ¼ G i ðx i ÞF u ðx i ÞF v ðx i Þf ðx i Þ LðT Þ :<label>ð21Þ</label></formula><p>Case study: threshold models</p><p>In this section, we show how the general framework can be applied to the threshold model of <ref type="bibr" target="#b37">Wright (1934)</ref> and <ref type="bibr" target="#b11">Felsenstein (2005</ref><ref type="bibr" target="#b12">Felsenstein ( , 2012</ref>. Each trait is modeled by a continuously varying "liability" which evolves along branches according to a Brownian motion process. While the underlying liability is continuous, the observed data are discrete: at each tip we observe only whether the liability is above or below some threshold. We will use standard notation for Gaussian densities. Let ðxjm; s 2 Þ denote the density of a Gaussian random variable x with mean and variance s 2 ; let</p><formula xml:id="formula_20">Èðyjm; s 2 Þ ¼ Z y À1 ðxjm; s 2 Þ ð<label>22Þ</label></formula><p>denote its cumulative density function, with inverse È À1 ðajm; s 2 Þ. Let X 1 ; . . . ; X 2nÀ1 denote the (unobserved) liability values at the n tips and nÀ1 internal nodes. As above we assume that the i &lt; j whenever node i is a child of node j, so that the root has index 2n À 1.</p><p>The liability value at the root has a Gaussian density with mean r and variance s 2</p><formula xml:id="formula_21">r : f ðx 2nÀ1 jy r Þ ¼ ðx 2nÀ1 jm r ; s 2 r Þ:<label>ð23Þ</label></formula><p>Consider any nonroot node i and let j be the index of its parent. Let t i denote the length of the branch connecting nodes i and j. Then X i has a Gaussian density with mean x j and variance s 2 t v :</p><formula xml:id="formula_22">f ðx i jx j ; y i Þ ¼ ðx i jx j ; s 2 t i Þ:<label>ð24Þ</label></formula><p>Following Felsenstein (2005), we assume thresholds for the tips are all set at zero. We observe 1 if the liability is positive, 0 if the liability is negative, and ? if data are missing. We can include the threshold step into our earlier framework by defining</p><formula xml:id="formula_23">pðz i jx i Þ ¼ 1 if z i ¼ 1 and x i &gt; 0; or z i ¼ 0 and x i 0; or z i ¼ ? 0 o t h e r w i s e : (<label>ð25Þ</label></formula><p>The likelihood function for observed discrete values z 1 ; . . . ; z n is then given by integrating over liability values for all nodes on the tree:</p><formula xml:id="formula_24">LðT jz 1 ; . . . ; z n Þ ¼ Z 1 À1 Á Á Á Z 1 À1 ðx 2nÀ1 jm r ; s 2 r Þ Y ði;jÞ ðx i jx j ; s 2 t i Þ Y n i¼1 pðz i jx i Þ dx 1 . . . dx 2nÀ1 :<label>ð26Þ</label></formula><p>The first step toward computing LðT jz 1 ; . . . ; z n Þ is to bound the domain of integration so that we can apply Simpson's method. Ideally, we would like these bounds to be as tight as possible, for improved efficiency. For the moment we will just outline a general procedure which can be adapted to a wide range of evolutionary models.</p><p>The marginal (prior) density of a single liability or trait value at a single node is the density for that liability value marginalizing over all other values and data. With the threshold model, the marginal density for the liability at node i is Gaussian with mean r (like the root) and variance v i equal to the sum of the variance at the root and the transition variances on the path from the root to node i. If P i is the set of nodes from the root to node i, then</p><formula xml:id="formula_25">v i ¼ s 2 r þ s 2 X j2P i t j :<label>ð27Þ</label></formula><p>The goal is to constrain the error introduced by truncating the integrals with infinite domain. Let be the desired bound on this truncation error. Recall that the number of internal nodes in the tree is nÀ1. Define</p><formula xml:id="formula_26">L i ¼ È À1 2ðn À 1Þ jm r ; v i<label>ð28Þ</label></formula><p>and</p><formula xml:id="formula_27">U i ¼ È À1 1 À 2ðn À 1Þ jm r ; v i :<label>ð29Þ</label></formula><p>The bounds L i and U i are chosen so that the (marginal) probability X i lies outside the interval ½L i ; U i is at most =ðn À 1Þ. For this model, these are given by the inverse distribution function of a Gaussian; other models would involved different transition densities. By the inclusion-exclusion principle, the joint probability X i 2 ½L i ; U i for any internal node i is at most . We use this fact to bound the contribution of the regions outside these bounds.</p><formula xml:id="formula_28">Z 1 À1 Á Á Á Z 1 À1 f ðx 2nÀ1 jm r ; s 2 r Þ Y ðu;vÞ f ðx v jx u ; y v Þ Y n i¼1 pðz i jx i Þdx 1 . . . dx 2nÀ1 À Z b 2nÀ1 a 2nÀ1 Á Á Á Z b nþ1 a nþ1 Z 1 À1 Á Á Á Z 1 À1 f ðx 2nÀ1 jm r ; s 2 r Þ Y ðu;vÞ f ðx v jx u ; y v Þ Y n i¼1 pðz i jx i Þdx 1 . . . dx 2nÀ1 ð30Þ Z 1 À1 Á Á Á Z 1 À1 f ðx 2nÀ1 jm r ; s 2 r Þ Y ðu;vÞ f ðx v jx u ; y v Þdx 1 . . . dx 2nÀ1 À Z b 2nÀ1 a 2nÀ1 Á Á Á Z b nþ1 a nþ1 Z 1 À1 Á Á Á Z 1 À1 f ðx 2nÀ1 jm r ; s 2 r Þ Y ðu;vÞ f ðx v jx u ; y v Þdx 1 . . . dx 2nÀ1<label>ð31Þ</label></formula><formula xml:id="formula_29">PðX nþ1 = 2 ½L nþ1 ; U nþ1 or X nþ2 = 2 ½L nþ2 ; U nþ2 or Á Á Á orX 2nÀ1 = 2½L 2nÀ1 ; U 2nÀ1 Þ ð32Þ &lt; :<label>ð33Þ</label></formula><p>We therefore compute values L i , U i for n þ 1 i 2n À 1 using (28) and (29) repeatedly, and use these bounds when carrying out integration at the internal nodes. We define</p><formula xml:id="formula_30">X i ½k ¼ L i þ U i À L i N k<label>ð34Þ</label></formula><p>for k ¼ 0; 1; . . . ; N and each internal node i. The next step is to use dynamic programming and numerical integration to compute the approximate likelihood. Let node i be a tip of the tree, let node j be its parent and let z i be the binary trait value at this tip. For each k ¼ 0; 1; . . . ; N we use standard error functions to compute</p><formula xml:id="formula_31">F i ½k ¼ F i ðX j ½kÞ ð35Þ ¼ Z 1 0 ðxjX j ½k; s 2 t i Þdx if z i ¼ 1 Z 0 À1 ðxjX j ½k; s 2 t i Þdx if z i ¼ 0 1 i fz i ¼ ?: 8 &gt; &gt; &gt; &gt; &gt; &gt; &lt; &gt; &gt; &gt; &gt; &gt; &gt; :<label>ð36Þ</label></formula><p>Here, ðxjm; s 2 Þ is the density of a Gaussian with mean and variance s 2 . Now suppose that node i is an internal node with parent node j and children u and v. Applying Simpson's rule to the bounds L i , U i to (16) we have for each k ¼ 0; 1; . . . ; N:</p><formula xml:id="formula_32">F i ½k ¼ U i À L i N X N '¼0 w ' ðX i ½'jX j ½k; s 2 t i ÞF u ½'F v ½'<label>ð37Þ</label></formula><formula xml:id="formula_33">&amp;F i ðX j ½kÞ:<label>ð38Þ</label></formula><p>Suppose node i is the root, and u, v are its children. Applying Simpson's rule to (17) gives an approximate likelihood of</p><formula xml:id="formula_34">U 2nÀ1 À L nÀ1 N X N '¼0 w ' ðX i ½'jm r ; s 2 r ÞF u ½'F v ½':<label>ð39Þ</label></formula><p>Pseudocode for the algorithm appears in Algorithm 1. </p><formula xml:id="formula_35">i = n + 1, n + 2, . . . , 2n−1 L i ← Φ −1 ( nN −4 2(n−1) |μ r , σ 2 r + σ 2 p i ) U i ← Φ −1 (1 − nN −4 2(n−1) |μ r , σ 2 r + σ 2 p i ) X i ← (U i − L i )x + L i For all tip nodes i = 1, 2, . . . , n</formula><p>Let j be the index of the parent of node i</p><formula xml:id="formula_36">For k = 0, . . . , N If z i = 1 F i [k] = 1 − Φ(0; X j [k], σ 2 t i ) else if z i = 0 F i [k] = Φ(0; X j [k], σ 2 t i )</formula><p>For all internal nodes i = n+1, ..., 2n−2, excluding the root Let j be the index of the parent of node i Let u, v be the indices of the children of node i</p><formula xml:id="formula_37">For k = 0, 1, . . . , N F i [k] ← U i − L i N N =0 w φ(X i [ ]; X j [k], σ 2 t i )F u [ ]F v [ ]</formula><p>Let u, v be indices of the the children of the root.</p><formula xml:id="formula_38">L ← U 2n−1 − L n−1 N N =0 w φ(X i [ ]; μ r , σ 2 r )F u [ ]F v [ ]</formula><p>Algorithm 1 Pseudo-code of the likelihood approximation algorithm for a single character, under the threshold model. The nodes are numbered in increasing order from tips to the root.</p><p>Regarding efficiency and convergence we have: Theorem 1 Algorithm 1 runs in OðnN 2 Þ time and approximates L(T) with OðnN À4 Þ error.</p><p>Proof The running time follows from the fact that for each of the O(n) nodes in the tree we carry out O(N) applications of Simpson's method.</p><p>Simpson's rule has OðN À4 Þ convergence on functions with bounded fourth derivatives <ref type="bibr" target="#b3">(Dahlquist and Bjö rck 2008)</ref>. The root density and each of the transition densities are Gaussians, so individually have bounded fourth derivatives. For each node i, let n i denote the number of tips which are descendants of the node. Using induction on (16), we see that for all nodes i, the fourth derivative of F i ðxÞ is Oðn i Þ.</p><p>If we use ¼ nN À4 in (28) and (29) then replacing the infinite domain integrals with integrals on ½L i ; U i introduces at most nN À4 error. Using a second induction proof on (16) and (37) together with the bound on fourth derivatives, we have that jF i ðX j ½kÞ À F i ½kj is at most Oðn i N À4 Þ for all nodes i, where node j is the parent of node i. In this way we obtain error bound of Oðn 2nÀ1 N À4 Þ ¼ OðnN À4 Þ on the approximation of LðT jz 1 ; . . . ; z n ; yÞ: « We can estimate posterior densities using the recursion (20) followed by equation <ref type="formula" target="#formula_19">21</ref>. The conditional density</p><formula xml:id="formula_39">f ðxjx; y i Þ ¼ xjm r þ v j v i x À m r À Á ; s 2 t i v j v i<label>ð40Þ</label></formula><p>can be obtained by plugging the transitional density</p><formula xml:id="formula_40">f ðxjx; y i Þ ¼ ðxjx; s 2 t i Þ ð<label>41Þ</label></formula><p>and the two marginal densities (27)</p><formula xml:id="formula_41">f ðxÞ ¼ ðx; v j Þ; f ðxÞ ¼ ðx; v i Þ ð<label>42Þ</label></formula><p>into the identity f ðxjx; y i Þ ¼ f ðxjx; y i Þ f ðx Þ f ðxÞ . We thereby obtain the recursion</p><formula xml:id="formula_42">G i ðxÞ ¼ Z xjm r þ v j v i x À m r À Á ; s 2 t i v j v i G j ðxÞF u ðxÞdx<label>ð43Þ</label></formula><p>which we estimate using Simpson's method. Algorithm estimates values of the posterior densities at each node, evaluated using the same set of grid points as used in Algorithm 1. An additional round of numerical integration can be used to obtain posterior means and variances.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Evolutionary Precursors of Plant Extrafloral Nectaries</head><p>To study the methods in practice, we reanalyze trait data published by <ref type="bibr" target="#b27">Marazzi et al. (2012)</ref>, using a fixed phylogeny. <ref type="bibr" target="#b27">Marazzi et al. (2012)</ref> introduce and apply a new discrete state model for morphological traits which, in addition to states for presence and absence, incorporates an intermediate "precursor" state. Whenever the intermediate state is observed at the tips it is coded as "absent." The motivation behind the model is that the intermediate state represents evolutionary precursors, changes which are necessary for the evolution of a new state but which may not be directly observed. These precursors could explain repeated parallel evolution of a trait in closely related traits <ref type="bibr" target="#b27">(Marazzi et al. 2012)</ref>. They compiled a data set recording presence or absence of plant EFNs across a phylogeny of 839 species of Fabales, fitting their models to these data. The threshold model also involves evolutionary precursors in terms of changes in ancestral liabilities. We use these models, and our new algorithms to analyze the EFN data set. Our analysis also makes use of the time-calibrated phylogeny inferred by <ref type="bibr" target="#b31">Simon et al. (2009)</ref>, although unlike <ref type="bibr" target="#b27">Marazzi et al. (2012)</ref> we ignore phylogenetic uncertainty.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Experimental Protocol</head><p>We conduct three separate experiments. For the first experiment, we examine the rate of convergence of the likelihood algorithm as we increase N. This is done for the "All" EFN character (Character 1 in <ref type="bibr" target="#b27">Marazzi et al. [2012]</ref>) for a range of estimates for the liability variance at the root, s 2 r . The interest in s 2 r stems from its use in determining bounds L i , U i for each node, with the expectation that as s 2 r increases, the convergence of the integration algorithm will slow. The mean liability at the root, r , was determined from the data using Maximum Likelihood estimation.</p><p>We also examined convergence of the algorithm on randomly generated characters. We first evolved liabilities according to the threshold model, using the parameter settings obtained above. To examine the difference in performance for non-phylogenetic characters, we also simulated binary characters by simulated coin flipping. Twenty replicates were carried out for each case.</p><p>The second experiment extends the model comparisons carried out in <ref type="bibr" target="#b27">Marazzi et al. (2012)</ref> to include the threshold models. For this comparison we fix the transitional variance s 2 at one, since changing this values corresponds to a rescaling of the Brownian process, with no change in likelihood. With only one character, the maximum likelihood estimate of the root variance s 2 r is zero, irrespective of the data. This leaves a single parameter to infer: the value of the liability at the root state. We computed a maximum likelihood estimate for the state at the root, then applied our algorithm with a sufficiently large value of N to be sure of convergence. The Akaike Information Criterion (AIC) was determined and compared with those obtained for the model of <ref type="bibr" target="#b27">Marazzi et al. (2012)</ref>.</p><p>For the third experiment, we determine the marginal posterior densities for the liabilities at internal nodes, using Algorithm 2. Let j be the index of the parent of node i. Let v be the index of the sibling of node i.</p><formula xml:id="formula_43">For k = 0, 1, . . . , N μ ← μ r + σ 2 r +σ 2 pj σ 2 r +σ 2 pi (X i [k] − μ r ) V ← σ 2 ti(σ 2 r +σ 2 pj ) σ 2 r +σ 2 pi G i [k] ← U j − L j N N =0 w φ(X j [ ]; μ, V )G j [ ]F v [ ] For all i = n + 1, . . . , 2n − 1 Let u, v be the children of node i. For all k = 0, 1, . . . , N H i [k] ← 1 L G i [k]F u [k]F v [k]φ(X i [k]|μ r , σ 2 r + σ 2 p i )</formula><p>Algorithm 2 Pseudocode for the algorithm to efficiently compute ancestral posterior densities under the threshold model. At the termination of the algorithm, H i ½k is an estimate of the posterior density at internal node i, evaluated at x ¼ X i ½k.</p><p>These posterior probabilities are then mapped onto the phylogeny, using shading to denote the (marginal) posterior probability that a liability is larger than zero. We therefore obtain a figure analogous to supplementary figure S7, Supplementary Material online, of <ref type="bibr" target="#b27">Marazzi et al. (2012)</ref>.  </p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Results</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Convergence of the Algorithm</head><p>To examine convergence, we compute the absolute error of each likelihood approximation because the actual likelihood is not available we use the approximation when N = 1,000. Plots of error versus N are given in figure 1, both for Simpson's method (left) and for the modified Gaussian kernel method (right). For larger N, the error in a log-log plot decreases with slope at most À4 (as indicated), corresponding to N À4 convergence of the method. Log-log plots of error versus N for the simulated data are given in figure 2. In each case, the method converges for by N&amp;30.</p><p>While the level of convergence for both algorithms is correct, the accuracy of the method based on Simpson's method is far worse. When a branch length is short, the transition density becomes highly peaked, as does the function being integrated. Such functions are difficult to approximate with piecewise quadratics, and Simpson's method can fail miserably. Indeed, for N &lt; 50, we would often observe estimated probabilities equal to 0, or estimates greater than 1! (These were omitted from the plots). Although we can always bound estimates computed by the algorithm, a sounder approach is to improve the integration technique. This we did using the Gaussian kernel method, and the result was far improved accuracy for little additional computation. For the remainder of the experiments with this model we used the Gaussian kernel method when carrying out numerical integration.  <ref type="bibr" target="#b27">Marazzi et al. (2012)</ref>. All likelihoods and AIC values rounded to 1 d.p. Boldface indicates the best fitting model for each trait. A pre-cursor model with one parameter was used for all experiments, except for trait 6 where a two-parameter model gave a better AIC than the one-parameter model (see discussion in <ref type="bibr" target="#b27">Marazzi et al. (2012)</ref>.  <ref type="bibr" target="#b27">Marazzi et al. (2012)</ref> describe AIC comparisons between their precursor model and a conventional binary trait model. We extend this comparison to include the threshold model. This is a one parameter model, the parameter being the value of the liability at the root. We used the MATLAB command fminsearch with multiple starting points to compute the maximum likelihood estimate for this value. The resulting log-likelihood was log?L ¼ À240:6, giving an AIC of 483.2. This compares to an AIC of 507.4 for the (two parameter) binary character model and an AIC of 495.4 for the (one parameter) precursor model of <ref type="bibr" target="#b27">Marazzi et al. (2012)</ref>.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Model Comparison</head><p>We analyzed the five other EFN traits in the same way, and present the computed AIC values in table 1, together with AIC values for the two parameter binary state model and one parameter precursor model computed by <ref type="bibr" target="#b27">Marazzi et al. (2012)</ref> (and the two parameter precursor model for trait 6). We see that the threshold model fits better than either the binary or precursor models for all of the six traits.</p><p>It is not clear, a priori, why the threshold model would appear to fit some data better than the precursor model because they appear to capture similar evolutionary phenomena. It would be useful to explore this observation more thoroughly, given the new computational tools, perhaps incorporating phylogenetic error in a manner similar to <ref type="bibr" target="#b27">Marazzi et al. (2012)</ref>. <ref type="figure">Figure 3</ref> gives a representation of how the (marginal) posterior liabilities change over the tree. Branches are divided into three classes according to the posterior probability that the liability is positive, with lineages with posterior probability &gt; 0.7 colored red, lineages with posterior probability &lt; 0.3 colored white, and remaining lineages colored pink.  <ref type="bibr" target="#b31">Simon et al. (2009)</ref>. Lineages with posterior probability &gt; 0.7 colored red, lineages with posterior probability &lt; 0.3 colored white, and remaining lineages colored pink. This diagram can be compared with <ref type="bibr" target="#b27">Marazzi et al. (2012)</ref>, <ref type="figure">figure S7</ref>. The representations are, on the whole, directly comparable. A positive liability corresponds, roughly, to an ancestral precursor state. Both analyses suggest multiple origins of a precursor state, for example for a large clade of Mimosoidae. Interestingly, there are several clades where the analysis of <ref type="bibr" target="#b27">Marazzi et al. (2012)</ref> suggests widespread ancestral distribution of the precursor state whereas our analysis indicates a negative liability at the same nodes.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Inferring Ancestral Liabilities</head><p>Once again, our analysis is only preliminary, our goal here simply being to demonstrate what calculations can now be carried out.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Discussion</head><p>We have introduced a new framework for the computation of likelihoods from continuous characters, and illustrated the framework using an efficient algorithm for evaluating (approximate) likelihoods under <ref type="bibr">Wright and Felsenstein's threshold model.</ref> This framework opens up possibilities in several directions. The numerical integration, or numerical quadrature, literature is vast. In this article, we have focused in on a popular and simple numerical integration method, and our algorithm should be seen as a proof of principle rather than a definitive threshold likelihood method. There is no question that the numerical efficiency of Algorithm 1 could be improved significantly through the use of more sophisticated techniques: better basis functions or adaptive quadrature methods for a start.</p><p>The connection with Felsenstein's (discrete character) pruning algorithm also opens up opportunities for efficiency gains. Techniques such as storing partial likelihoods, or approximating local neighborhoods, are fundamental to efficient phylogenetic computations on sequence data <ref type="bibr" target="#b7">(Felsenstein 1981a;</ref><ref type="bibr" target="#b24">Larget and Simon 1998;</ref><ref type="bibr" target="#b35">Swofford 2002;</ref><ref type="bibr" target="#b29">Pond and Muse 2004;</ref><ref type="bibr" target="#b33">Stamatakis 2006)</ref>. These tricks could all be now applied to the calculation of likelihoods from continuous traits.</p><p>Finally, we stress that the algorithm does not depend on special characteristics of the continuous trait model, beyond conditional independence of separate lineages. Felsenstein's pruning algorithm for continuous characters is limited to Gaussian processes and breaks down if, for example, the transition probabilities are governed by Levy processes <ref type="bibr" target="#b23">(Landis et al. 2013)</ref>. In contrast, our approach works whenever we can numerically evaluation transition densities, an indeed only a few minor changes would transform our Algorithm 1 to one implementing on a far more complex evolutionary process.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Supplementary Material</head><p>Supplementary material is available at Genome Biology and Evolution online (http://www.gbe.oxfordjournals.org/).</p></div><figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_0"><head>Algorithm 2 :</head><label>2</label><figDesc>Compute posterior densitiesInput:N , t 1 , . . . 2n − 2, μ r , σ 2 r , and σ 2 as in Algorithm 1 Vector p, likelihood L and arrays F i computed in Algorithm 1.Output:Arrays H i for each internal node i. Construct the vectors x, w, {L i : i ∈ {n + 1, . . . , 2n − 2}}, {U i : i ∈ {n + 1, . . . , 2n − 2}}, and path lengths p i as in Algorithm 1.G 2n−1 [k] ← 1 for all k.For all i = 2n−2, 2n − 3, . . . , n + 1</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_1"><head></head><label></label><figDesc>FIG.1.-Log-log plots of error as a function of N for the dynamic programming algorithm with Simpson's method (left) and with the Gaussian kernel method (right). The likelihoods were computed under the threshold model on EFN trait data for an 839 taxon tree. Dotted lines have slope À4 (corresponding to convergence rate of N À4 . Note the difference in scale for the two methods.). Logarithms computed to base 10. Letting h be the height of the tree, the circles in both plots represent errors when s 2 r ¼ h, the asterisks represent errors when s 2 r ¼ 0:1h, and the triangles represent errors when s 2 r ¼ 10h.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_2"><head></head><label></label><figDesc>of log-likelihood values as a function of log ðNÞ for the two types of data simulated from the fixed EFN tree, computed using our algorithm together with the Gaussian kernel method. Logarithms computed to base 10.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_3"><head></head><label></label><figDesc>-Marginal posterior probabilities for the liabilities, for EFN trait 1 of<ref type="bibr" target="#b27">Marazzi et al. (2012)</ref> on the phylogeny inferred by</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_0"><head>Algorithm 1 :</head><label>1</label><figDesc>Compute probability of a threshold character.</figDesc><table><row><cell>Input:</cell></row><row><cell>N : Number of intervals in numerical integration.</cell></row><row><cell>t 1 , . . . , t 2n−2 : branch lengths in tree. μ r , σ 2 r : mean and variance of root density σ 2 : variance of transition densities (per unit branch length)</cell></row><row><cell>z 1 , . . . , z n observed character (z i ∈ {+1, 0, ?})</cell></row><row><cell>Output:</cell></row><row><cell>Probability L of observed character under the threshold model.</cell></row><row><cell>Construct the vector x = [0, 1, 2, . . . , N]/N .</cell></row><row><cell>Construct the vector w = [1, 4, 2, 4, 2, . . . , 4, 2, 1] as in (??)</cell></row><row><cell>Compute the path length p i from the root to each node i.</cell></row><row><cell>Initialize F i [k] ← 1 for all nodes i and 0 ≤ k ≤ N .</cell></row><row><cell>For all</cell></row></table><note></note></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_2"><head>Table 1</head><label>1</label><figDesc>Table of Log-Likelihood and AIC Values for the Binary Character, Precursor, and Threshold Models on Six EFN Traits NOTE.-Column k indicates numbers of parameters for each model. Data for the binary and precursor models copied from table 1 in</figDesc><table><row><cell>Trait</cell><cell>Model</cell><cell>k</cell><cell>log L</cell><cell>AIC</cell></row><row><cell>1 (All)</cell><cell>Binary</cell><cell>2</cell><cell>À251.7</cell><cell>507.4</cell></row><row><cell></cell><cell>Precursor</cell><cell>1</cell><cell>À246.7</cell><cell>495.4</cell></row><row><cell></cell><cell>Threshold</cell><cell>1</cell><cell>À240.6</cell><cell>483.2</cell></row><row><cell>2 (Leaves)</cell><cell>Binary</cell><cell>2</cell><cell>À240.3</cell><cell>484.6</cell></row><row><cell></cell><cell>Precursor</cell><cell>1</cell><cell>À234.5</cell><cell>470.9</cell></row><row><cell></cell><cell>Threshold</cell><cell>1</cell><cell>À230.6</cell><cell>463.1</cell></row><row><cell>3 (Inflorescence)</cell><cell>Binary</cell><cell>2</cell><cell>À108.3</cell><cell>220.5</cell></row><row><cell></cell><cell>Precursor</cell><cell>1</cell><cell>À110.9</cell><cell>223.9</cell></row><row><cell></cell><cell>Threshold</cell><cell>1</cell><cell>À108.3</cell><cell>218.5</cell></row><row><cell>4 (Trichomes)</cell><cell>Binary</cell><cell>2</cell><cell>À86.7</cell><cell>177.3</cell></row><row><cell></cell><cell>Precursor</cell><cell>1</cell><cell>À86.9</cell><cell>175.9</cell></row><row><cell></cell><cell>Threshold</cell><cell>1</cell><cell>À85.8</cell><cell>173.5</cell></row><row><cell>5 (Substitutive)</cell><cell>Binary</cell><cell>2</cell><cell>À163.0</cell><cell>330.1</cell></row><row><cell></cell><cell>Precursor</cell><cell>1</cell><cell>À161.6</cell><cell>325.3</cell></row><row><cell></cell><cell>Threshold</cell><cell>1</cell><cell>À161.3</cell><cell>324.6</cell></row><row><cell>6 (True)</cell><cell>Binary</cell><cell>2</cell><cell>À132.3.1</cell><cell>268.7</cell></row><row><cell></cell><cell>Precursor</cell><cell>1</cell><cell>À131.1</cell><cell>264.3</cell></row><row><cell></cell><cell>Precursor</cell><cell>2</cell><cell>À126.7</cell><cell>257.3</cell></row><row><cell></cell><cell>Threshold</cell><cell>1</cell><cell>À125.3</cell><cell>252.6</cell></row></table><note></note></figure>
			<note xmlns="http://www.tei-c.org/ns/1.0" place="foot" n="1350">Genome Biol. Evol. 8(5):1338-1350. doi:10.1093/gbe/evw064 Advance Access publication April 6, 2016</note>
		</body>
		<back>

			<div type="acknowledgement">
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Acknowledgments</head><p>This research was supported by an Allan Wilson Centre Doctoral Scholarship to G.H., financial support to D.B. from the Allan Wilson Centre, a Marsden grant to D.B., and financial support to all authors from the University of Otago.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Literature Cited</head></div>
			</div>

			<div type="references">

				<listBibl>

<biblStruct xml:id="b0">
	<analytic>
		<title level="a" type="main">Inferring Species Trees Directly from Biallelic Genetic Markers: Bypassing Gene Trees in a Full Coalescent Analysis</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">David</forename><surname>Bryant</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Remco</forename><surname>Bouckaert</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Joseph</forename><surname>Felsenstein</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Noah</forename><forename type="middle">A</forename><surname>Rosenberg</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Arindam</forename><surname>Roychoudhury</surname></persName>
		</author>
		<idno type="DOI">10.1093/molbev/mss086</idno>
		<idno type="PMID">22422763</idno>
		<idno type="PMCID">PMC3408069</idno>
		<ptr type="open-access" target="https://academic.oup.com/mbe/article-pdf/29/8/1917/13648231/mss086.pdf" />
	</analytic>
	<monogr>
		<title level="j">Molecular Biology and Evolution</title>
		<idno type="ISSN">0737-4038</idno>
		<idno type="ISSNe">1537-1719</idno>
		<imprint>
			<biblScope unit="volume">29</biblScope>
			<biblScope unit="issue">8</biblScope>
			<biblScope unit="page" from="1917" to="1932" />
			<date type="published" when="2012-03-14" />
			<publisher>Oxford University Press (OUP)</publisher>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b1">
	<analytic>
		<title level="a" type="main">Phylogenetic Analysis: Models and Estimation Procedures</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">L</forename><forename type="middle">L</forename><surname>Cavalli-Sforza</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">A</forename><forename type="middle">W F</forename><surname>Edwards</surname></persName>
		</author>
		<idno type="DOI">10.2307/2406616</idno>
		<idno type="PMID">28563688</idno>
		<ptr type="open-access" target="http://europepmc.org/articles/pmc1706274?pdf=render" />
	</analytic>
	<monogr>
		<title level="j">Evolution</title>
		<title level="j" type="abbrev">Evolution</title>
		<idno type="ISSN">0014-3820</idno>
		<imprint>
			<biblScope unit="volume">21</biblScope>
			<biblScope unit="issue">3</biblScope>
			<biblScope unit="page">550</biblScope>
			<date type="published" when="1967-09" />
			<publisher>JSTOR</publisher>
		</imprint>
	</monogr>
	<note>Pt 1</note>
</biblStruct>

<biblStruct xml:id="b2">
	<monogr>
		<title level="m" type="main">Numerical mathematics and computing</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">E</forename><surname>Cheney</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">D</forename><surname>Kincaid</surname></persName>
		</author>
		<imprint>
			<date type="published" when="2012" />
			<publisher>Cengage Learning</publisher>
			<pubPlace>Boston (MA</pubPlace>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b3">
	<analytic>
		<title level="a" type="main">Numerical Methods in Scientific Computing, Volume I</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Germund</forename><surname>Dahlquist</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Åke</forename><surname>Björck</surname></persName>
		</author>
		<idno type="DOI">10.1137/1.9780898717785</idno>
	</analytic>
	<monogr>
		<title level="j">Numerical Integration. chap. 5 in Numerical Methods in Scientific Computing</title>
		<imprint>
			<biblScope unit="volume">1</biblScope>
			<date type="published" when="2008-01" />
			<publisher>Society for Industrial and Applied Mathematics</publisher>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b4">
	<analytic>
		<title level="a" type="main">Numerical Integration</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Philip</forename><forename type="middle">J</forename><surname>Davis</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Philip</forename><surname>Rabinowitz</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Jacques</forename><forename type="middle">E</forename><surname>Romain</surname></persName>
		</author>
		<idno type="DOI">10.1063/1.3034795</idno>
	</analytic>
	<monogr>
		<title level="j">Physics Today</title>
		<title level="j" type="abbrev">Physics Today</title>
		<idno type="ISSN">0031-9228</idno>
		<idno type="ISSNe">1945-0699</idno>
		<imprint>
			<biblScope unit="volume">21</biblScope>
			<biblScope unit="issue">2</biblScope>
			<biblScope unit="page" from="91" to="91" />
			<date type="published" when="1968-02" />
			<publisher>AIP Publishing</publisher>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b5">
	<analytic>
		<title level="a" type="main">Statistical Inference of Phylogenies</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Joseph</forename><surname>Felsenstein</surname></persName>
		</author>
		<idno type="DOI">10.2307/2981654</idno>
	</analytic>
	<monogr>
		<title level="j">Journal of the Royal Statistical Society. Series A (General)</title>
		<title level="j" type="abbrev">Journal of the Royal Statistical Society. Series A (General)</title>
		<idno type="ISSN">0035-9238</idno>
		<imprint>
			<biblScope unit="volume">146</biblScope>
			<biblScope unit="issue">3</biblScope>
			<biblScope unit="page">246</biblScope>
			<date type="published" when="1983" />
			<publisher>JSTOR</publisher>
		</imprint>
		<respStmt>
			<orgName>Department of Zoology, University of Chicago</orgName>
		</respStmt>
	</monogr>
	<note type="report_type">Ph.D. Thesis</note>
</biblStruct>

<biblStruct xml:id="b6">
	<analytic>
		<title level="a" type="main">Maximum Likelihood and Minimum-Steps Methods for Estimating Evolutionary Trees from Data on Discrete Characters</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">J</forename><surname>Felsenstein</surname></persName>
		</author>
		<idno type="DOI">10.1093/sysbio/22.3.240</idno>
		<idno type="ark">ark:/67375/HXZ-0FGPW155-6</idno>
		<idno type="istexId">A7B26720F597C2184718CB37BAC7B0D159687612</idno>
	</analytic>
	<monogr>
		<title level="j">Systematic Biology</title>
		<title level="j" type="abbrev">Systematic Biology</title>
		<idno type="ISSN">1063-5157</idno>
		<idno type="ISSNe">1076-836X</idno>
		<imprint>
			<biblScope unit="volume">22</biblScope>
			<biblScope unit="issue">3</biblScope>
			<biblScope unit="page" from="240" to="249" />
			<date type="published" when="1973-09-01" />
			<publisher>Oxford University Press (OUP)</publisher>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b7">
	<analytic>
		<title level="a" type="main">Evolutionary trees from DNA sequences: A maximum likelihood approach</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Joseph</forename><surname>Felsenstein</surname></persName>
		</author>
		<idno type="DOI">10.1007/bf01734359</idno>
		<idno type="PMID">7288891</idno>
		<idno type="ark">ark:/67375/1BB-PGJPW6D4-S</idno>
		<idno type="istexId">02F2F2C8F23C7B29FAF421BDA273D7D8495EE41F</idno>
	</analytic>
	<monogr>
		<title level="j">Journal of Molecular Evolution</title>
		<title level="j" type="abbrev">J Mol Evol</title>
		<idno type="ISSN">0022-2844</idno>
		<idno type="ISSNe">1432-1432</idno>
		<imprint>
			<biblScope unit="volume">17</biblScope>
			<biblScope unit="issue">6</biblScope>
			<biblScope unit="page" from="368" to="376" />
			<date type="published" when="1981-11" />
			<publisher>Springer Nature</publisher>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b8">
	<analytic>
		<title level="a" type="main">EVOLUTIONARY TREES FROM GENE FREQUENCIES AND QUANTITATIVE CHARACTERS: FINDING MAXIMUM LIKELIHOOD ESTIMATES</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Joseph</forename><surname>Felsenstein</surname></persName>
		</author>
		<idno type="DOI">10.1111/j.1558-5646.1981.tb04991.x</idno>
		<idno type="PMID">28563384</idno>
	</analytic>
	<monogr>
		<title level="j">Evolution</title>
		<title level="j" type="abbrev">Evolution</title>
		<idno type="ISSN">0014-3820</idno>
		<imprint>
			<biblScope unit="volume">35</biblScope>
			<biblScope unit="issue">6</biblScope>
			<biblScope unit="page" from="1229" to="1242" />
			<date type="published" when="1981-11" />
			<publisher>Wiley</publisher>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b9">
	<analytic>
		<title level="a" type="main">Phylogenies and Quantitative Characters</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">J</forename><surname>Felsenstein</surname></persName>
		</author>
		<idno type="DOI">10.1146/annurev.es.19.110188.002305</idno>
	</analytic>
	<monogr>
		<title level="j">Annual Review of Ecology and Systematics</title>
		<title level="j" type="abbrev">Annu. Rev. Ecol. Syst.</title>
		<idno type="ISSN">0066-4162</idno>
		<imprint>
			<biblScope unit="volume">19</biblScope>
			<biblScope unit="issue">1</biblScope>
			<biblScope unit="page" from="445" to="471" />
			<date type="published" when="1988-11" />
			<publisher>Annual Reviews</publisher>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b10">
	<analytic>
		<title level="a" type="main">Quantitative characters, phylogenies, and morphometrics</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Joseph</forename><surname>Felsenstein</surname></persName>
		</author>
		<idno type="DOI">10.1201/9780203165171.ch3</idno>
	</analytic>
	<monogr>
		<title level="m">Systematics Association Special Volumes</title>
		<editor>Macleod N., editor. Morphology, Shape and Phylogeny. London: Taylor and Francis</editor>
		<imprint>
			<publisher>CRC Press</publisher>
			<date type="published" when="2002-02-07" />
			<biblScope unit="page" from="27" to="44" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b11">
	<analytic>
		<title level="a" type="main">Using the quantitative genetic threshold model for inferences between and within species</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">J</forename><surname>Felsenstein</surname></persName>
		</author>
		<idno type="DOI">10.1098/rstb.2005.1669</idno>
		<idno type="PMID">16048785</idno>
		<idno type="PMCID">PMC1569509</idno>
		<ptr type="open-access" target="http://europepmc.org/articles/pmc1569509?pdf=render" />
	</analytic>
	<monogr>
		<title level="j">Philosophical Transactions of the Royal Society B: Biological Sciences</title>
		<title level="j" type="abbrev">Philosophical Transactions of the Royal Society B: Biological Sciences</title>
		<idno type="ISSN">0962-8436</idno>
		<idno type="ISSNe">1471-2970</idno>
		<imprint>
			<biblScope unit="volume">360</biblScope>
			<biblScope unit="issue">1459</biblScope>
			<biblScope unit="page" from="1427" to="1434" />
			<date type="published" when="2005-07-29" />
			<publisher>The Royal Society</publisher>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b12">
	<analytic>
		<title level="a" type="main">A Comparative Method for Both Discrete and Continuous Characters Using the Threshold Model</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Joseph</forename><surname>Felsenstein</surname></persName>
		</author>
		<idno type="DOI">10.1086/663681</idno>
		<idno type="PMID">22218305</idno>
		<ptr type="open-access" target="http://pdfs.semanticscholar.org/23dd/d9c56c5fc3e18b7786306762bef092e54a68.pdf" />
	</analytic>
	<monogr>
		<title level="j">The American Naturalist</title>
		<title level="j" type="abbrev">The American Naturalist</title>
		<idno type="ISSN">0003-0147</idno>
		<idno type="ISSNe">1537-5323</idno>
		<imprint>
			<biblScope unit="volume">179</biblScope>
			<biblScope unit="issue">2</biblScope>
			<biblScope unit="page" from="145" to="156" />
			<date type="published" when="2012-02" />
			<publisher>University of Chicago Press</publisher>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b13">
	<analytic>
		<title level="a" type="main">A Hidden Markov Model approach to variation among sites in rate of evolution</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">J</forename><surname>Felsenstein</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">G</forename><forename type="middle">A</forename><surname>Churchill</surname></persName>
		</author>
		<idno type="DOI">10.1093/oxfordjournals.molbev.a025575</idno>
		<idno type="PMID">8583911</idno>
		<ptr type="open-access" target="https://academic.oup.com/mbe/article-pdf/13/1/93/11168269/10fels.pdf" />
	</analytic>
	<monogr>
		<title level="j">Molecular Biology and Evolution</title>
		<title level="j" type="abbrev">Molecular Biology and Evolution</title>
		<idno type="ISSN">0737-4038</idno>
		<idno type="ISSNe">1537-1719</idno>
		<imprint>
			<biblScope unit="volume">13</biblScope>
			<biblScope unit="issue">1</biblScope>
			<biblScope unit="page" from="93" to="104" />
			<date type="published" when="1996-01-01" />
			<publisher>Oxford University Press (OUP)</publisher>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b14">
	<analytic>
		<title level="a" type="main">Diversitree: comparative phylogenetic analyses of diversification in R</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Richard</forename><forename type="middle">G</forename><surname>Fitzjohn</surname></persName>
		</author>
		<idno type="DOI">10.1111/j.2041-210x.2012.00234.x</idno>
	</analytic>
	<monogr>
		<title level="j">Methods in Ecology and Evolution</title>
		<title level="j" type="abbrev">Methods Ecol Evol</title>
		<idno type="ISSN">2041-210X</idno>
		<imprint>
			<biblScope unit="volume">3</biblScope>
			<biblScope unit="issue">6</biblScope>
			<biblScope unit="page" from="1084" to="1092" />
			<date type="published" when="2012-08-06" />
			<publisher>Wiley</publisher>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b15">
	<analytic>
		<title level="a" type="main">Fast likelihood calculations for comparative analyses</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Robert</forename><forename type="middle">P</forename><surname>Freckleton</surname></persName>
		</author>
		<idno type="DOI">10.1111/j.2041-210x.2012.00220.x</idno>
	</analytic>
	<monogr>
		<title level="j">Methods in Ecology and Evolution</title>
		<idno type="ISSN">2041-210X</idno>
		<imprint>
			<biblScope unit="volume">3</biblScope>
			<biblScope unit="issue">5</biblScope>
			<biblScope unit="page" from="940" to="947" />
			<date type="published" when="2012-07-11" />
			<publisher>Wiley</publisher>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b16">
	<analytic>
		<title level="a" type="main">Stabilizing Selection and the Comparative Analysis of Adaptation</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Thomas</forename><forename type="middle">F</forename><surname>Hansen</surname></persName>
		</author>
		<idno type="DOI">10.2307/2411186</idno>
		<idno type="PMID">28568616</idno>
	</analytic>
	<monogr>
		<title level="j">Evolution</title>
		<title level="j" type="abbrev">Evolution</title>
		<idno type="ISSN">0014-3820</idno>
		<imprint>
			<biblScope unit="volume">51</biblScope>
			<biblScope unit="issue">5</biblScope>
			<biblScope unit="page">1341</biblScope>
			<date type="published" when="1997-10" />
			<publisher>JSTOR</publisher>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b17">
	<analytic>
		<title level="a" type="main">EARLY BURSTS OF BODY SIZE AND SHAPE EVOLUTION ARE RARE IN COMPARATIVE DATA</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Luke</forename><forename type="middle">J</forename><surname>Harmon</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Jonathan</forename><forename type="middle">B</forename><surname>Losos</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">T</forename><surname>Jonathan Davies</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Rosemary</forename><forename type="middle">G</forename><surname>Gillespie</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">John</forename><forename type="middle">L</forename><surname>Gittleman</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">W</forename><surname>Bryan Jennings</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Kenneth</forename><forename type="middle">H</forename><surname>Kozak</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Mark</forename><forename type="middle">A</forename><surname>Mcpeek</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Franck</forename><surname>Moreno-Roark</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Thomas</forename><forename type="middle">J</forename><surname>Near</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Andy</forename><surname>Purvis</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Robert</forename><forename type="middle">E</forename><surname>Ricklefs</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Dolph</forename><surname>Schluter</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">James</forename><forename type="middle">A</forename><surname>Schulte Ii</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Ole</forename><surname>Seehausen</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Brian</forename><forename type="middle">L</forename><surname>Sidlauskas</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Omar</forename><surname>Torres-Carvajal</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Jason</forename><forename type="middle">T</forename><surname>Weir</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Arne</forename><forename type="middle">Ø</forename><surname>Mooers</surname></persName>
		</author>
		<idno type="DOI">10.1111/j.1558-5646.2010.01025.x</idno>
		<idno type="PMID">20455932</idno>
		<idno type="ark">ark:/67375/WNG-5BQTJ4H7-G</idno>
		<idno type="istexId">0311A62ADA317B8F910B1C37DA8B1E101A2A4768</idno>
	</analytic>
	<monogr>
		<title level="j">Evolution</title>
		<idno type="ISSN">0014-3820</idno>
		<idno type="ISSNe">1558-5646</idno>
		<imprint>
			<biblScope unit="volume">64</biblScope>
			<biblScope unit="issue">8</biblScope>
			<biblScope unit="page" from="no" to="no" />
			<date type="published" when="2010-04-29" />
			<publisher>Wiley</publisher>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b18">
	<analytic>
		<title level="a" type="main">A linear-time algorithm for Gaussian and non-Gaussian trait evolution models</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">L</forename><surname>Ho</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">C</forename><surname>Ané</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Syst Biol</title>
		<imprint>
			<biblScope unit="volume">63</biblScope>
			<biblScope unit="issue">3</biblScope>
			<biblScope unit="page">397</biblScope>
			<date type="published" when="2014" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b19">
	<analytic>
		<title level="a" type="main">Evolution of primate gene expression</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Philipp</forename><surname>Khaitovich</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Wolfgang</forename><surname>Enard</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Michael</forename><surname>Lachmann</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Svante</forename><surname>Pääbo</surname></persName>
		</author>
		<idno type="DOI">10.1038/nrg1940</idno>
		<idno type="PMID">16921347</idno>
	</analytic>
	<monogr>
		<title level="j">Nature Reviews Genetics</title>
		<title level="j" type="abbrev">Nat Rev Genet</title>
		<idno type="ISSN">1471-0056</idno>
		<idno type="ISSNe">1471-0064</idno>
		<imprint>
			<biblScope unit="volume">7</biblScope>
			<biblScope unit="issue">9</biblScope>
			<biblScope unit="page" from="693" to="702" />
			<date type="published" when="2006-09" />
			<publisher>Springer Nature</publisher>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b20">
	<analytic>
		<title level="a" type="main">Toward a Neutral Evolutionary Model of Gene Expression</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Philipp</forename><surname>Khaitovich</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Svante</forename><surname>Pääbo</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Gunter</forename><surname>Weiss</surname></persName>
		</author>
		<idno type="DOI">10.1534/genetics.104.037135</idno>
		<idno type="PMID">15834146</idno>
		<idno type="PMCID">PMC1450413</idno>
		<ptr type="open-access" target="http://www.genetics.org/content/genetics/170/2/929.full.pdf" />
	</analytic>
	<monogr>
		<title level="j">Genetics</title>
		<title level="j" type="abbrev">Genetics</title>
		<idno type="ISSN">0016-6731</idno>
		<idno type="ISSNe">1943-2631</idno>
		<imprint>
			<biblScope unit="volume">170</biblScope>
			<biblScope unit="issue">2</biblScope>
			<biblScope unit="page" from="929" to="939" />
			<date type="published" when="2005-04-16" />
			<publisher>Genetics Society of America</publisher>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b21">
	<analytic>
		<title level="a" type="main">SIMULATION-BASED LIKELIHOOD APPROACH FOR EVOLUTIONARY MODELS OF PHENOTYPIC TRAITS ON PHYLOGENY</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Nobuyuki</forename><surname>Kutsukake</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Hideki</forename><surname>Innan</surname></persName>
		</author>
		<idno type="DOI">10.1111/j.1558-5646.2012.01775.x</idno>
		<idno type="PMID">23356609</idno>
		<idno type="ark">ark:/67375/WNG-76V0J28W-F</idno>
		<idno type="istexId">4D9E051490AE97AF9F0BD08EDE21350619CB35D7</idno>
	</analytic>
	<monogr>
		<title level="j">Evolution</title>
		<idno type="ISSN">0014-3820</idno>
		<imprint>
			<biblScope unit="volume">67</biblScope>
			<biblScope unit="issue">2</biblScope>
			<biblScope unit="page" from="355" to="367" />
			<date type="published" when="2012-09-17" />
			<publisher>Wiley</publisher>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b22">
	<analytic>
		<title level="a" type="main">Natural Selection and Random Genetic Drift in Phenotypic Evolution</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Russell</forename><surname>Lande</surname></persName>
		</author>
		<idno type="DOI">10.2307/2407703</idno>
		<idno type="PMID">28563044</idno>
	</analytic>
	<monogr>
		<title level="j">Evolution</title>
		<title level="j" type="abbrev">Evolution</title>
		<idno type="ISSN">0014-3820</idno>
		<imprint>
			<biblScope unit="volume">30</biblScope>
			<biblScope unit="issue">2</biblScope>
			<biblScope unit="page">314</biblScope>
			<date type="published" when="1976-06" />
			<publisher>JSTOR</publisher>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b23">
	<analytic>
		<title level="a" type="main">Phylogenetic Analysis Using Lévy Processes: Finding Jumps in the Evolution of Continuous Traits</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Michael</forename><forename type="middle">J</forename><surname>Landis</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Joshua</forename><forename type="middle">G</forename><surname>Schraiber</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Mason</forename><surname>Liang</surname></persName>
		</author>
		<idno type="DOI">10.1093/sysbio/sys086</idno>
		<idno type="PMID">23034385</idno>
		<idno type="PMCID">PMC3566600</idno>
		<ptr type="open-access" target="https://academic.oup.com/sysbio/article-pdf/62/2/193/24577540/sys086.pdf" />
	</analytic>
	<monogr>
		<title level="j">Systematic Biology</title>
		<idno type="ISSN">1063-5157</idno>
		<idno type="ISSNe">1076-836X</idno>
		<imprint>
			<biblScope unit="volume">62</biblScope>
			<biblScope unit="issue">2</biblScope>
			<biblScope unit="page" from="193" to="204" />
			<date type="published" when="2012-12-03" />
			<publisher>Oxford University Press (OUP)</publisher>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b24">
	<monogr>
		<title level="m" type="main">Faster likelihood calculations on trees</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">B</forename><surname>Larget</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">D</forename><surname>Simon</surname></persName>
		</author>
		<idno>98-02</idno>
		<imprint>
			<date type="published" when="1998" />
			<pubPlace>Pittsburgh, Pa</pubPlace>
		</imprint>
		<respStmt>
			<orgName>Department of Mathematics and Computer Science, Duquesne University</orgName>
		</respStmt>
	</monogr>
	<note type="report_type">Technical Report</note>
</biblStruct>

<biblStruct xml:id="b25">
	<analytic>
		<title level="a" type="main">Phylogeography Takes a Relaxed Random Walk in Continuous Space and Time</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">P</forename><surname>Lemey</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">A</forename><surname>Rambaut</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">J</forename><forename type="middle">J</forename><surname>Welch</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">M</forename><forename type="middle">A</forename><surname>Suchard</surname></persName>
		</author>
		<idno type="DOI">10.1093/molbev/msq067</idno>
		<idno type="PMID">20203288</idno>
		<idno type="PMCID">PMC2915639</idno>
		<ptr type="open-access" target="https://academic.oup.com/mbe/article-pdf/27/8/1877/13643480/msq067.pdf" />
	</analytic>
	<monogr>
		<title level="j">Molecular Biology and Evolution</title>
		<title level="j" type="abbrev">Molecular Biology and Evolution</title>
		<idno type="ISSN">0737-4038</idno>
		<idno type="ISSNe">1537-1719</idno>
		<imprint>
			<biblScope unit="volume">27</biblScope>
			<biblScope unit="issue">8</biblScope>
			<biblScope unit="page" from="1877" to="1885" />
			<date type="published" when="2010-03-04" />
			<publisher>Oxford University Press (OUP)</publisher>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b26">
	<analytic>
		<title level="a" type="main">Continuous and tractable models for the variation of evolutionary rates</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Thomas</forename><surname>Lepage</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Stephan</forename><surname>Lawi</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Paul</forename><surname>Tupper</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">David</forename><surname>Bryant</surname></persName>
		</author>
		<idno type="DOI">10.1016/j.mbs.2005.11.002</idno>
		<idno type="PMID">16406009</idno>
		<ptr type="open-access" target="http://arxiv.org/pdf/math/0506145" />
	</analytic>
	<monogr>
		<title level="j">Mathematical Biosciences</title>
		<title level="j" type="abbrev">Mathematical Biosciences</title>
		<idno type="ISSN">0025-5564</idno>
		<imprint>
			<biblScope unit="volume">199</biblScope>
			<biblScope unit="issue">2</biblScope>
			<biblScope unit="page" from="216" to="233" />
			<date type="published" when="2006-02" />
			<publisher>Elsevier BV</publisher>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b27">
	<analytic>
		<title level="a" type="main">LOCATING EVOLUTIONARY PRECURSORS ON A PHYLOGENETIC TREE</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Brigitte</forename><surname>Marazzi</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Cécile</forename><surname>Ané</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Marcelo</forename><forename type="middle">F</forename><surname>Simon</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Alfonso</forename><surname>Delgado-Salinas</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Melissa</forename><surname>Luckow</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Michael</forename><forename type="middle">J</forename><surname>Sanderson</surname></persName>
		</author>
		<idno type="DOI">10.1111/j.1558-5646.2012.01720.x</idno>
		<idno type="PMID">23206146</idno>
		<idno type="ark">ark:/67375/WNG-XX8M63FG-R</idno>
		<idno type="istexId">055C2C16DDC767BF312ECEE6713FCC663B03B0F1</idno>
	</analytic>
	<monogr>
		<title level="j">Evolution</title>
		<idno type="ISSN">0014-3820</idno>
		<imprint>
			<biblScope unit="volume">66</biblScope>
			<biblScope unit="issue">12</biblScope>
			<biblScope unit="page" from="3918" to="3930" />
			<date type="published" when="2012-08-06" />
			<publisher>Wiley</publisher>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b28">
	<analytic>
		<title level="a" type="main">Evolutionary Inferences from Phylogenies: A Review of Methods</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Brian</forename><forename type="middle">C</forename><surname>O'meara</surname></persName>
		</author>
		<idno type="DOI">10.1146/annurev-ecolsys-110411-160331</idno>
	</analytic>
	<monogr>
		<title level="j">Annual Review of Ecology, Evolution, and Systematics</title>
		<title level="j" type="abbrev">Annu. Rev. Ecol. Evol. Syst.</title>
		<idno type="ISSN">1543-592X</idno>
		<idno type="ISSNe">1545-2069</idno>
		<imprint>
			<biblScope unit="volume">43</biblScope>
			<biblScope unit="issue">1</biblScope>
			<biblScope unit="page" from="267" to="285" />
			<date type="published" when="2012-12" />
			<publisher>Annual Reviews</publisher>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b29">
	<analytic>
		<title level="a" type="main">Column Sorting: Rapid Calculation of the Phylogenetic Likelihood Function</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Sergei</forename><forename type="middle">L Kosakovsky</forename><surname>Pond</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Spencer</forename><forename type="middle">V</forename><surname>Muse</surname></persName>
		</author>
		<idno type="DOI">10.1080/10635150490522269</idno>
		<idno type="PMID">15545249</idno>
		<idno type="ark">ark:/67375/HXZ-1PBXLN8W-P</idno>
		<idno type="istexId">4FF772E60DB7396FD2947FE1B0385071D503F4EA</idno>
		<ptr type="open-access" target="https://academic.oup.com/sysbio/article-pdf/53/5/685/24197229/53-5-685.pdf" />
	</analytic>
	<monogr>
		<title level="j">Systematic Biology</title>
		<idno type="ISSN">1063-5157</idno>
		<idno type="ISSNe">1076-836X</idno>
		<imprint>
			<biblScope unit="volume">53</biblScope>
			<biblScope unit="issue">5</biblScope>
			<biblScope unit="page" from="685" to="692" />
			<date type="published" when="2004-10-01" />
			<publisher>Oxford University Press (OUP)</publisher>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b30">
	<analytic>
		<title level="a" type="main">Bayesian inference of character evolution</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">F</forename><surname>Ronquist</surname></persName>
		</author>
		<idno type="DOI">10.1016/j.tree.2004.07.002</idno>
		<idno type="PMID">16701310</idno>
	</analytic>
	<monogr>
		<title level="j">Trends in Ecology &amp; Evolution</title>
		<title level="j" type="abbrev">Trends in Ecology &amp; Evolution</title>
		<idno type="ISSN">0169-5347</idno>
		<imprint>
			<biblScope unit="volume">19</biblScope>
			<biblScope unit="issue">9</biblScope>
			<biblScope unit="page" from="475" to="481" />
			<date type="published" when="2004-09" />
			<publisher>Elsevier BV</publisher>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b31">
	<analytic>
		<title level="a" type="main">Recent assembly of the Cerrado, a neotropical plant diversity hotspot, by in situ evolution of adaptations to fire</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">M</forename><forename type="middle">F</forename><surname>Simon</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">R</forename><surname>Grether</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">L</forename><forename type="middle">P</forename><surname>De Queiroz</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">C</forename><surname>Skema</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">R</forename><forename type="middle">T</forename><surname>Pennington</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">C</forename><forename type="middle">E</forename><surname>Hughes</surname></persName>
		</author>
		<idno type="DOI">10.1073/pnas.0903410106</idno>
		<idno type="PMID">19918050</idno>
		<idno type="PMCID">PMC2787167</idno>
		<ptr type="open-access" target="http://www.pnas.org/content/106/48/20359.full.pdf" />
	</analytic>
	<monogr>
		<title level="j">Proceedings of the National Academy of Sciences</title>
		<title level="j" type="abbrev">Proceedings of the National Academy of Sciences</title>
		<idno type="ISSN">0027-8424</idno>
		<idno type="ISSNe">1091-6490</idno>
		<imprint>
			<biblScope unit="volume">106</biblScope>
			<biblScope unit="issue">48</biblScope>
			<biblScope unit="page" from="20359" to="20364" />
			<date type="published" when="2009-11-16" />
			<publisher>Proceedings of the National Academy of Sciences</publisher>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b32">
	<analytic>
		<title level="a" type="main">Reconstructing Population Histories from Single Nucleotide Polymorphism Data</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">J</forename><surname>Siren</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">P</forename><surname>Marttinen</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">J</forename><surname>Corander</surname></persName>
		</author>
		<idno type="DOI">10.1093/molbev/msq236</idno>
		<idno type="PMID">20819907</idno>
		<ptr type="open-access" target="https://academic.oup.com/mbe/article-pdf/28/1/673/13649128/msq236.pdf" />
	</analytic>
	<monogr>
		<title level="j">Molecular Biology and Evolution</title>
		<title level="j" type="abbrev">Molecular Biology and Evolution</title>
		<idno type="ISSN">0737-4038</idno>
		<idno type="ISSNe">1537-1719</idno>
		<imprint>
			<biblScope unit="volume">28</biblScope>
			<biblScope unit="issue">1</biblScope>
			<biblScope unit="page" from="673" to="683" />
			<date type="published" when="2010-09-06" />
			<publisher>Oxford University Press (OUP)</publisher>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b33">
	<analytic>
		<title level="a" type="main">RAxML-VI-HPC: maximum likelihood-based phylogenetic analyses with thousands of taxa and mixed models</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Alexandros</forename><surname>Stamatakis</surname></persName>
		</author>
		<idno type="DOI">10.1093/bioinformatics/btl446</idno>
		<idno type="PMID">16928733</idno>
		<idno type="ark">ark:/67375/HXZ-WWVKKHSP-0</idno>
		<idno type="istexId">FAAE9BE5F46035908056C736506588810466A101</idno>
		<ptr type="open-access" target="https://academic.oup.com/bioinformatics/article-pdf/22/21/2688/16851699/btl446.pdf" />
	</analytic>
	<monogr>
		<title level="j">Bioinformatics</title>
		<idno type="ISSN">1367-4803</idno>
		<idno type="ISSNe">1460-2059</idno>
		<imprint>
			<biblScope unit="volume">22</biblScope>
			<biblScope unit="issue">21</biblScope>
			<biblScope unit="page" from="2688" to="2690" />
			<date type="published" when="2006-08-23" />
			<publisher>Oxford University Press (OUP)</publisher>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b34">
	<analytic>
		<title level="a" type="main">Character States, Morphological Variation, and Phylogenetic Analysis: A Review</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">P</forename><forename type="middle">F</forename><surname>Stevens</surname></persName>
		</author>
		<idno type="DOI">10.2307/2419343</idno>
	</analytic>
	<monogr>
		<title level="j">Systematic Botany</title>
		<title level="j" type="abbrev">Systematic Botany</title>
		<idno type="ISSN">0363-6445</idno>
		<imprint>
			<biblScope unit="volume">16</biblScope>
			<biblScope unit="issue">3</biblScope>
			<biblScope unit="page">553</biblScope>
			<date type="published" when="1991-07" />
			<publisher>JSTOR</publisher>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b35">
	<monogr>
		<title level="m" type="main">PAUP*; Phylogenetic analysis using parsimony</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">D</forename><forename type="middle">L</forename><surname>Swofford</surname></persName>
		</author>
		<imprint>
			<date type="published" when="2002" />
			<publisher>Sinauer Associates</publisher>
			<pubPlace>Sunderland, Massachusetts</pubPlace>
		</imprint>
	</monogr>
	<note>Version 4.0b</note>
</biblStruct>

<biblStruct xml:id="b36">
	<analytic>
		<title level="a" type="main">Chips and tags suggest plant-environment interactions differ for two alpine Pachycladon species</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Claudia</forename><surname>Voelckel</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Nicole</forename><surname>Gruenheit</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Patrick</forename><surname>Biggs</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Oliver</forename><surname>Deusch</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Peter</forename><surname>Lockhart</surname></persName>
		</author>
		<idno type="DOI">10.1186/1471-2164-13-322</idno>
		<idno type="PMID">22812500</idno>
		<idno type="PMCID">PMC3460751</idno>
		<ptr type="open-access" target="https://bmcgenomics.biomedcentral.com/track/pdf/10.1186/1471-2164-13-322" />
	</analytic>
	<monogr>
		<title level="j">BMC Genomics</title>
		<title level="j" type="abbrev">BMC Genomics</title>
		<idno type="ISSN">1471-2164</idno>
		<imprint>
			<biblScope unit="volume">13</biblScope>
			<biblScope unit="issue">1</biblScope>
			<biblScope unit="page">322</biblScope>
			<date type="published" when="2012" />
			<publisher>Springer Nature</publisher>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b37">
	<analytic>
		<title level="a" type="main">An analysis of variability in number of digits in an inbred strain of Guinea pigs</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">S</forename><surname>Wright</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Genetics</title>
		<imprint>
			<biblScope unit="volume">19</biblScope>
			<biblScope unit="issue">6</biblScope>
			<biblScope unit="page">506</biblScope>
			<date type="published" when="1934" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b38">
	<monogr>
		<title level="m" type="main">Computational Molecular Evolution</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Ziheng</forename><surname>Yang</surname></persName>
		</author>
		<idno type="DOI">10.1093/acprof:oso/9780198567028.001.0001</idno>
		<ptr type="open-access" target="http://pdfs.semanticscholar.org/fd0d/5a31105fe09db112ba7db0b4793bc150064f.pdf" />
		<imprint>
			<date type="published" when="2006-10-05" />
			<publisher>Oxford University Press</publisher>
			<biblScope unit="volume">21</biblScope>
			<pubPlace>Oxford</pubPlace>
		</imprint>
	</monogr>
</biblStruct>

				</listBibl>
			</div>
		</back>
	</text>
</TEI>
