{
    "level": "paragraph",
    "abstract": [
        {
            "text": "In this article, a novel derivative-free (DF) surrogate-based trust region optimization approach is proposed. In the proposed approach, quadratic surrogate models are constructed and successively updated. The generated surrogate model is then optimized instead of the underlined objective function over trust regions. Truncated conjugate gradients are employed to find the optimal point within each trust region. The approach constructs the initial quadratic surrogate model using few data points of order O(n), where n is the number of design variables. The proposed approach adopts weighted least squares fitting for updating the surrogate model instead of interpolation which is commonly used in DF optimization. This makes the approach more suitable for stochastic optimization and for functions subject to numerical error. The weights are assigned to give more emphasis to points close to the current center point. The accuracy and efficiency of the proposed approach are demonstrated by applying it to a set of classical benchmark test problems. It is also employed to find the optimal design of RF cavity linear accelerator with a comparison analysis with a recent optimization technique. \u00aa 2014 Production and hosting by Elsevier B.V. on behalf of Cairo University."
        }
    ],
    "body_text": [
        {
            "section": "Introduction",
            "text": "In general, engineering systems are characterized by some designable parameters and some performance measures. The desired performance of a system (design specifications) is described by specifying bounds on the performance measures of the system which is set by the designer. The conventional system design aims at finding values of the system designable parameters that merely satisfy the design specifications. In general, there will be a multitude of acceptable designs. However, for contemporary engineering design, other criterion (objective function) can be chosen for comparing the different alternative acceptable designs (optimization problem) and for selecting the best one (optimal system design). Naturally, system performance measures and the objective functions are functions of system parameters values and evaluated through system simulations. For intensive CPU engineering systems, the high expense of the required system simulations may obstruct the optimization process."
        },
        {
            "section": "Introduction",
            "text": "In practice, robust optimization methods that utilize the fewest possible number of function evaluations are greatly required [1,2]. Another difficulty is the absence of any gradient information as the required simulations cost in evaluating the gradient information is prohibitive in practice [3]. Attempting to approximate the function gradients using the finite difference approach requires much more function evaluations, which highly increase the computational cost. Another objection in estimating the gradients by finite differencing is that the estimated function values are usually contaminated by some numerical noise due to estimation uncertainty. Hence, gradient-based optimization methods cannot be applied here.",
            "ref_spans": [
                {
                    "type": "bibr",
                    "ref_id": "b0",
                    "start": 126,
                    "text": "[1,",
                    "end": 129
                },
                {
                    "type": "bibr",
                    "ref_id": "b1",
                    "start": 129,
                    "text": "2]",
                    "end": 131
                },
                {
                    "type": "bibr",
                    "ref_id": "b2",
                    "start": 294,
                    "text": "[3]",
                    "end": 297
                }
            ]
        },
        {
            "section": "Introduction",
            "text": "For such optimization problems, only derivative free optimization (DFO) methods can be applicable [1,[4][5][6][7]. Further, the derivative free trust region methods usually handle such problems more efficiently as the trust region framework constitutes one of the most important globally convergent optimization methods, which has the ability to converge to a solution starting from any arbitrary initial point [8]. In addition, these methods use computationally cheap surrogate-based models that can be constructed by using function evaluations at some selected points. These surrogate models may be response surfaces, radial basis method, neural networks, kriging, etc.",
            "ref_spans": [
                {
                    "type": "bibr",
                    "ref_id": "b0",
                    "start": 98,
                    "text": "[1,",
                    "end": 101
                },
                {
                    "type": "bibr",
                    "ref_id": "b3",
                    "start": 101,
                    "text": "[4]",
                    "end": 104
                },
                {
                    "type": "bibr",
                    "ref_id": "b4",
                    "start": 104,
                    "text": "[5]",
                    "end": 107
                },
                {
                    "type": "bibr",
                    "ref_id": "b5",
                    "start": 107,
                    "text": "[6]",
                    "end": 110
                },
                {
                    "type": "bibr",
                    "ref_id": "b6",
                    "start": 110,
                    "text": "[7]",
                    "end": 113
                },
                {
                    "type": "bibr",
                    "ref_id": "b7",
                    "start": 411,
                    "text": "[8]",
                    "end": 414
                }
            ]
        },
        {
            "section": "Introduction",
            "text": "The majority of the existing derivative-free trust region techniques have the following features:"
        },
        {
            "section": "Introduction",
            "text": "They require a relatively large number of function evaluations, O(n 2 ) (where n is the number of system design variables) to construct the initial quadratic model. The quadratic surrogate models are constructed via interpolating the objective function at a constant number of points; when a point is obtained a previous point is dropped. In addition, these algorithms usually ignore the valuable information contained in all previously evaluated expensive function values."
        },
        {
            "section": "Introduction",
            "text": "The work presented in this article introduces a new derivative free trust region approach that neither require nor approximate the gradients of the objective function. It implements a non-derivative optimization method that combine a trust region framework with quadratic fitting surrogates for the objective function [4,5]. The principal operation of the method relies on building, successively updating and optimizing quadratic surrogate models of the objective function over trust regions. The quadratic surrogate models reasonably reflect the local behavior of the objective function in a trust region around the current iterate and they are optimized instead of the objective function over trust regions.",
            "ref_spans": [
                {
                    "type": "bibr",
                    "ref_id": "b3",
                    "start": 318,
                    "text": "[4,",
                    "end": 321
                },
                {
                    "type": "bibr",
                    "ref_id": "b4",
                    "start": 321,
                    "text": "5]",
                    "end": 323
                }
            ]
        },
        {
            "section": "Introduction",
            "text": "Truncated conjugate gradient method by Steihaug [9] is used to find the optimal point within each trust region. The approach constructs the initial quadratic surrogate model using few data points of order O(n). In each iteration of the proposed approach, the surrogate model is updated using a weighted least squares fitting. The weights are assigned to give more emphasis to points close to the current center point. The accuracy and efficiency of the proposed approach are demonstrated by applying it on a set of classical benchmark test problems and comparisons with a recent optimization technique [6] are also included.",
            "ref_spans": [
                {
                    "type": "bibr",
                    "start": 39,
                    "text": "Steihaug [9]",
                    "end": 51
                },
                {
                    "type": "bibr",
                    "ref_id": "b5",
                    "start": 602,
                    "text": "[6]",
                    "end": 605
                }
            ]
        },
        {
            "section": "Introduction",
            "text": "The linear accelerators (LINACS) provide beams of high quality and high energy in which charged particles move on a linear path and are accelerated by electromagnetic fields."
        },
        {
            "section": "Introduction",
            "text": "The modern LINAC typically consists of sections of specially designed waveguides that are excited by RF electromagnetic fields, usually in the very high frequency (VHF) range. The accelerating structures are tuned to resonance and are driven by external, high-power RF power tubes, such as klystrons. The accelerating structures must efficiently transfer the electromagnetic energy to the beam, and this is accomplished through an optimized configuration of the internal geometry, so that the structure can concentrate the electric field along the trajectory of the beam promoting maximal energy transfer, by adding nose cones to create a region of more concentrated axial electric field as shown in Fig. 1. RF cavity analysis and design brought researchers and engineers' attention due to its extensive applications [10][11][12][13][14][15][16][17]. Applications include: medicinal purposes in radiation therapy, food sterilization and transmute nuclear fuel waste, etc. Design tools include: the computer code SUPERFISH [18], 3-D code MAFIA [19] and CST Studio Suite [20].",
            "ref_spans": [
                {
                    "type": "figure",
                    "start": 700,
                    "text": "Fig. 1",
                    "end": 706
                },
                {
                    "type": "bibr",
                    "ref_id": "b9",
                    "start": 817,
                    "text": "[10]",
                    "end": 821
                },
                {
                    "type": "bibr",
                    "ref_id": "b10",
                    "start": 821,
                    "text": "[11]",
                    "end": 825
                },
                {
                    "type": "bibr",
                    "ref_id": "b11",
                    "start": 825,
                    "text": "[12]",
                    "end": 829
                },
                {
                    "type": "bibr",
                    "ref_id": "b12",
                    "start": 829,
                    "text": "[13]",
                    "end": 833
                },
                {
                    "type": "bibr",
                    "ref_id": "b13",
                    "start": 833,
                    "text": "[14]",
                    "end": 837
                },
                {
                    "type": "bibr",
                    "ref_id": "b14",
                    "start": 837,
                    "text": "[15]",
                    "end": 841
                },
                {
                    "type": "bibr",
                    "ref_id": "b15",
                    "start": 841,
                    "text": "[16]",
                    "end": 845
                },
                {
                    "type": "bibr",
                    "ref_id": "b16",
                    "start": 845,
                    "text": "[17]",
                    "end": 849
                },
                {
                    "type": "bibr",
                    "ref_id": "b17",
                    "start": 1022,
                    "text": "[18]",
                    "end": 1026
                },
                {
                    "type": "bibr",
                    "ref_id": "b18",
                    "start": 1043,
                    "text": "[19]",
                    "end": 1047
                },
                {
                    "type": "bibr",
                    "ref_id": "b19",
                    "start": 1069,
                    "text": "[20]",
                    "end": 1073
                }
            ]
        },
        {
            "section": "Introduction",
            "text": "Design of accelerator RF cavities may include optimization of some of cavity parameters. Among the parameters characterizing the operation of the RF cavities are, the average accelerating field Eacc, peak fields to accelerating field (Epk/Eacc, Hpk/Eacc), quality factor, and cavity shunt impedance R-shunt [21]. The parameters considered for optimization depend on the power level fed to the cavity, which limit the average accelerating field, where the constraints on these parameters are imposed by the application. For low power level feed, optimization may focus on maximizing shunt impedance, however for high power operation, limiting the peak fields inside is of concern in order to minimize multipacting [22]. In this work we will focus on the low power fed cavities, where maximizing the shunt impedance is of main concern and will be treated through our new optimization approach.",
            "ref_spans": [
                {
                    "type": "bibr",
                    "ref_id": "b20",
                    "start": 307,
                    "text": "[21]",
                    "end": 311
                },
                {
                    "type": "bibr",
                    "ref_id": "b21",
                    "start": 713,
                    "text": "[22]",
                    "end": 717
                }
            ]
        },
        {
            "section": "Introduction",
            "text": "The new proposed trust region (TR) optimization approach is capable of solving the design problems with either 2D or 3D simulators. It is expected to work as well if a 3D simulator was employed with the expense of more computational time. Most of the accelerators use body of revolution cavity structure which can be solved as 2D structure, saving the computational resources. However, the proposed approach was successfully employed in microwave filter design utilizing 3D full-wave EM solver [23].",
            "ref_spans": [
                {
                    "type": "bibr",
                    "ref_id": "b22",
                    "start": 494,
                    "text": "[23]",
                    "end": 498
                }
            ]
        },
        {
            "section": "The new trust region approach",
            "text": "The computationally expensive objective function is locally approximated around a current iterate x k by a computationally cheaper quadratic surrogate model M(x) which can be placed in the form: Fig. 1 Cross section of the cavity with nose cones and spherical outer walls.",
            "ref_spans": [
                {
                    "type": "figure",
                    "start": 195,
                    "text": "Fig. 1",
                    "end": 201
                }
            ]
        },
        {
            "section": "The new trust region approach",
            "text": "where a 2 R, the vector b 2 R n , and the symmetric matrix B 2 R n\u00c2n are the unknown parameters of M(x). The total number of the model parameters is q = (n + 1)(n + 2)/2. These parameters can be evaluated by interpolating the objective function at q points."
        },
        {
            "section": "Initial model",
            "text": "Let x 0 be the initial point that is provided by the user. Initially, assuming that B is a diagonal matrix, then the number of points required to construct the initial model is m = 2n + 1 [7]. The initial m points x i , i = 1, 2, . . ., m, can be chosen as follows [6,24] x 1 \u00bc x 0 and",
            "ref_spans": [
                {
                    "type": "bibr",
                    "ref_id": "b6",
                    "start": 188,
                    "text": "[7]",
                    "end": 191
                },
                {
                    "type": "bibr",
                    "ref_id": "b5",
                    "start": 265,
                    "text": "[6,",
                    "end": 268
                },
                {
                    "type": "bibr",
                    "ref_id": "b23",
                    "start": 268,
                    "text": "24]",
                    "end": 271
                }
            ]
        },
        {
            "section": "Initial model",
            "text": "where D 1 is the initial trust region radius that is provided by the user, and e i is the ith coordinate vector in R n . The initial quadratic model M (1) (x) will have the parameters a (1) , the vector b (1) , and the n diagonal elements of the model Hessian matrix B (1) . These parameters are computed by requiring that the initial model interpolates the objective function f(x) at the initial m points given in (2). Therefore the initial model parameters are obtained by satisfying the matching conditions:",
            "ref_spans": [
                {
                    "type": "bibr",
                    "ref_id": "b0",
                    "start": 186,
                    "text": "(1)",
                    "end": 189
                },
                {
                    "type": "bibr",
                    "ref_id": "b0",
                    "start": 205,
                    "text": "(1)",
                    "end": 208
                },
                {
                    "type": "bibr",
                    "ref_id": "b0",
                    "start": 269,
                    "text": "(1)",
                    "end": 272
                },
                {
                    "type": "bibr",
                    "ref_id": "b1",
                    "start": 415,
                    "text": "(2)",
                    "end": 418
                }
            ]
        },
        {
            "section": "Model optimization",
            "text": "At the kth iteration, assume that x k is the current solution point. The model M (k) (x) is then minimized, in place of the objective function, over the current trust region and a new point is produced by solving the trust region sub-problem:"
        },
        {
            "section": "Model optimization",
            "text": "where s = x \u00c0 x k , D k is the current trust region radius, and k \u00c1 k throughout is the l 2 -norm. This problem is solved by the method of truncated conjugate gradient by Steihaug [9]. It is identical as the standard conjugate gradient method as long as the iterates are inside the trust region. If the conjugate gradient method terminates at a point within the trust region, this point is a global minimizer of the objective function. If the new iterate is outside the trust region, a truncated step which is on the region boundary is considered. Also, the method treats the case where the minimum is in the opposite direction of the conjugate direction which is due to the non convexity of the model [9]. One good property of this method is that the solution computed has a sufficient reduction property, which was proved by Bandler and Abdel-Malek [25]. Let s * denotes the solution of (4), and then a new point x n = x k + s * is obtained. The achieved actual reduction in the objective function is compared to that predicted reduction using the model by computing the reduction ratio which is given by:",
            "ref_spans": [
                {
                    "type": "bibr",
                    "ref_id": "b8",
                    "start": 180,
                    "text": "[9]",
                    "end": 183
                },
                {
                    "type": "bibr",
                    "ref_id": "b8",
                    "start": 702,
                    "text": "[9]",
                    "end": 705
                },
                {
                    "type": "bibr",
                    "ref_id": "b24",
                    "start": 851,
                    "text": "[25]",
                    "end": 855
                }
            ]
        },
        {
            "section": "Model optimization",
            "text": "This ratio reflects how much the surrogate model agrees with the objective function within the trust region. The trust region radius and the current iterate will be updated such that, if r k is sufficiently high, i.e., r k P 0.7, there is a good agreement between the model and the objective function over this step. Hence, it is beneficial to expand the trust region for the next iteration, and to use x n as the new center of the trust region. If r k is positive but not close to 1, i.e., 0.1 6 r k < 0.7, the trust region radius is not altered. On the other hand, if r k is smaller than a certain threshold, r k < 0.1, the trust region radius is reduced. The updating formula used for updating D k and x k can be expressed as follows:"
        },
        {
            "section": "Model optimization",
            "text": "It is to be mentioned that the current center is the point of least function value achieved so far."
        },
        {
            "section": "Model update",
            "text": "When a new point is available, the current quadratic model M (k) (x) is updated so that the point of lowest objective function value x k is now the center of the kth trust region. The model will take the form:"
        },
        {
            "section": "Model update",
            "text": "The parameters: a (k) , b (k) and B (k) are evaluated employing the parameter values of the previous model M k\u00c01 (x) in addition to all available function values. The constant a (k) is assigned the value of f(x) k , i.e., a (k) = f(x) k . The model will be updated in two steps. First, the vector b (k) is updated then the Hessian matrix B (k) is updated as follows:"
        },
        {
            "section": "Model update",
            "text": "Step1: Updating the vector b (k) The vector b (k) can be obtained using only n points. However, using the n recent points may result in ill-conditioned system of linear equations. In order to avoid this, it is proposed to use the least squares approximation with the most recent 2n points. So, the vector b (k) is evaluated such that the model M k (x) fits the last 2n points obtained, x i , i = 1, 2, . . ., 2n, i.e., the following condition should be satisfied:",
            "ref_spans": [
                {
                    "type": "bibr",
                    "start": 29,
                    "text": "(k)",
                    "end": 32
                }
            ]
        },
        {
            "section": "Model update",
            "text": "When computing the vector b (k) , the matrix B (k) is assigned temporarily the value of the previous model Hessian matrix, B (k\u00c01) , hence the vector b (k) is obtained by solving the following system of linear equations:"
        },
        {
            "section": "Model update",
            "text": "where"
        },
        {
            "section": "Model update",
            "text": ". . : \u00f011\u00de"
        },
        {
            "section": "Model update",
            "text": "The previous system is an over-determined system. The least squares approximation for b (k) is"
        },
        {
            "section": "Model update",
            "text": "Step2: Updating the matrix B (k) The model Hessian matrix B (k) is evaluated using the following updating formula:"
        },
        {
            "section": "Model update",
            "text": "where c is a positive constant, 0.5 < c < 1, and the vector"
        },
        {
            "section": "Model update",
            "text": "This choice of q, ensures that changes in B (k) occur gradually. The vector p is evaluated such that the model M (k) (x) tries to fit all the available m points obtained so far, x i , i = 1, 2, . . ., m, i.e., the following condition should be satisfied"
        },
        {
            "section": "Model update",
            "text": "i.e., the vector p is obtained by solving the weighted system of linear equations"
        },
        {
            "section": "Model update",
            "text": "where ; "
        },
        {
            "section": "Model update",
            "text": "To obtain more accurate model in the neighborhood of the current center, the available points are assigned different weights w i , i = 1, 2, . . ., m according to their distances from the trust region center. In the proposed approach the weight w i , associated with each equation, takes the form:"
        },
        {
            "section": "Model update",
            "text": "where c 1 is a positive constant, c 1 P 1."
        },
        {
            "section": "Model update",
            "text": "The previous system in (16) is an over-determined system (m > n). The least squares approximation for p is"
        },
        {
            "section": "Model update",
            "text": "After getting the vector p, the term qp T is calculated and the matrix is made symmetric by resetting the off-diagonal elements to their average values, i.e., b ij = b ji \u2039 (b ij + b ji )/2, then the new Hessian matrix B (k) is updated according to Eq. (13).",
            "ref_spans": [
                {
                    "type": "bibr",
                    "ref_id": "b12",
                    "start": 253,
                    "text": "(13)",
                    "end": 257
                }
            ]
        },
        {
            "section": "Model update",
            "text": "The model can be improved by generating a new point s new = x new \u00c0 x k , which is chosen to be on the boundary of the trust region so that it improves the distribution of points around the center of the trust region. A suggested solution to find s new is to solve the following problem:  ) is found to be less than f(x k ), then x new will be considered as the new trust region center of the subsequent iteration, otherwise, x new will just be added to the available set of points.",
            "ref_spans": [
                {
                    "type": "table",
                    "start": 289,
                    "text": ")",
                    "end": 290
                }
            ]
        },
        {
            "section": "Algorithm",
            "text": "A complete algorithm for the proposed method is given below (see also an illustrative flowchart in Fig. 2). ",
            "ref_spans": [
                {
                    "type": "figure",
                    "ref_id": "fig_3",
                    "start": 99,
                    "text": "Fig. 2",
                    "end": 105
                }
            ]
        },
        {
            "section": "Examples",
            "text": "The effectiveness of the proposed algorithm is demonstrated through two benchmark examples. All results are compared with those obtained by NEWUOA (NEW Unconstrained Optimization Algorithm) by Powell [6]. The performance is measured by the number of function evaluations N required to reach the optimal solution.",
            "ref_spans": [
                {
                    "type": "bibr",
                    "ref_id": "b5",
                    "start": 200,
                    "text": "[6]",
                    "end": 203
                }
            ]
        },
        {
            "section": "The 2D Beale function",
            "text": "The function is by [26]:",
            "ref_spans": [
                {
                    "type": "bibr",
                    "ref_id": "b25",
                    "start": 19,
                    "text": "[26]",
                    "end": 23
                }
            ]
        },
        {
            "section": "The 2D Beale function",
            "text": "where a 1 = 1.5, a 2 = 2.25, and a 3 = 2.625. This function has a valley approaching the line x 2 = 1, and has a minimum of 0 at (3 0.5) T . The initial values used for x 0 and D 1 are (0.1 0.1) T and 0.8, respectively. The results in Table 1 and Fig. 3 compare the optimal value obtained by applying the proposed technique versus NEWUOA with the same number of function evaluation N. It is to be noticed, that starting from the same initial point and after only 11 iterations; the proposed algorithm gives a function value of 0.8065 while NEWUOA gives 14.2031.",
            "ref_spans": [
                {
                    "type": "table",
                    "ref_id": "tab_2",
                    "start": 235,
                    "text": "Table 1",
                    "end": 242
                },
                {
                    "type": "figure",
                    "ref_id": "fig_4",
                    "start": 247,
                    "text": "Fig. 3",
                    "end": 253
                }
            ]
        },
        {
            "section": "The 3D Box function",
            "text": "The function was proposed by [27]:",
            "ref_spans": [
                {
                    "type": "bibr",
                    "ref_id": "b26",
                    "start": 29,
                    "text": "[27]",
                    "end": 33
                }
            ]
        },
        {
            "section": "The 3D Box function",
            "text": "This function has a minima at (1 10 1) T , and also along the line{(a a 0) T } with value 0. The initial values used for x 0 and D 1 are (0 10 2) T and 9.9, respectively. Table 2 shows a comparison of the optimal value obtained after N function evaluations using the proposed algorithm versus NEWUOA (see also Fig. 4).",
            "ref_spans": [
                {
                    "type": "table",
                    "ref_id": "tab_3",
                    "start": 171,
                    "text": "Table 2",
                    "end": 178
                },
                {
                    "type": "figure",
                    "ref_id": "fig_5",
                    "start": 310,
                    "text": "Fig. 4",
                    "end": 316
                }
            ]
        },
        {
            "section": "The 3D Box function",
            "text": "In the above numerical examples, it is to be noticed that at the beginning of the optimization process, the proposed algorithm is much faster than NEWUOA. However, as the optimization gets closer to the optimum, the methods based on interpolation will be more accurate as expected. This explains why the proposed algorithm is well suited for objective functions that have some uncertainty in their values or subject to statistical variations. This may occur for design of systems whose parameter values are subject to known but unavoidable statistical fluctuations [1,28]. Also, the algorithm may be useful for surrogate-based system design [2,29]. These surrogates are updated during the optimization process, and a few iterations in the optimization process will be sufficient at the beginning. In this case the new technique will produce a significant reduction in few iterations.",
            "ref_spans": [
                {
                    "type": "bibr",
                    "ref_id": "b0",
                    "start": 565,
                    "text": "[1,",
                    "end": 568
                },
                {
                    "type": "bibr",
                    "ref_id": "b27",
                    "start": 568,
                    "text": "28]",
                    "end": 571
                },
                {
                    "type": "bibr",
                    "ref_id": "b1",
                    "start": 641,
                    "text": "[2,",
                    "end": 644
                },
                {
                    "type": "bibr",
                    "ref_id": "b28",
                    "start": 644,
                    "text": "29]",
                    "end": 647
                }
            ]
        },
        {
            "section": "Optimized design of RF cavity",
            "text": "The RF cavity is a major component of linear accelerators [30,31]. The structure of RF cavity must efficiently transfer the electromagnetic energy to the charged particles beam. This can be accomplished through an optimized configuration of its internal geometry, by adding nose cones to create a region of more concentrated axial electric field along the path of the electron beam, as shown in Fig. 1.",
            "ref_spans": [
                {
                    "type": "bibr",
                    "ref_id": "b29",
                    "start": 58,
                    "text": "[30,",
                    "end": 62
                },
                {
                    "type": "bibr",
                    "ref_id": "b30",
                    "start": 62,
                    "text": "31]",
                    "end": 65
                },
                {
                    "type": "figure",
                    "start": 395,
                    "text": "Fig. 1",
                    "end": 401
                }
            ]
        },
        {
            "section": "Optimized design of RF cavity",
            "text": "The most useful figure of merit for high field concentration along the beam axis and low ohmic power loss in the cavity walls is the effective shunt impedance per unit length ZT 2 where T is the transient-time factor (a measure of the energy gain reduction caused by the sinusoidal time variation of the field in the cavity, [32]).",
            "ref_spans": [
                {
                    "type": "bibr",
                    "ref_id": "b31",
                    "start": 325,
                    "text": "[32]",
                    "end": 329
                }
            ]
        },
        {
            "section": "Optimized design of RF cavity",
            "text": "One of the main objectives in cavity design is to choose geometry to maximize effective shunt impedance per unit length. This indicates increasing the energy delivered to the beam compared to that thermally lost in the cavity walls. The effective shunt impedance per unit length is usually expressed in mega ohms per meter and is defined by"
        },
        {
            "section": "Optimized design of RF cavity",
            "text": "where P is the thermal power losses in the walls of the cavity, V 0 = \u00f2 E(z)dz = E 0 L, and E 0 is the average axial electric field along the cavity axis with length L. The technique is applied to an RF cavity with resonance frequency 9.4 GHz, shown in Fig. 5. The objective is to maximize effective shunt impedance per unit length. In order to do that, we optimize the axial z positions of ten points that describe the cavity curvature through a spline curve. The axial positions z = (z 1 , z 2 ,. . ., z 10 ) T in the z-direction are taken as the design parameters. The radial positions of these points are chosen on a logarithmic scale along r-direction. It is to be noted that during the variation of the curvature, the    resonance frequency is always kept at 9.4 GHz. The initial values used for the ten radial positions z 0 are all set to 0.6 cm and D 1 is set to 0.02 cm. Cavity design generally requires electromagnetic field-solver that solves Maxwell equations numerically for the specified boundary conditions. In the simulations, POISSON and SUPERFISH are used as the main solver programs in a collection of programs from LANL [18,33]. The solver is used to calculate the static magnetic and electric fields and radio-frequency electromagnetic fields for either 2-D Cartesian coordinates or axially symmetric cylindrical coordinates. The code SUPER-FISH is used to solve for axisymmetric TM0nl modes, for the field components Hphi, Er and Ez. The solution is obtained through solving Hemholtz equation using finite element method FEM over a triangular mesh subject to the proper boundary conditions and symmetries imposed [34].",
            "ref_spans": [
                {
                    "type": "figure",
                    "ref_id": "fig_6",
                    "start": 253,
                    "text": "Fig. 5",
                    "end": 259
                },
                {
                    "type": "bibr",
                    "ref_id": "b17",
                    "start": 1140,
                    "text": "[18,",
                    "end": 1144
                },
                {
                    "type": "bibr",
                    "start": 1144,
                    "text": "33]",
                    "end": 1147
                },
                {
                    "type": "bibr",
                    "ref_id": "b32",
                    "start": 1635,
                    "text": "[34]",
                    "end": 1639
                }
            ]
        },
        {
            "section": "Optimized design of RF cavity",
            "text": "Design algorithm shown in Fig. 6 is implemented in MAT-LAB code, where an initial case is chosen corresponding to ten z positions of points with cavity curvature is described with spline curve (step 2). Then the spline interpolated curve is sampled at 100 points, where those sampled points are considered connected with piecewise linear, approximating the cavity curvature. This piece wise linear description is fed to AUTO-MESH program to generate mesh (step 3). The solution of lowest TM mode of the cavity is made at step 4 by calling SUPERFISH, and the obtained frequency in step 5 is used to scale the cavity dimensions to keep the resonance frequency at 9.4 GH (step 6). The corresponding scaling is reflected on the obtained cavity shunt impedance (step 7), where this value is fed to the optimizer algorithm to determine the new ten points positions. Then the process is repeated starting from step 2.",
            "ref_spans": [
                {
                    "type": "figure",
                    "ref_id": "fig_7",
                    "start": 26,
                    "text": "Fig. 6",
                    "end": 32
                }
            ]
        },
        {
            "section": "Optimized design of RF cavity",
            "text": "The results of the effective shunt impedance per unit length for RF cavity in mega ohm per meter after N function evaluations for both the proposed algorithm and NEWUOA are shown in Table 3.",
            "ref_spans": [
                {
                    "type": "table",
                    "ref_id": "tab_4",
                    "start": 182,
                    "text": "Table 3",
                    "end": 189
                }
            ]
        },
        {
            "section": "Optimized design of RF cavity",
            "text": "It is to be mentioned that starting from the same initial point, the convergence of the proposed algorithm is as best as NEWUOA. However, the advantage of the proposed algorithm is its easy implementation and accessibility for update and modification."
        },
        {
            "section": "Optimized design of RF cavity",
            "text": "The figures of optimal cavity using the proposed algorithm and the NEWUOA are shown in Figs. 7 and 8 respectively."
        },
        {
            "section": "Optimized design of RF cavity",
            "text": "It worth mentioning that one could criticize the proposed optimized structure, that it contains sharp edge nose, which is difficult to manufacture and is a point of field singularity that causes breakdown. One way to override that problem is to add some curvature to the nose sharp tip, which would slightly reduce the realized shunt impedance.     "
        },
        {
            "section": "Conclusions",
            "text": "In this article, a new trust region optimization method that does not require any derivative information has been proposed. In this method, the objective function is approximated via quadratic surrogates, and using few number of initial data points than the exact number of surrogate parameters. Classical benchmark test problems were used to demonstrate the accuracy and efficiency of the proposed method. The results obtained showed the ability of the proposed method to rapidly converge to the final region containing the optimum solution when only a limited number of function evaluations is permissible and when a high accuracy is not really necessary. Least-squares fitting is used instead of interpolation which explains the inaccurate solution in case of explicit objective functions. Thus, the proposed method is suitable for stochastic optimization or objectives that suffer from numerical inaccuracy. In addition, the proposed method has been used to obtain the optimal design for the structure of RF cavity which is the major part of any linear accelerator."
        },
        {
            "text": "w m \u00c3 \u00f0f\u00f0s m \u00de \u00c0 a \u00f0k\u00de \u00c0 s T m b \u00f0k\u00de \u00c0 1 2 s T m cB \u00f0k\u00c01\u00de s m \u00de"
        },
        {
            "section": "1 . 8 .",
            "text": "Set N = 0 (the number of function evaluations), given x 0 2 R n ; D 1 > 0; 0:5 < c < 1; c 1 P 1; N max ; d (a termination criterion). 2. Find the initial m points using(2), letting x 1 be the initial trust region center, then construct the initial quadratic model using (3), Set k = 1. 3. Solve the trust region sub-problem (4) using the truncated conjugate gradient method to obtain s * = x n \u00c0 x k of the model M (k) (x) over the trust region. 4. Evaluate f(x n ) and compute the reduction ratio by substituting in (5). 5. Update the trust region radius to obtain D k+1 using (6). 6. Determine the trust region center of the next iteration x k+1 based on x k and r k using(7). If ||f(x k+1 ) \u00c0 f(x k )|| 6 d, the algorithm will be terminated with x opt = x k+1 and f opt = f(x k+1 ). If for two successive iterations, r k is negative go to Step 9, else continue. 7. Add the point x n to the set of available points S, if the number of points in S exceeds N max , remove the farthest point from x k+1 . Comment. To avoid severe computational and storage overhead, a bound N max is put to limit the uncontrollable increase in the number of stored points. Specifically, when the number of available points reaches N max the farthest point from the trust region center is removed. Construct the quadratic model M (k+1) (x) around x k+1 based on M (k) (x) and the set of available points S using the updating procedures in Eqs. (9)-(19), then set k = k + 1 and go to Step 3. 9. Generate a new point s new using(20), add it to the set of points S, then go to Step 8.",
            "ref_spans": [
                {
                    "type": "bibr",
                    "ref_id": "b1",
                    "start": 168,
                    "text": "(2)",
                    "end": 171
                },
                {
                    "type": "bibr",
                    "ref_id": "b6",
                    "start": 674,
                    "text": "(7)",
                    "end": 677
                },
                {
                    "type": "bibr",
                    "ref_id": "b18",
                    "start": 1429,
                    "text": "(19)",
                    "end": 1433
                },
                {
                    "type": "bibr",
                    "ref_id": "b19",
                    "start": 1507,
                    "text": "(20)",
                    "end": 1511
                }
            ]
        },
        {
            "section": "Fig. 2 A",
            "text": "flowchart for the proposed optimization algorithm."
        },
        {
            "section": "Fig. 3",
            "text": "Results of the 2D Beale function."
        },
        {
            "section": "Fig. 4",
            "text": "Results of the 3D Box function."
        },
        {
            "section": "Fig. 5",
            "text": "Structure of radio frequency (RF) cavity."
        },
        {
            "section": "Fig. 6",
            "text": "The Poisson Superfish Solver within the proposed optimization (design) loop."
        },
        {
            "section": "Fig. 7",
            "text": "The optimized cavity using the proposed algorithm. Effective Shunt impedance per unit length = 121.301 MOhm/m."
        },
        {
            "section": "Fig. 8",
            "text": "The optimized cavity using NEWUOA. Effective Shunt impedance per unit length = 121.521 MOhm/m."
        },
        {
            "text": "B \u00f0k\u00c01\u00de s 1 f\u00f0s 2 \u00de \u00c0 a \u00f0k\u00de \u00c0 1 2 s T 2 B \u00f0k\u00c01\u00de s 2 . . . f\u00f0s 2n \u00de \u00c0 a \u00f0k\u00de \u00c0 1 2 s T 2n B \u00f0k\u00c01\u00de s 2n"
        },
        {
            "text": "D; \u00f020\u00de where s new is selected to maximize the sum of squares of the projections of the vector s new on the other s i , i = 1, 2, . . .n s vectors, where n s is the available set of points. After generating s new , the function value f(x new ) is computed. If f(x new"
        },
        {
            "text": "2 ; such that s T i s < 0 8 i and ksk 6"
        },
        {
            "section": "Table 1",
            "text": "Results of the 2D Beale function compared with NEWUOA."
        },
        {
            "section": "Table 2",
            "text": "Results of the 3D Box function compared with NEWUOA."
        },
        {
            "section": "Table 3",
            "text": "Results of the RF cavity design compared with NEWUOA."
        },
        {
            "section": "Acknowledgment",
            "text": "The authors deeply thank Dr. Sami Tantawi from SLAC National Accelerator Laboratory for the fruitful discussion on the optimization of the RF cavity resonators."
        },
        {
            "section": "Conflict of interest",
            "text": "The authors have declared no conflict of interest."
        },
        {
            "section": "Compliance with Ethics Requirements",
            "text": "This article does not contain any studies with human or animal subjects."
        }
    ]
}