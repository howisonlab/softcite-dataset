{
    "level": "paragraph",
    "abstract": [
        {
            "text": "As digital imaging is becoming a fundamental part of medical and biomedical research, the demand for computer-based evaluation using advanced image analysis is becoming an integral part of many research projects. A common problem when developing new image analysis algorithms is the need of large datasets with ground truth on which the algorithms can be tested and optimized. Generating such datasets is often tedious and introduces subjectivity and interindividual and intraindividual variations. An alternative to manually created ground-truth data is to generate synthetic images where the ground truth is known. The challenge then is to make the images sufficiently similar to the real ones to be useful in algorithm development. One of the first and most widely studied medical image analysis tasks is to automate screening for cervical cancer through Pap-smear analysis. As part of an effort to develop a new generation cervical cancer screening system, we have developed a framework for the creation of realistic synthetic bright-field microscopy images that can be used for algorithm development and benchmarking. The resulting framework has been assessed through a visual evaluation by experts with extensive experience of Pap-smear images. The results show that images produced using our described methods are realistic enough to be mistaken for real microscopy images. The developed simulation framework is very flexible and can be modified to mimic many other types of bright-field microscopy images."
        }
    ],
    "body_text": [
        {
            "text": "THE recent trend toward high-throughput screening in medical and biomedical research has led to a substantial increase of the amount of data produced. This development has rendered manual analysis of all the resulting data to no longer being a feasible approach. Therefore, computer-based evaluations using advanced image analysis have become an integral part of many research projects, for example, in (1). A good example of a field where research on the use of image analysis as a diagnostic tool has been ongoing for many years is that of Papanicolaou (Pap) test analysis. Attempts at the creation of automated systems have been made since 1950s, and the problem is still subject to active research (2).",
            "ref_spans": [
                {
                    "type": "bibr",
                    "ref_id": "b0",
                    "start": 403,
                    "text": "(1)",
                    "end": 406
                },
                {
                    "type": "bibr",
                    "ref_id": "b1",
                    "start": 702,
                    "text": "(2)",
                    "end": 705
                }
            ]
        },
        {
            "text": "To create an algorithm that is able to, for example, segment nuclei in an image, the developer is at some point going to need a validation dataset containing a representable selection of the material being analyzed, as well as a ground-truth segmentation for the objects of interest. This is used to measure the performance and robustness of developed algorithms. Acquiring this ground-truth data can, however, in many cases be a very difficult prospect. Aside from issues such as obscuring biological material, the image will have been subjected to aberrations linked to the modality of the acquisition technique (3). The process of dealing with these degenerative effects can often become very complicated. When working with images acquired from a microscope, one may have to deal with issues such as uneven illumination, detector noise, and compression artefacts (4,5). These errors are added to already existing aberrations related to the physical limitations of the optics (6).",
            "ref_spans": [
                {
                    "type": "bibr",
                    "ref_id": "b2",
                    "start": 614,
                    "text": "(3)",
                    "end": 617
                },
                {
                    "type": "bibr",
                    "ref_id": "b3",
                    "start": 866,
                    "text": "(4,",
                    "end": 869
                },
                {
                    "type": "bibr",
                    "ref_id": "b4",
                    "start": 869,
                    "text": "5)",
                    "end": 871
                },
                {
                    "type": "bibr",
                    "ref_id": "b5",
                    "start": 978,
                    "text": "(6)",
                    "end": 981
                }
            ]
        },
        {
            "text": "The classical way to handle the ground-truth issue is to manually try to obtain ground-truth data with the help of one or, preferably, several experts. However, this approach is notoriously prone to introduce errors in itself, due to the limitations in reproducibility for human operators (7). Furthermore, to create a statistically sound ground-truth dataset, especially when working with biological data and its basically infinite variations, it is often necessary to manually analyze huge quantities of data. This can in many cases be an impossible task.",
            "ref_spans": [
                {
                    "type": "bibr",
                    "ref_id": "b6",
                    "start": 289,
                    "text": "(7)",
                    "end": 292
                }
            ]
        },
        {
            "text": "In this article, we describe a framework for creating realistic synthetic images intended to be used for the development of various kinds of image analysis tasks such as preprocessing and segmentation. Simulated images can fill several functions in a development pipeline, for example:"
        },
        {
            "text": "Parameter optimization (8). Algorithm comparison/evaluation (4). Benchmarking on large datasets (9).",
            "ref_spans": [
                {
                    "type": "bibr",
                    "ref_id": "b7",
                    "start": 23,
                    "text": "(8)",
                    "end": 26
                },
                {
                    "type": "bibr",
                    "ref_id": "b3",
                    "start": 60,
                    "text": "(4)",
                    "end": 63
                },
                {
                    "type": "bibr",
                    "ref_id": "b8",
                    "start": 96,
                    "text": "(9)",
                    "end": 99
                }
            ]
        },
        {
            "text": "As ground truth is always readily available, it is possible to do optimizations, evaluations, and validations on amounts of data not feasible when relying on manually analyzed images. Another benefit is the ability to control the characteristics of the synthetic data both concerning imaging properties such as uneven illumination and aberrations caused by the imaging system. This allows for controlled testing of an algorithm's robustness under very specific circumstances."
        },
        {
            "text": "Previous attempts at creating images depicting cell-or nucleus-like objects have primarily been aimed at mimicking images acquired using fluorescence microscopy. Lehmussola et al. created a complex simulator, called SIMCEP, which is able to create populations of realistic two-dimensional (2D) nucleus populations (4). Svoboda et al. built on the concepts introduced in that article to create fully three-dimensional (3D) image data (5,10). Recently, they have further extended their work to also include time-lapse simulation (11). In common, for the work mentioned above is that they only simulate the nucleus appearance and did so using parametric methods for shape and texture generation. Zhao and Murphy (12) instead uses machine learning to generate the shape of the nucleus and the cytoplasm as well as the texture of the nucleus.",
            "ref_spans": [
                {
                    "type": "bibr",
                    "ref_id": "b3",
                    "start": 314,
                    "text": "(4)",
                    "end": 317
                },
                {
                    "type": "bibr",
                    "ref_id": "b4",
                    "start": 433,
                    "text": "(5,",
                    "end": 436
                },
                {
                    "type": "bibr",
                    "ref_id": "b9",
                    "start": 436,
                    "text": "10)",
                    "end": 439
                },
                {
                    "type": "bibr",
                    "ref_id": "b10",
                    "start": 527,
                    "text": "(11)",
                    "end": 531
                },
                {
                    "type": "bibr",
                    "start": 693,
                    "text": "Zhao and Murphy (12)",
                    "end": 713
                }
            ]
        },
        {
            "text": "The simulation described in this article constitutes a highly flexible framework for emulating Pap-smear images taken using a standard bright-field microscope. This is, to the best of our knowledge, only the second attempt at creating realistic synthetic images emulating data collected using bright-field microscopes, the first one being our own previous work (8). This new framework, however, improves greatly on previous work through the addition of shape and texture generation based on data obtained from an extensive database of segmented cells, the inclusion of more debris models, a more versatile method for object distribution, and an accurate approximation of the image depth of field, allowing for simulated focus stacks to be created. The resulting images have been validated using visual inspection of images by trained individuals with experience in analyzing cell images as well as cytology experts.",
            "ref_spans": [
                {
                    "type": "bibr",
                    "ref_id": "b7",
                    "start": 361,
                    "text": "(8)",
                    "end": 364
                }
            ]
        },
        {
            "section": "PROBLEM STATEMENT",
            "text": "The goal of this project was to create a simulation framework able to create realistic images containing not only cell nuclei but also cytoplasms as well as a wide variety of other objects and artifacts commonly found in Pap-test specimens. When working with biological data, one of the biggest challenges lies in trying to deal with the extensive variation present in the samples. Objects are often subjected to distortions such as overlapping and folding or obscured by material lying outside the current focus plane of the imaging system. If stains are used, it is common to experience stain intensity variations on both an intrasample and intersample basis."
        },
        {
            "section": "PROBLEM STATEMENT",
            "text": "For this article, objects that are not usable intermediate epithelial cells are referred to as debris or artifacts. A selection of the most common types of artifacts found in Pap-smear samples have been illustrated in Figure 1. These artifacts introduce an added level of difficulty when trying to achieve goals such as reliable nucleus segmentation in a high-throughput setting. When developing a synthetic image generation framework for this type of modality, it is essential that as many of these types of debris are modeled as accurately as possible and included in the final results.",
            "ref_spans": [
                {
                    "type": "figure",
                    "ref_id": "fig_0",
                    "start": 218,
                    "text": "Figure 1",
                    "end": 226
                }
            ]
        },
        {
            "section": "PROBLEM STATEMENT",
            "text": "The primary focus for this study was to try to imitate the appearance of samples produced using liquid-based cytology (LBC) (13). A description of the LBC method can be found in the reference data section below. This choice was related to LBC producing cleaner specimens. Regions with well distributed and mainly free-lying cells on conventional smears look similar to LBC:s and those are reasonably well represented by our simulator. By increasing the object distribution density, the generated images will become more similar to dense regions on smears. But, the conventional smears also contain highly dense regions with many layers of cells, mucus, and other obscuring structures. Simulating that appearance properly would have required significant additional modeling efforts without adding to the usefulness of the simulator, as there are hardly any image analysis algorithms that can extract useful information from such dense regions.",
            "ref_spans": [
                {
                    "type": "bibr",
                    "ref_id": "b12",
                    "start": 124,
                    "text": "(13)",
                    "end": 128
                }
            ]
        },
        {
            "section": "PROBLEM STATEMENT",
            "text": "Although humans analyze Pap-smears in color, computerbased systems commonly operate on monochrome images. This is because color has very little diagnostic value when analyzing specimen stained using the Pap-stain. Instead, when developing automated systems, achieving a good contrast for nucleus texture is the highest priority. Therefore, specific filters are used that produce monochrome images with maximum nucleus contrast (14). The simulator described in this article is imitating images taken using such circumstances.",
            "ref_spans": [
                {
                    "type": "bibr",
                    "ref_id": "b13",
                    "start": 427,
                    "text": "(14)",
                    "end": 431
                }
            ]
        },
        {
            "section": "REFERENCE DATA",
            "text": "To create synthetic images that are sufficiently similar to reality, access to real data is a necessity. For the development of the framework described in this article, a large database of Pap-smear images, acquired at several focus levels, was available. In the following sections, the source material will be discussed in more detail."
        },
        {
            "section": "The Papanicolaou Test",
            "text": "The goal of the Papanicolaou test is the detection of neoplastic (cancerous) and proneoplastic (precancerous) cell changes in the cervix before they reach an invasive stage. Using a spatula or a brush, the area known as the transformation zone of the uterine cervix is scraped to obtain epithelial cells. The epithelium has a layered structure consisting of basal, parabasal, intermediate, and superficial cell. Out of these, the intermediate cells are the most common and have frequently been the target of automated analysis studies (13). The collected material is smeared onto a glass slide to produce the Pap-smear. The sample is fixed and stained to enhance the contrast between nucleus and cytoplasm (15).",
            "ref_spans": [
                {
                    "type": "bibr",
                    "ref_id": "b12",
                    "start": 535,
                    "text": "(13)",
                    "end": 539
                },
                {
                    "type": "bibr",
                    "ref_id": "b14",
                    "start": 706,
                    "text": "(15)",
                    "end": 710
                }
            ]
        },
        {
            "section": "The Papanicolaou Test",
            "text": "Although the Pap-smear has shown its worth through decades of use, it is hampered by certain difficulties, for example, variable smear thickness, uneven cell distribution across the field of view, obscuring elements such as blood and inflammatory cells, and variable fixation and staining results. To overcome some of these problems, so-called LBC preparation methods have been developed. Using LBC, the sample is immersed in a solution that is then subjected to a number of processes that work to homogenize the sample, remove unwanted components (e.g., red blood cells) and finally deposit a suitable mono-layer sample on a glass slide (13). These samples are considerably less cluttered and while thickness of the cells distribution still varies, it is overall far less than for the conventional smear. However, the types of debris objects described in the Problem Statement section earlier will still be present in samples prepared using an LBC protocol.",
            "ref_spans": [
                {
                    "type": "bibr",
                    "ref_id": "b12",
                    "start": 638,
                    "text": "(13)",
                    "end": 642
                }
            ]
        },
        {
            "section": "Materials",
            "text": "Data from more than 900 fields of view, acquired as focus-stacks from 82 specimens, were available for the development of the simulation method. The database contains specimen prepared using both the conventional method as well as the LBC method. Image acquisition was performed using an Olympus BX51 bright-field microscope equipped with a 403, 0.95 NA lens and a Hamamatsu ORCA-05G 1.4 Mpx monochrome camera, giving a pixel size of 0.25 mm. The microscope light path was filtered using a 570-nm bandpass filter, a wavelength previously shown to maximize the contrast of nuclei in Pap-smears (14). The microscope was fitted with an E-662 Piezo server controller (Physik Instrumente GmbH & Co. KG, Karlsruhe, Germany). This allowed for z-axis step control with a 0.1 mm resolution during image acquisition.",
            "ref_spans": [
                {
                    "type": "bibr",
                    "ref_id": "b13",
                    "start": 593,
                    "text": "(14)",
                    "end": 597
                }
            ]
        },
        {
            "section": "Materials",
            "text": "The algorithms described in this article were implemented in MATLAB (2011b, The MathWorks, Natick, MA) using the image processing toolbox DIPimage (16).",
            "ref_spans": [
                {
                    "type": "bibr",
                    "ref_id": "b15",
                    "start": 147,
                    "text": "(16)",
                    "end": 151
                }
            ]
        },
        {
            "section": "SIMULATION METHODS",
            "text": "The framework described in this article includes the creation of a wide variety of objects, ranging from the individual cells to clusters of bacilli, as well as an emulation of an optical system paired with a detector. Svoboda et al. (5) suggested that the simulation process can be split into three main phases: phantom object generation, signal transmission, and finally, signal detection and image formation.",
            "ref_spans": [
                {
                    "type": "bibr",
                    "ref_id": "b4",
                    "start": 234,
                    "text": "(5)",
                    "end": 237
                }
            ]
        },
        {
            "section": "SIMULATION METHODS",
            "text": "Phantom object generation refers to the creation of the primitives that constitute the main content of an image. In some cases, these objects can be quite simple point-like objects (17), whereas others entail the creation of full 3D representations (5). For some simulation frameworks, phantom generation includes not only the creation of single objects but also entire populations of object occurrences (4,18).",
            "ref_spans": [
                {
                    "type": "bibr",
                    "ref_id": "b16",
                    "start": 181,
                    "text": "(17)",
                    "end": 185
                },
                {
                    "type": "bibr",
                    "ref_id": "b4",
                    "start": 249,
                    "text": "(5)",
                    "end": 252
                },
                {
                    "type": "bibr",
                    "ref_id": "b3",
                    "start": 404,
                    "text": "(4,",
                    "end": 407
                },
                {
                    "type": "bibr",
                    "ref_id": "b17",
                    "start": 407,
                    "text": "18)",
                    "end": 410
                }
            ]
        },
        {
            "section": "SIMULATION METHODS",
            "text": "The way the signal transmission is approximated is naturally highly dependent on the modality being simulated. Perhaps, the most important phenomenon is the impulse response of the system, also known as the point spread function (PSF), which is a central aspect of all types of microscopy (3). The PSF is most often replaced by a Gaussian kernel as its generally accepted to be a good approximation (4,8,17). Other aspects belonging to this stage are uneven illumination (10) and various kinds of chromatic aberrations (19).",
            "ref_spans": [
                {
                    "type": "bibr",
                    "ref_id": "b2",
                    "start": 289,
                    "text": "(3)",
                    "end": 292
                },
                {
                    "type": "bibr",
                    "ref_id": "b3",
                    "start": 399,
                    "text": "(4,",
                    "end": 402
                },
                {
                    "type": "bibr",
                    "ref_id": "b7",
                    "start": 402,
                    "text": "8,",
                    "end": 404
                },
                {
                    "type": "bibr",
                    "ref_id": "b16",
                    "start": 404,
                    "text": "17)",
                    "end": 407
                },
                {
                    "type": "bibr",
                    "ref_id": "b9",
                    "start": 471,
                    "text": "(10)",
                    "end": 475
                },
                {
                    "type": "bibr",
                    "ref_id": "b18",
                    "start": 519,
                    "text": "(19)",
                    "end": 523
                }
            ]
        },
        {
            "section": "SIMULATION METHODS",
            "text": "The final stage aims to emulate the performance of the device sensor and its conversion of incoming light into a digital representation. Sensors introduce Poisson noise (20) that can be seen with the naked eye. Furthermore, the A/D converter and amplification circuits introduce noticeable levels of noise (20). Other possible aberrations include dark current noise, fixed pattern noise, and blooming effects (5). Figure 2 depicts a flowchart, organized as suggested by Svoboda et al., illustrating the synthesis process of the algorithm described in this article. In the following sections, we are going to describe the steps of the method in more detail.",
            "ref_spans": [
                {
                    "type": "bibr",
                    "ref_id": "b19",
                    "start": 306,
                    "text": "(20)",
                    "end": 310
                },
                {
                    "type": "bibr",
                    "ref_id": "b4",
                    "start": 409,
                    "text": "(5)",
                    "end": 412
                },
                {
                    "type": "figure",
                    "ref_id": "fig_1",
                    "start": 414,
                    "text": "Figure 2",
                    "end": 422
                }
            ]
        },
        {
            "section": "Squamous Intermediate Cell Phantoms",
            "text": "As the squamous intermediate cell is the target for most studies related to Pap-smear analysis, it is of utmost importance that it is as accurately modeled as possible. The cells can, for modeling purposes, be divided into two main components, the cytoplasm and the nucleus."
        },
        {
            "section": "Squamous Intermediate Cell Phantoms",
            "text": "The cytoplasms appear as a mostly transparent gel-like substance. It has little stability and is thus easily deformed, resulting in variations in shape and size between cells. The cytoplasm of a healthy cell displays little in the way of a regular texture other than a fine network of fibers, these are known as the cytoskeleton."
        },
        {
            "section": "Squamous Intermediate Cell Phantoms",
            "text": "The nucleus is in contrast to the cytoplasm a more rigid structure that has a principally elliptical shape. Because of the staining involved when preparing the Pap-smear, it is generally darker relative to the cytoplasm. The appearance of the nucleus texture is related to the distribution of the chromatin within the nucleus membrane."
        },
        {
            "section": "Squamous Intermediate Cell Phantoms",
            "text": "Shape generation. To generate the shape of the cytoplasm and nucleus phantoms as accurately as possible, we used our cell image database. From our database of some 12,000 segmented cell nuclei, we randomly selected 100 normal squamous intermediate cell nuclei. The nuclei were segmented through a manually seeded watershed algorithm. The corresponding cytoplasm was interactively segmented using the live-wire tool (21). For each cell, the shapes of the cytoplasm and the nucleus have been parameterized using a method for Fourier shape representation described by Zhang and Lu (22). The boundary of an object mask is sampled at a predefined number, K, points spaced at an equal arc length. Starting at an arbitrary point, (",
            "ref_spans": [
                {
                    "type": "bibr",
                    "ref_id": "b20",
                    "start": 415,
                    "text": "(21)",
                    "end": 419
                },
                {
                    "type": "bibr",
                    "start": 565,
                    "text": "Zhang and Lu (22)",
                    "end": 582
                }
            ]
        },
        {
            "section": "Squamous Intermediate Cell Phantoms",
            "text": "are encountered when traversing the boundary in a preselected direction. The shape boundary coordinates can be represented as a sequence of coordinates"
        },
        {
            "section": "Squamous Intermediate Cell Phantoms",
            "text": "Also, each coordinate pair can be treated as a complex number so that"
        },
        {
            "section": "z\u00f0k\u00de5x\u00f0k\u00de1iy\u00f0k\u00de",
            "text": "(1)"
        },
        {
            "section": "z\u00f0k\u00de5x\u00f0k\u00de1iy\u00f0k\u00de",
            "text": "where i is the unit imaginary number. This reduces our 2D data to at 1D problem. We can now calculate the discrete Fourier transform of z(k) as"
        },
        {
            "section": "z\u00f0k\u00de5x\u00f0k\u00de1iy\u00f0k\u00de",
            "text": "where l50; 1; . . . ; K 21. The complex coefficients u n are called the Fourier shape descriptors (FSD) of the boundary. These descriptors represent the shape of the object in the frequency domain. We carry out this kind of FSD extraction on a representative population of nuclear shapes and thus collect a set of statistical populations of FSD. We can now use naive Bayesian theory to generate new shapes. This means that we from these populations extract the mean and standard deviation for each descriptor and use that to define a statistical distribution from which we draw samples at random. These samples define a new shape which is returned to real space through inverse Fourier transform. The FSD can be normalized with respect to size by dividing the descriptors with the magnitude of the second component, ju 1 j, of the signal, yielding the normalized shape descriptor vector u^a\u015d"
        },
        {
            "section": "z\u00f0k\u00de5x\u00f0k\u00de1iy\u00f0k\u00de",
            "text": "The DC component, u 0 , depends only on the position of the shape, which in this setting is of no importance and can Original Article therefore be removed, u 0 5 0. By normalizing the size of the shapes in the database, it is now possible to add a scale parameter to the generation of the new shapes. This gives us an increased control and makes it possible to, for example, link our shape size to a pixel resolution or add controlled random size variations to the generated shapes. A few examples of randomly generated nucleus and cytoplasm shapes can be seen in Figure 3.",
            "ref_spans": [
                {
                    "type": "figure",
                    "ref_id": "fig_2",
                    "start": 564,
                    "text": "Figure 3",
                    "end": 572
                }
            ]
        },
        {
            "section": "z\u00f0k\u00de5x\u00f0k\u00de1iy\u00f0k\u00de",
            "text": "Texture synthesis. For this study, nucleus textures have been created using a texture synthesis approach, well known in computer graphics, called patch-based texture generation (23). The goal of this method is to be able to create a texture image of any size based on a small texture sample. A schematic description of the texture generation process can be seen in Figure 4.",
            "ref_spans": [
                {
                    "type": "bibr",
                    "ref_id": "b22",
                    "start": 177,
                    "text": "(23)",
                    "end": 181
                },
                {
                    "type": "figure",
                    "ref_id": "fig_3",
                    "start": 365,
                    "text": "Figure 4",
                    "end": 373
                }
            ]
        },
        {
            "section": "z\u00f0k\u00de5x\u00f0k\u00de1iy\u00f0k\u00de",
            "text": "The process is initialized by randomly selecting an initial texture patch, B 0 , of predefined size from the sample texture, T s , and placing it in a corner of the target texture,T out . A boundary zone, E B k , of width, w E , is defined for each patch. A random coordinate pair, (x, y), is generated in T s and a patch candidate, B (x,y) is acquired. If the distance between the over-"
        },
        {
            "section": "z\u00f0k\u00de5x\u00f0k\u00de1iy\u00f0k\u00de",
            "text": ", is lower than a predefined distance threshold, d max , the patch is accepted to be pasted to the generated texture. The distance metric used is usually the mean squared error. As a final step, the pixels in the overlap region need to be blended together to avoid sharp edges in the texture. This can be achieved using feathering (24) or a minimum error boundary cut (23). For our implementation, we use feathering, that is, pixel intensities are weighted relative to their distance to the edges of the patches. A flowchart depicting the simulation framework described in this article. The simulation process is divided into three phases. In the first phase shape primitives, phantoms, are created. These objects include cell nuclei, cell cytoplasms, bacilli, WBC, OOF objects, and speckles. Once the primitives are created they are distributed over the image using a weighted distribution model. Also, each object is given a depth coordinate. In the second phase image degradation similar t p , the one seen in bright-field microscopes is simulated. Finally, in phase 3, sensor noise is simulated according to the characteristics of a CCD sensor. To add randomness to the nucleus texture generation, each new texture is generated from three different sample nuclei randomly selected from the database. This significantly reduces the risk of recurring texture details. Furthermore, we have added weighting to the patch selection so that patches that are to be placed close to the center of the phantom are more likely to be found in central parts of the sample images. An example of a generated nucleus can be seen in Figure 5.",
            "ref_spans": [
                {
                    "type": "bibr",
                    "ref_id": "b23",
                    "start": 331,
                    "text": "(24)",
                    "end": 335
                },
                {
                    "type": "bibr",
                    "ref_id": "b22",
                    "start": 368,
                    "text": "(23)",
                    "end": 372
                },
                {
                    "type": "figure",
                    "ref_id": "fig_4",
                    "start": 1619,
                    "text": "Figure 5",
                    "end": 1627
                }
            ]
        },
        {
            "section": "z\u00f0k\u00de5x\u00f0k\u00de1iy\u00f0k\u00de",
            "text": "The cytoplasm texture is difficult to define as it is mainly a result of which deformations it has been exposed to. To that end, a cloth simulation algorithm (25) has been used to simulate cytoplasm deformations. The cloth simulator starts with a circular mesh, that is, a grid-like structure consisting of a number of points (vertices), x5\u00f0x; y; z\u00de, connected by edges. This mesh is then deformed using a force-field that gradually shrinks to the generated shape's outer boundary and pushing on vertices that it touches on the way. The deformation of the cloth takes place in 3D with a ground plane limiting movements in a negative z-direction. In the end, the cloth object will have an outer boundary that corresponds to the generated shape, but the vertices that make up the central part of the mesh will be pushed to produced wrinkles and folds. The cloth simulation is an iterative physics simulation where each vertex in the cloth mesh is given acceleration depending on outer forces that affect it as well as inner forces decided by the distances to its neighbors. One iteration of the simulation is called a time-step. The index t gives the time that has passed as the initiation of the simulation, and Dt is used to indicate how much time is increased between iterations. At each iteration, a vertex's new position, x t1Dt , is calculated using the Verlet integration (26),",
            "ref_spans": [
                {
                    "type": "bibr",
                    "ref_id": "b24",
                    "start": 158,
                    "text": "(25)",
                    "end": 162
                },
                {
                    "type": "bibr",
                    "ref_id": "b25",
                    "start": 1377,
                    "text": "(26)",
                    "end": 1381
                }
            ]
        },
        {
            "section": "z\u00f0k\u00de5x\u00f0k\u00de1iy\u00f0k\u00de",
            "text": "where v 0 t is the acceleration of the vertex after previous iteration."
        },
        {
            "section": "z\u00f0k\u00de5x\u00f0k\u00de1iy\u00f0k\u00de",
            "text": "When the cloth mesh has undergone deformation, a surface render is performed to get a base texture for the  "
        },
        {
            "section": "Original Article",
            "text": "cytoplasm. The cloth simulation process has been illustrated in Figure 6. Note that through the simulation process, a naturally looking folding pattern has been created at the edge of the cytoplasm shape which propagates into the central part of the cytoplasm phantom.",
            "ref_spans": [
                {
                    "type": "figure",
                    "start": 64,
                    "text": "Figure 6",
                    "end": 72
                }
            ]
        },
        {
            "section": "Original Article",
            "text": "To finish the cytoplasm generation, three levels of details are added. Each of these are optional and can be excluded if sample specifications dictate it. The first level is a low frequency Gaussian noise that adds intensity variations to the texture. The second level is composed of thresholded Brownian noise, which is a correlated noise whose power spectrum decreases as a function of f 2 . This noise appears as clouds of small flecks that are unevenly distributed over the cytoplasm, which corresponds to, for superficial squamous cells, fairly commonly seen keratin precursors. The final level of detail entails the simulation of a cytoskeleton structure. The skeleton is generated by first generating a random Voronoi diagram by randomly placing points in an image. The diagram is relaxed using Lloyd's algorithm (27) to get a more evenly spaced point distribution. A radial distance transform is generated from the edge of the image to create a downward slope from the middle of the image to the edges. Random vertices of the Voronoi diagram are then selected and a line is created by following the edges of the diagram by steepest descent according to the distance transform. A random chance of branching at each vertex results in a random tree structure that is very similar in appearance to cytoskeletons observed in reference images. In Figure 7, the three levels of details that can be added to the cytoplasm base texture have been illustrated as well as an example of a finished textured cytoplasm.",
            "ref_spans": [
                {
                    "type": "bibr",
                    "ref_id": "b26",
                    "start": 820,
                    "text": "(27)",
                    "end": 824
                },
                {
                    "type": "figure",
                    "ref_id": "fig_5",
                    "start": 1349,
                    "text": "Figure 7",
                    "end": 1357
                }
            ]
        },
        {
            "section": "Population Distribution Generation",
            "text": "The distribution of generated objects is an important factor of the simulated image generation process. The simplest approach to generating a coordinate pair, (x, y), for an image with dimensions (M, N) is to draw the coordinates from a uniform distribution, U(a, b) where a and b describes the interval,"
        },
        {
            "section": "Population Distribution Generation",
            "text": "x5U \u00f00; M\u00de y5U \u00f00; N\u00de:"
        },
        {
            "section": "Population Distribution Generation",
            "text": "The problem with this approach is that populations generated using this method will not look natural. Objects in bio-logical samples tend to end up in more concentrated groups (28). The problem of population generation has previously been studied as described in (4) and (29) showing meaningful results. For this study, we have instead chosen to use a different approach, a method known as rejection sampling (30), in computer graphics also known as Russian Roulette Monte Carlo sampling (31), to generate our distributions. The basic concept behind rejection sampling is that a coordinate pair drawn from a uniform distribution is accepted with a probability W x,y , where W 5\u00bdw i;j M3N ; w i;j 2 \u00bd0; 1. We call W a weight-map and a distribution created using W a weighted distribution. New coordinate pairs are drawn until a specified number of coordinates have been accepted. This approach is simple to use and produce good results as long as W contains large enough areas with a relatively high probability score. For weight-maps, where all positions have a low probability the algorithm will take a long time to execute as the rejection rate will be high. However, with proper understanding of the method's limitations the approach works exceedingly well.",
            "ref_spans": [
                {
                    "type": "bibr",
                    "ref_id": "b27",
                    "start": 176,
                    "text": "(28)",
                    "end": 180
                },
                {
                    "type": "bibr",
                    "ref_id": "b3",
                    "start": 263,
                    "text": "(4)",
                    "end": 266
                },
                {
                    "type": "bibr",
                    "ref_id": "b28",
                    "start": 271,
                    "text": "(29)",
                    "end": 275
                },
                {
                    "type": "bibr",
                    "ref_id": "b29",
                    "start": 409,
                    "text": "(30)",
                    "end": 413
                },
                {
                    "type": "bibr",
                    "ref_id": "b30",
                    "start": 488,
                    "text": "(31)",
                    "end": 492
                }
            ]
        },
        {
            "section": "Population Distribution Generation",
            "text": "The addition of W gives us the ability to control how generated objects are distributed over an image. There are many benefits to this approach. The weight-map allows us to both customize the distribution, perhaps in an attempt to match the distribution of a specific sample image, and create random distributions with certain characteristics, for example, single cluster, multiple clusters, or perhaps a swath of material across the image. Examples of weighted distributions can be seen in Figure 8. In our present study, we have only used these possibilities to a limited extent generating some simple distribution patterns.",
            "ref_spans": [
                {
                    "type": "figure",
                    "ref_id": "fig_6",
                    "start": 491,
                    "text": "Figure 8",
                    "end": 499
                }
            ]
        },
        {
            "section": "Debris Object Generation",
            "text": "As has been previously stated, and illustrated in Figure 1, debris objects are a common problem when developing any kind of analysis algorithm. In the following sections, the types of debris that have been added to the simulation will be described in more detail.",
            "ref_spans": [
                {
                    "type": "figure",
                    "ref_id": "fig_0",
                    "start": 50,
                    "text": "Figure 1",
                    "end": 58
                }
            ]
        },
        {
            "section": "Debris Object Generation",
            "text": "White blood cells. White blood cells (WBC), or leukocytes, are a typical indication of an inflammation of the cervix. They usually appear as dark elliptical objects, often clustered together in small groups spread over the image. In the case of more serious cases of inflammation, larger sheets of WBC can be found, often obscuring significant sections of a sample. Figure 6. Illustration depicting the steps of the cloth simulation process: (a) Initial shape generated according to method described in Shape generation section that is used as the target for the deformation, (b) Initial cloth mesh prior to any deformation, (c) cloth mesh after deformation, and (d) final rendered result produced by adding a transparent material to the mesh.  In Figure 9, the steps of the WBC phantom generation have been illustrated. The simulation process is divided in two main steps: the creation of each cell and the construction of clusters. For cell shape generation, we have used a parametric model previously used by Lehmussola et al. (4). The shape of a cell is based on the parametric form of a circle, where each coordinate pair is written as \u00f0x\u00f0h\u00de; y\u00f0h\u00de\u00de and generated by x\u00f0h\u00de5cos\u00f0h\u00de y\u00f0h\u00de5sin\u00f0h\u00de (6) where h 2 \u00bd0; 2p is the polar angle. Perturbations to the vertices of the shape are added by",
            "ref_spans": [
                {
                    "type": "figure",
                    "start": 366,
                    "text": "Figure 6",
                    "end": 374
                },
                {
                    "type": "figure",
                    "ref_id": "fig_7",
                    "start": 748,
                    "text": "Figure 9",
                    "end": 756
                },
                {
                    "type": "bibr",
                    "ref_id": "b3",
                    "start": 1030,
                    "text": "(4)",
                    "end": 1033
                },
                {
                    "type": "bibr",
                    "ref_id": "b5",
                    "start": 1195,
                    "text": "(6)",
                    "end": 1198
                }
            ]
        },
        {
            "section": "Debris Object Generation",
            "text": "for i 5 1, . . ., K, where K is the number of boundary points, a; b 2 R controls the range of values drawn from the uniform distribution and s is a scale parameter."
        },
        {
            "section": "Debris Object Generation",
            "text": "To distribute the generated objects in naturally looking clusters, we use the weighted distribution method described in the Population Distribution Generation section with randomly generated weight-maps. Finally, the leukocyte phantoms are textured using the common Perlin noise model (32).",
            "ref_spans": [
                {
                    "type": "bibr",
                    "ref_id": "b31",
                    "start": 285,
                    "text": "(32)",
                    "end": 289
                }
            ]
        },
        {
            "section": "Debris Object Generation",
            "text": "Bacilli. Bacilli are a fairly common occurrence in Pap-smear images, the most common kind being the Lactobacilli, or, as it is also known, D\u20ac oderlein's vaginal bacillus (33). They appear as simple, single line structures, and always in clusters of varying size.",
            "ref_spans": [
                {
                    "type": "bibr",
                    "ref_id": "b32",
                    "start": 170,
                    "text": "(33)",
                    "end": 174
                }
            ]
        },
        {
            "section": "Debris Object Generation",
            "text": "The simulation process for bacilli generation starts with the generation of randomly oriented short binary lines. These line segments are then clustered in the same way as described for the WBC generation in the end of White Blood Cells section."
        },
        {
            "section": "Debris Object Generation",
            "text": "Speckles. We will define speckles as point noise that is distributed in a uniform way across an image. The cause of a single speckle can vary, with common sources being dust, glass impurities, stain particles, or other small biological objects. Regardless of the source, however, they are very similar in their appearance and can thus be grouped together as a single type of simulation. The base speckle is created as a single pixel that is then extended one pixel in a random direction. Depending on the size of speckles that is required for a specific simulation this shape can then be made bigger using binary dilation (3)."
        },
        {
            "section": "Debris Object Generation",
            "text": "Out of focus objects. It is common for images taken of Papsmears to contain objects that lie well outside the current focus plane. The source of these objects varies. Sometimes it is biological material such as cells, WBC clusters or mucus. Other times, the cause is dirt on the cover glass of the samples or air bubbles in the fixation liquid. These artifacts can take on many forms, and it is an ambitious task to try to simulate all of them. However, because they generally are placed so far outside the focus plane, their appearance is very blurred. To that end, we have created an out of focus (OOF) debris group where an object is created using the same parametric model and textured the same way as the WBC described in White Blood Cells section. These objects are then taken to be placed at a focus plane well outside the defined space and blurred accordingly (see Impulse response section)."
        },
        {
            "section": "Signal Transmission",
            "text": "The second phase of the image synthesis process is the simulation of light as it travels through the sample to the detector. Three primary factors of this problem have been considered for this project; background illumination specifications, how individual objects absorb the light, and finally the approximation of the impulse response function in three dimensions."
        },
        {
            "section": "Signal Transmission",
            "text": "Background illumination. Under perfect circumstances the background illumination should be a uniform function. This, however, is rarely the case. The most common kind of aberration for bright-field microscopy is uneven illumination, a low frequency light intensity variation over the field-of-view. Furthermore, for bright-field microscopy the light path has to pass through a glass slide. This will generate aberrations caused by the optical properties of glass as well as by scratches and dirt on the surface. To simulate these phenomena, two principal degradation steps have been added to the background generation process."
        },
        {
            "section": "Signal Transmission",
            "text": "The uneven illumination is simulated by calculating a distance transform, I d (x, y), initialized from the edge of the image. We scale the distance transform to [0,1] and add an "
        },
        {
            "section": "Signal Transmission",
            "text": "where the exponent, n, controls the strength of the variation. We can now add the second type of aberration which is related to light scattering in the slide. "
        },
        {
            "section": "Signal Transmission",
            "text": "The final step of the background generation is to calculate the logarithm of the generated image, I b \u00f0x; y\u00de5log 10 H\u00f0x; y\u00de2c pe I pe \u00f0x; y\u00de \u00c2 \u00c3 I d \u00f0x; y\u00de n \u00c0 \u00c1 :"
        },
        {
            "section": "Signal Transmission",
            "text": "This is done to facilitate the use of absorbance values, as will be explained in the following section."
        },
        {
            "section": "Signal Transmission",
            "text": "Absorbance. In bright-field microscopy an object's color is related to its light absorption properties. This behavior can be described using the well known Beer-Lambert law (34), which states that",
            "ref_spans": [
                {
                    "type": "bibr",
                    "ref_id": "b33",
                    "start": 173,
                    "text": "(34)",
                    "end": 177
                }
            ]
        },
        {
            "section": "Signal Transmission",
            "text": "where A k is the material's absorbance at a specific wavelength, k, of incoming light, I 0 is the intensity of the light before it passes through the sample, and I 1 is the intensity of light that remains after passing through the sample. Essentially, for the Pap-smear application, the Beer-Lambert law relates the absorbance of the Pap-stain to its concentration"
        },
        {
            "section": "Signal Transmission",
            "text": "where k is a constant commonly referred to as the extinction coefficient (a characteristic of the dye), c is the concentration of the dye, and l is the length of the light path. For the simulation, each object type is given a specific absorbance value. These values can be directly based on measurements taken from source materials or selected based on a specific desired target appearance. In this project, we measured representative values from our cellular database. Impulse response. The shape of the PSF for a specific bright-field microscopy setup is dependent on the NA of the objective used, the refractive index of the medium between the sample and the objective lens and the wavelength, k, of the image forming light (6). Trying to mathematically determine the precise degenerative effects of the PSF for specific hard-ware specifications can be exceedingly difficult. For this study, we have instead chosen to simplify the process by approximating the impulse response function with a Gaussian function, G r . Furthermore, for simplicity and speed, we have elected to separate the blurring process into a depth of focus blurring, G Dz , and an image plane blurring, G Dx,y .",
            "ref_spans": [
                {
                    "type": "bibr",
                    "ref_id": "b5",
                    "start": 727,
                    "text": "(6)",
                    "end": 730
                }
            ]
        },
        {
            "section": "Signal Transmission",
            "text": "Because of the availability of focus stacks as reference data, we have been able to quantifiably determine a suitable standard deviation for the Gaussian kernel related to the depth of focus. This was achieved by first studying a nucleus at the focus level at which it is in focus. This level was determined by summing the gradient magnitude values within the cell nuclei for all focus levels and choosing the level with the greatest sum. We can then compare each offset step in the focus stack to a Gaussian blurred version of the focused image, allowing us to decide which sigma yields a degradation that lies closest to the observed one. The quantification is achieved by taking the sum of the intensity difference for each pixel of the nucleus. In Figure 10, a plot showing the optimal ratio r/mm, relative to each focus level offset can be seen for a sample cell. The same experiment was carried out for a representative population of 10 different cells. For small focus offsets, it is, due to discretization issues, hard to get reliable measurements. However, for offsets >1 mm it becomes apparent that a reasonable approximation of the impulse response in the z-direction is r ' d z , where d z is the z-offset in mm.",
            "ref_spans": [
                {
                    "type": "figure",
                    "ref_id": "fig_0",
                    "start": 752,
                    "text": "Figure 10",
                    "end": 761
                }
            ]
        },
        {
            "section": "Signal Transmission",
            "text": "The impulse response in the image plane is more difficult to approximate quantifiably. Generally, the PSF is smaller in the x-y dimension relative to the z-dimension, r x;y < r z . By taking an image depicting a step function, that is, a sharp edge, and studying the first derivative of that image, it is possible to obtain an approximation of the PSF that lies close to reality. The measured PSF can then be compared to Gaussian kernels with different sigma to find the closest match. Using this approach, a suitable value for r x,y for the model system used in this project was found to be 0.9 pixels corresponding to around 0.22 microns."
        },
        {
            "section": "Signal Detection and Digitalization",
            "text": "The most commonly used type of imaging sensor within microscopy is the charged coupled device (CCD) sensor. These sensors operate using a linear transfer function, that is, the output signal for each pixel is proportional to the number of photons it receives. Optical imaging sensors have, as has been previously stated, certain limitations. The dominant source of noise in sensors, known as photon noise, is related to the fact that the number of photons emitted from a constant light source over a finite time interval is stochastic. Under normal operating conditions, this noise is Poisson distributed and quite easy to simulate. A second type of sensor noise significant enough to be added to the simulation is called readout noise that is a product of phenomena related to the A/D converter and amplification circuits. This noise behaves as additive white Gaussian noise (35).",
            "ref_spans": [
                {
                    "type": "bibr",
                    "ref_id": "b34",
                    "start": 876,
                    "text": "(35)",
                    "end": 880
                }
            ]
        },
        {
            "section": "Final Image Formation",
            "text": "The formation of the final simulated image, I f , can be written as I f \u00f0x; y\u00de5g po 10 I b \u00f0x;y\u00de2Ip\u00f0x;y\u00de \u00f0 \u00de \u00c3 G rx;y 1g g (13) where g po and g g constitute the addition of Poisson and Gaussian noise, respectively, (*) denotes a convolution operation, G rx;y stands for the approximation of the PSF with a Gaussian kernel with sigma r x;y , I b \u00f0x; y\u00de is the background image generated by Eq. (10) and I p \u00f0x; y\u00de is a phantom image. The phantom image contains the set of N p phantom objects, P5fp 1 ; p 2 ; . . . ; p Np g. To simulate the depth of field, each object, p i , is assigned a z position, z i , using a median filtered Perlin noise image, scaled to encompass the desired depth in the image. The generation of the phantom image can then be written as a sum of phantom objects with appropriate amounts of out-of-focus blur,",
            "ref_spans": [
                {
                    "type": "bibr",
                    "ref_id": "b12",
                    "start": 123,
                    "text": "(13)",
                    "end": 127
                }
            ]
        },
        {
            "section": "Final Image Formation",
            "text": "The final step of the synthesis process is to remove some of the degenerative effects applied to the parts of the image displaying nucleus texture. Because the nucleus texture is a product of patch-based texture generation from source material, the texture has actually already been subjected to the degenerative effects of the optics and the sensor system. Therefore, the final image, I f (x, y) is updated according to"
        },
        {
            "section": "Final Image Formation",
            "text": "where C 0 is a feathered nucleus mask generated as"
        },
        {
            "section": "Final Image Formation",
            "text": "The feathering, or blurring, of the nucleus mask, C, prevents the creation of sharp, unnatural edges around the nucleus texture."
        },
        {
            "section": "EVALUATION",
            "text": "The quality and realism of the synthetic images which are generated through the described procedure needs to be evaluated. As we are generating images that can be visually inspected, a natural approach is to do a visual comparison between synthetic and real images. This approach also seems relevant since the most common way of analyzing Pap-test specimens is through visual inspection. In designing such a test, it becomes important to have realistic conditions for the visual inspection. Given unlimited time and the possibility of zooming and scrolling the images, it is in most cases possible to find out which image is real and which is synthetic. But, this is far from the conditions under which this kind of images normally are scrutinized."
        },
        {
            "section": "EVALUATION",
            "text": "We have, therefore, designed a customized evaluation test. The experimental design was inspired by a study devised by Meyer et al. (36). In that study, users were asked to compare a real scene to an identical computer generated one. For the experiment, the subject was showed a tightly cropped view of the real and synthetic scene projected through a lightly frosted glass, to account for limitations of existing display devices. For our validation study, a simple user interface was designed. A patch of size 200 3 200 pixels, randomly selected, was cut out from an image that in turn was randomly selected from a database of images containing 25 synthetic images created with varying settings and 25 real images from different specimen. Before showing the image to the user, a pixel-wise Gaussian noise (r 5 0.7 graylevels) was added. This was done to make the variations in background intensity and smoothness between different real images less visually disturbing, making it easier to focus on the details in the images. The patch was shown to the test subject for 2 s, after which a nontimed prompt for an answer was displayed. In total, 120 patches were displayed to each user. However, the first two patches were training images used to get the user comfortable with the validation system and are not counted in the final result. The outcome of this study is discussed in Results section.",
            "ref_spans": [
                {
                    "type": "bibr",
                    "ref_id": "b35",
                    "start": 131,
                    "text": "(36)",
                    "end": 135
                }
            ]
        },
        {
            "section": "EVALUATION",
            "text": "Another approach to evaluating the quality of the synthetic image generation algorithms, is to compare results from an automated image cytometry algorithm applied to synthetic images and real data with expert annotated ground truth (4). Other validation approaches have included comparing results for several image cytometry tools when used on synthetic images (4) or comparing scores for different image descriptive features from synthetic and real images (12).",
            "ref_spans": [
                {
                    "type": "bibr",
                    "ref_id": "b3",
                    "start": 232,
                    "text": "(4)",
                    "end": 235
                },
                {
                    "type": "bibr",
                    "ref_id": "b11",
                    "start": 457,
                    "text": "(12)",
                    "end": 461
                }
            ]
        },
        {
            "section": "EVALUATION",
            "text": "Such tests can give valuable evaluations of whether the feature distributions obtained from the synthetic images are the same as those obtained from real ones. There are, however, problems in that many aspects of the synthetic images are generated from feature distributions extracted from real images. So, for many simple features such as nuclear size, we can obtain perfect agreement between normal and synthetic distributions. Another issue is the fact that manually obtaining a suitable ground truth dataset is, as has previously been discussed, a far from trivial task paired with many difficulties. We have as a complement to the visual evaluation made a comparison of the distribution of one nontrivial feature, the moments of the nuclear texture distribution. The choice is motivated by the fact that from a diagnostic perspective, the key structures in Pap-smear images are the nuclei and their chromatin structure. Following the approach taken by Svoboda et al. (5), a number of central moments as well as an entropy score was calculated for several real and synthetic nuclei. The n th central moment is calculated as",
            "ref_spans": [
                {
                    "type": "bibr",
                    "ref_id": "b4",
                    "start": 972,
                    "text": "(5)",
                    "end": 975
                }
            ]
        },
        {
            "section": "EVALUATION",
            "text": "where"
        },
        {
            "section": "EVALUATION",
            "text": "Here, z i is a discrete random variable denoting the particular intensity level present in the image. The sum covers the range of all the image intensity levels (L). The entropy defines the amount of uncertainty in the measured data and is calculated as"
        },
        {
            "section": "EVALUATION",
            "text": "Five central moments, n 52,. . .,6, as well as the entropy was calculated for a sample of 30 nuclei from real images and an equal number from synthetic images. From this, individual quantile-quantile (Q-Q) plots have been generated for each feature (Fig. 11). A Q-Q plot is a probability plot that compares two distributions by plotting their quantiles against each other (37). If the compared populations are drawn from similar distributions, the points should have an approximately linear relation.",
            "ref_spans": [
                {
                    "type": "figure",
                    "ref_id": "fig_0",
                    "start": 249,
                    "text": "(Fig. 11)",
                    "end": 258
                },
                {
                    "type": "bibr",
                    "ref_id": "b36",
                    "start": 372,
                    "text": "(37)",
                    "end": 376
                }
            ]
        },
        {
            "section": "RESULTS",
            "text": "An example of a finished synthetic image compared to a real image can be seen in Figure 12. The results of the visual evaluation can be seen in Table 1. Six test subjects have been used for the evaluation. The first (1) test subject is a cytologist with over 30 year experience of cervical smear screening. Test subjects 2-5 are cytometry algorithm developers with several year experiences from developing methods for automated Pap-smear analysis. The last test subject (6) is an algorithm developer with experience in life-science applications. This person had no experience with cytometry images and was included as a reference. Also for reference purposes, a random result subject (x) has been added to the result. For all subjects, the test was the first time they came into contact with the image generation method described in this article. All the subjects had prior experience with observing Pap-smear images in grayscale. For each user the number of true positives (TP), false positives (FP), true negatives (TN), and false negatives (FN) were counted. For this evaluation, a real image was counted as a positive and a synthetic image as a negative. Based on these values, the sensitivity, TP/(TP1FN), and specificity, TN/(TN1FP), for each user was also calculated. In this setting, the sensitivity value relates to the ability to accurately detect real images as being real and the specificity the ability to accurately detect synthetic images as synthetic. The sensitivity for the six human test subjects is not consistent with a random result (Mean: 0.7667, 95% confidence interval [0.671, 0.863]), but it is still low enough to indicate that experienced individuals had a difficult time separating real images from synthetic ones under these experimental conditions. The random assignment, \"subject x,\" achieved almost as good results as the actual persons, it deviated somewhat from the expected 0.50 in sensitivity and specificity as the population size was rather small. A different experimental design may have given different results. It is usually possible to tell the difference if you are given unlimited time and can zoom and scroll the image arbitrarily. But in routine cytology screening, the time available for this analysis is extremely limited so our conclusion is that our synthetic images are visually quite similar to real ones when studied under realistic conditions.",
            "ref_spans": [
                {
                    "type": "figure",
                    "ref_id": "fig_0",
                    "start": 81,
                    "text": "Figure 12",
                    "end": 90
                },
                {
                    "type": "table",
                    "ref_id": "tab_1",
                    "start": 144,
                    "text": "Table 1",
                    "end": 151
                }
            ]
        },
        {
            "section": "RESULTS",
            "text": "The Q-Q plot in Figure 11 show a distinct linear relationship between the synthetic and real nuclei for all features, indicating that, as is expected, the two populations are drawn from similar distributions. However, the angle of the linear dependency shows that the real data have a wider distribution than the synthetic data. This, again, is not surprising as each synthetic nucleus texture represents a combination of data from three real nuclei. The choice of using three nuclei as a sampling base stems from an effort to make the texture of the synthetic nuclei more general and not a scrambled copy of a single. This had the side effect of making the variation in the synthesized textures somewhat smaller than in the real ones. This effect would be reduced if we used a single real nucleus as a model for the texture of a synthetic one.",
            "ref_spans": [
                {
                    "type": "figure",
                    "ref_id": "fig_0",
                    "start": 16,
                    "text": "Figure 11",
                    "end": 25
                }
            ]
        },
        {
            "section": "RESULTS",
            "text": "We have generated a small population of synthetic images and also picked an equal number of real images and cropped those to the same size as the synthetic ones and supplied these two image datasets as Supporting Information allowing the reader to evaluate the similarities and differences between the images. These images can be found as a Supporting Information."
        },
        {
            "section": "DISCUSSION",
            "text": "In this article, we present a synthetic image generation framework for simulating bright-field microscopy images of cervical cell populations. The simulation method accurately models object primitives as well as the characteristics and behavior of the measurement system. In our evaluation study, even experienced cytology professionals showed rather poor performance in deciding whether an image was synthetic or real when shown the images under realistic screening conditions. A simple test on nuclear texture features indicated that they came from similar distributions."
        },
        {
            "section": "DISCUSSION",
            "text": "The presented framework offers a flexible approach to image synthesis. Each block of the process is interchangeable depending on the requirements on the finished results. Furthermore, if needed, additional object types can be added with minimal effort using the methods and principles described in Figure 11. Quantile-quantile plot comparison of descriptors computed from real and synthetic cervical cell nuclei. The quantile-quantile plot illustrate whether the acquired measurements belong to the same distribution. A linear relationship indicates that points belong to the same probability distribution. When the trend is steeper than 45 degrees, which is the case in the plots above, it is an indication that the data plotted on the y-axis, which refers to real data in this figure, has a larger dispersion than the x-axis data. this article. As an example, the addition of other common cervical epithelial cell types, for example, parabasal cells or squamous superficial cells, can be achieved by creating small databases of primitives that can then be used as the basis for shape and texture generation. To illustrate this, a dataset of cells, expert classified to exhibit signs conforming to high grade intraepithelial lesions, were collected and added to the simulation pipeline. A resulting image can be seen in Figure  13. This flexibility indicates that the synthesis process could be adapted to mimic other types of cellular material commonly analyzed using bright-field microscopy, for example, lung or oral cavity smears.",
            "ref_spans": [
                {
                    "type": "figure",
                    "ref_id": "fig_0",
                    "start": 298,
                    "text": "Figure 11",
                    "end": 307
                },
                {
                    "type": "figure",
                    "ref_id": "fig_0",
                    "start": 1321,
                    "text": "Figure  13",
                    "end": 1331
                }
            ]
        },
        {
            "section": "DISCUSSION",
            "text": "For the time being, the method produces one diagnostic cell type (squamous intermediate) and four levels of debris. In the future, more cell types and other types of debris should be added. Also, other common types of distortion such as folding should be included to the cytoplasm model to add even more variety in the shapes that are produced. The greatest benefit with the use of simulated images is the availability of ground truth. Using simulated images reduces the dependency on manually generated ground-truth data, which has the drawback of being expensive and time consuming to produce."
        },
        {
            "section": "DISCUSSION",
            "text": "Well-designed synthetic images make it possible to reserve that valuable ground truth data for final control validation. For instance, first the endless supply of synthetic data can be used to form hypotheses about how varying amount of debris or inhomogeneous background illumination will affect the qualitative performance of a segmentation algorithm. Then brute force parameter tuning, over an arbitrary large parameter space, can point out optimal parameters, a plausible range of optimal parameters or relations and dependence between different optimal parameter settings from which the algorithm designer can gain insight and form hypotheses. Then finally, a rigorous and more data economical procedure can be used for fine tuning and cross-validation on expert annotated real data to estimate the performance of an algorithm on real life data."
        },
        {
            "section": "DISCUSSION",
            "text": "It is important to recognize the fact that, while synthetic images can function as a great development tool, problems Figure 12. An example of a finished synthetic image (Left) an a real image for comparison (Right). Results are shown for the six test subjects (1-6) and a random result (x). The results show the number of true positives (TP), the number of false positives (FP), the number of true negatives (TN), and the number of false negatives (FN). From these numbers, the sensitivity TP/(TP1FN) and specificity TN/(TN1FP) have also been calculated. such as overfitting need to be taken into account. Because synthetic images are the result of their defining parameters, there exists a limitation in the variation present in the images. Good design can, to a certain extent, alleviate the problem, but the fact remains that real data remains a necessity in the creation of any image processing algorithm aimed at real world applications. However, one can compare the risk of overfitting synthetic data with the risks of overfitting when tuning algorithms with the help of small amounts of real ground truth data. We can benefit from the great flexibility of synthetic data, while at the same time guarantee an estimate on real data if proper cross-validation is performed for the final parameter tuning using real expert annotated data.",
            "ref_spans": [
                {
                    "type": "figure",
                    "ref_id": "fig_0",
                    "start": 118,
                    "text": "Figure 12",
                    "end": 127
                }
            ]
        },
        {
            "section": "Figure 1 .",
            "text": "A selection of artifacts that commonly occur in bright-field microscopy images of Pap-smears. From top to bottom: bacilli (small linear objects), WBC (small dark elliptical objects), dye specks, and OOF objects."
        },
        {
            "section": "Figure 2 .",
            "text": "Figure 2. A flowchart depicting the simulation framework described in this article. The simulation process is divided into three phases. In the first phase shape primitives, phantoms, are created. These objects include cell nuclei, cell cytoplasms, bacilli, WBC, OOF objects, and speckles. Once the primitives are created they are distributed over the image using a weighted distribution model. Also, each object is given a depth coordinate. In the second phase image degradation similar t p , the one seen in bright-field microscopes is simulated. Finally, in phase 3, sensor noise is simulated according to the characteristics of a CCD sensor."
        },
        {
            "section": "Figure 3 .",
            "text": "Examples of nucleus and cytoplasm shapes created using the FSD method."
        },
        {
            "section": "Figure 4 .",
            "text": "Conceptual illustration of patch-based texture synthesis. (Left) Sample image. (Middle) Patch evaluation based on the distance between the overlap region of two patches. (Right) Finished synthesized texture. [Color figure can be viewed in the online issue, which is available at wileyonlinelibrary.com.]"
        },
        {
            "section": "Figure 5 .",
            "text": "Nucleus texture generation. (Top row) The three nuclei used as texture samples. (Bottom row) Generated nucleus texture and final generated nucleus."
        },
        {
            "section": "Figure 7 .",
            "text": "(Left) The three levels of texture details (Low frequency Gaussian noise, thresholded Brownian noise, simulated cytoskeleton shape). (Right) Example of a final cytoplasm result (for this example a different base texture than the one shown inFig. 6has been used)."
        },
        {
            "section": "Figure 8 .",
            "text": "Result of weighted distribution generation. Two weight-maps (top) and their resulting distributions (bottom)."
        },
        {
            "section": "Figure 9 .",
            "text": "The creation process of leukocyte clusters. (Left) Shapes generated using parametric model. (Middle) Shape masks added to the final cluster. (Right) The final result with added Perlin noise. exponent, I d (x, y) n . The background is initialized as a uniform image, H(x, y), with a predefined intensity, H(x, y) 5 b. The perturbed background illumination can then be written as I b \u00f0x; y\u00de5H\u00f0x; y\u00deI d \u00f0x; y\u00de n ;"
        },
        {
            "section": "Figure 10 .",
            "text": "(Top) Nucleus at its focus level (Left) and its actual degeneration at a 1.2-mm offset (Middle image), compared to a Gaussian degeneration with r 5 1.2 (Right image). (Bottom) Plot discerning optimal ratio for r relative to the z-offset (lm) as a function of the z-offset for specific offsets."
        },
        {
            "text": "The descriptors shown above are: (Top row, left to right) second central moment, third central moment, and fourth central moment. (Bottom row, left to right) Fifth central moment, sixth central moment, and entropy. [Color figure can be viewed in the online issue, which is available at wileyonlinelibrary.com.]"
        },
        {
            "section": "Figure 13 .",
            "text": "Example of two simulated cells corresponding to high grade lesions added to the simulation framework."
        },
        {
            "section": "Table 1 .",
            "text": "Results of evaluation of the generated synthetic images"
        },
        {
            "section": "Table 1 .",
            "text": "Cytometry Part A 87A: 212\u00c0226, 2015"
        },
        {
            "section": "AVAILABILITY",
            "text": "The synthesis framework described in this article is available on the MATLAB file-exchange, at http://www.mathworks. com/matlabcentral/fileexchange/48915-synthetic-bright-fieldmicroscopy-image-generator, as an open-source code package on publication acceptance."
        },
        {
            "section": "ACKNOWLEDGMENTS",
            "text": "The authors would like to thank the participants of the user study. The work was carried out within the framework of a collaboration with a research project at the Center for "
        }
    ]
}