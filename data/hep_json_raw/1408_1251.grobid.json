{
    "level": "paragraph",
    "abstract": [
        {
            "text": "The determination of track reconstruction efficiencies at LHCb using J/\u03c8 \u2192 \u00b5 + \u00b5 \u2212 decays is presented. Efficiencies above 95% are found for the data taking periods in 2010, 2011, and 2012. The ratio of the track reconstruction efficiency of muons in data and simulation is compatible with unity and measured with an uncertainty of 0.8 % for data taking in 2010, and at a precision of 0.4 % for data taking in 2011 and 2012. For hadrons an additional 1.4 % uncertainty due to material interactions is assumed. This result is crucial for accurate cross section and branching fraction measurements in LHCb.",
            "paragraph_rank": 2,
            "section_rank": 1
        }
    ],
    "body_text": [
        {
            "text": "Introduction",
            "section_rank": 2
        },
        {
            "section": "Introduction",
            "text": "The track reconstruction efficiency is an important quantity in many physics analyses, especially those that aim at measuring a production cross section or a branching fraction. The uncertainty on the track reconstruction efficiency was a source of large systematic uncertainties with early LHCb data [1]. The method presented in this paper has significantly reduced this uncertainty for recent measurements [2].",
            "paragraph_rank": 3,
            "section_rank": 2,
            "ref_spans": [
                {
                    "type": "bibr",
                    "ref_id": "b0",
                    "start": 301,
                    "text": "[1]",
                    "end": 304
                },
                {
                    "type": "bibr",
                    "ref_id": "b1",
                    "start": 408,
                    "text": "[2]",
                    "end": 411
                }
            ]
        },
        {
            "section": "Introduction",
            "text": "In physics analysis, the track reconstruction efficiency is usually estimated with simulated events. To take possible differences between simulation and data into account, a data-driven correction procedure is applied. A clean sample of J/\u03c8 \u2192 \u00b5 + \u00b5 \u2212 decays is selected in data with a tag-and-probe approach. J/\u03c8 \u2192 \u00b5 + \u00b5 \u2212 decays are ideal candidates for efficiency measurements as -1 -",
            "paragraph_rank": 4,
            "section_rank": 2
        },
        {
            "text": "JINST 10 P02007",
            "section_rank": 3
        },
        {
            "section": "JINST 10 P02007",
            "text": "they are abundant, clean, and the decay products cover the momentum spectrum needed in most physics analyses in LHCb. The purity of the sample is enhanced by selecting J/\u03c8 from b-hadron decays. The tag track is fully reconstructed and is well identified as a muon. The probe track is only partially reconstructed, not using information from at least one subdetector which is probed. The track reconstruction efficiency is determined by checking for the existence of a fully reconstructed track corresponding to the probe track as this allows to determine the efficiency of the subdetector that is not used in the reconstruction of the probe track. It is calculated as a function of the momentum of the probe track, p, its pseudorapidity, \u03b7, and the track multiplicity of the event, N track . These are chosen because the efficiency is most affected by them. No strong dependence on the polar angle \u03c6 is observed. The main result of this paper is the track reconstruction efficiency ratio between data and simulation for prompt tracks and tracks from B and D mesons. This ratio is used in physics analyses to correct the track reconstruction efficiency in simulated events and to determine its uncertainty. The measurement is performed on several data samples to meet the requirements of the analyses performed at LHCb. In this paper, the results are presented for the three data samples from run I, corresponding to different running conditions, proton-proton (pp) centreof-mass energies and integrated luminosities: data taken in 2010 at \u221a s = 7 TeV corresponding to 29 pb \u22121 , data taken in 2011 at \u221a s = 7 TeV corresponding to 1 fb \u22121 , and data taken in 2012 at \u221a s = 8 TeV corresponding to 2 fb \u22121 . The 2010 results are valid for the full 2010 data set, corresponding to a luminosity of 37 pb \u22121 , since the same running conditions and track reconstruction were used throughout this period.",
            "paragraph_rank": 5,
            "section_rank": 3
        },
        {
            "text": "Detector and software description",
            "section_rank": 4
        },
        {
            "section": "Detector and software description",
            "text": "The LHCb detector [3] is a single-arm forward spectrometer covering the pseudorapidity range 2 < \u03b7 < 5, designed for the study of particles containing b or c quarks. The detector includes a high-precision tracking system consisting of a silicon-strip vertex detector, VELO [4], surrounding the pp interaction region; a large-area silicon-strip detector, TT [5], located upstream of a dipole magnet with a bending power of about 4 Tm; and three stations of silicon-strip detectors (Inner Tracker) [6] and straw drift tubes (Outer Tracker) [7] placed downstream of the magnet, called T stations. The tracking system provides a measurement of momentum, p, with a relative uncertainty that varies from 0.4% at low momentum to 0.6% at 100 GeV/c. The minimum distance of a track to a primary vertex (PV), the impact parameter (IP), is measured with a resolution of (15 + 29/p T ) \u00b5m, where p T is the component of p transverse to the beam, in GeV/c. The polarity of the dipole magnet is reversed periodically throughout data taking. The configuration with the magnetic field vertically upwards (downwards), bends positively (negatively) charged particles in the horizontal plane towards the centre of the LHC. Different types of charged hadrons are distinguished using information from two ring-imaging Cherenkov detectors, RICH1 and RICH2. Photon, electron, and hadron candidates are identified by a calorimeter system consisting of scintillating-pad and preshower detectors, an electromagnetic calorimeter, and a hadronic calorimeter. Muons are identified by a system composed of alternating layers of iron and multiwire proportional chambers [8]. The trigger [9] consists of a hardware stage, based on information from the calorimeter and muon systems, followed by a software stage, which applies a full event reconstruction.",
            "paragraph_rank": 6,
            "section_rank": 4,
            "ref_spans": [
                {
                    "type": "bibr",
                    "ref_id": "b2",
                    "start": 18,
                    "text": "[3]",
                    "end": 21
                },
                {
                    "type": "bibr",
                    "ref_id": "b3",
                    "start": 273,
                    "text": "[4]",
                    "end": 276
                },
                {
                    "type": "bibr",
                    "ref_id": "b4",
                    "start": 357,
                    "text": "[5]",
                    "end": 360
                },
                {
                    "type": "bibr",
                    "ref_id": "b5",
                    "start": 496,
                    "text": "[6]",
                    "end": 499
                },
                {
                    "type": "bibr",
                    "ref_id": "b6",
                    "start": 538,
                    "text": "[7]",
                    "end": 541
                },
                {
                    "type": "bibr",
                    "ref_id": "b7",
                    "start": 1639,
                    "text": "[8]",
                    "end": 1642
                },
                {
                    "type": "bibr",
                    "ref_id": "b8",
                    "start": 1656,
                    "text": "[9]",
                    "end": 1659
                }
            ]
        },
        {
            "section": "Detector and software description",
            "text": "-2 -2015 JINST 10 P02007 In the simulation, pp collisions are generated using PYTHIA 6.4 [10] with a specific LHCb configuration [11]. Decays of hadronic particles are described by EVTGEN [12], in which final state radiation is generated using PHOTOS [13]. The interaction of the generated particles with the detector and its response are implemented using the GEANT4 toolkit [14,15] as described in ref. [16]. Hit inefficiencies, e.g. due to dead channels, are typically in the range 1-2% and are included in the simulation. Differences in the positioning of the sensors between data and simulation are at the level of 0.5 mm. Both effects have a negligible impact on the tracking efficiency. The simulated events used in this study are required to contain at least one J/\u03c8 \u2192 \u00b5 + \u00b5 \u2212 decay.",
            "paragraph_rank": 7,
            "section_rank": 4,
            "ref_spans": [
                {
                    "type": "bibr",
                    "start": 89,
                    "text": "[10]",
                    "end": 93
                },
                {
                    "type": "bibr",
                    "ref_id": "b10",
                    "start": 129,
                    "text": "[11]",
                    "end": 133
                },
                {
                    "type": "bibr",
                    "ref_id": "b11",
                    "start": 188,
                    "text": "[12]",
                    "end": 192
                },
                {
                    "type": "bibr",
                    "ref_id": "b12",
                    "start": 251,
                    "text": "[13]",
                    "end": 255
                },
                {
                    "type": "bibr",
                    "start": 376,
                    "text": "[14,",
                    "end": 380
                },
                {
                    "type": "bibr",
                    "start": 380,
                    "text": "15]",
                    "end": 383
                },
                {
                    "type": "bibr",
                    "start": 405,
                    "text": "[16]",
                    "end": 409
                }
            ]
        },
        {
            "section": "Detector and software description",
            "text": "Differences in the response of the detectors in simulation and data could potentially lead to a different behaviour of the track reconstruction. The hit efficiencies have been measured in data using tracks. For the different subdetectors, they range from 98-100%. Dead channels are included in the simulation, using an average over the data taking period. From simulations it is known that the (high) hit efficiency does not have any impact on the track reconstruction, as the algorithms have been written to be robust against small hit inefficiencies. The size of the sensitive detector elements are known very accurately and the positioning of the sensitive elements in the simulation is accurate at the level of 0.5 mm. Compared to the overall size of the tracking system, any inaccuracy at this level has negligible impact on the acceptance of the detector.",
            "paragraph_rank": 8,
            "section_rank": 4
        },
        {
            "text": "Track reconstruction at LHCb",
            "section_rank": 5
        },
        {
            "section": "Track reconstruction at LHCb",
            "text": "Owing to the design of the LHCb detector, which consists of tracking detectors mainly outside the magnetic field, charged particle tracks are in approximation straight line segments in the upstream part (VELO and TT) and in the downstream part (T stations). Figure 1 shows an overview of the different track types defined in the LHCb reconstruction: VELO tracks, which have hits in the VELO; upstream tracks, which have hits in the two upstream trackers; T tracks, which have hits in the T stations; downstream tracks, which have hits in TT and the T stations; and long tracks, which have hits in the VELO and the T stations. The latter tracks can additionally have hits in TT.",
            "paragraph_rank": 9,
            "section_rank": 5,
            "ref_spans": [
                {
                    "type": "figure",
                    "ref_id": "fig_0",
                    "start": 258,
                    "text": "Figure 1",
                    "end": 266
                }
            ]
        },
        {
            "section": "Track reconstruction at LHCb",
            "text": "If a particle is reconstructed more than once, as different track types, only the track best suited for analysis purposes is kept. Hereby, long tracks are preferred over any other track type, upstream tracks are preferred over VELO tracks, and downstream tracks are preferred over T tracks. The -3 -number of unique tracks in an event, N track , is used in this study as a measure for the event multiplicity; it is strongly correlated with the number of hits in the tracking detectors. The number of tracks is chosen over the number of hits in a tracker to give a balanced measure of the upstream and the downstream occupancy.",
            "paragraph_rank": 10,
            "section_rank": 5
        },
        {
            "section": "Track reconstruction at LHCb",
            "text": "The reconstruction of long tracks starts with a search for VELO tracks [17,18]. VELO tracks are reconstructed exploiting the fact that tracks form straight lines due to the absence of a magnetic field in the VELO. Two algorithms promote these VELO tracks to long tracks. The first algorithm, called forward tracking [19], combines VELO tracks with hits in the three T stations. For a given VELO track and a single hit in one of the T stations the momentum is fixed, enabling the algorithm to project hits in the T stations along the trajectory. Hits which form clusters in the projection are used to define the final long track. In the second algorithm, called track matching [20,21], long tracks are made combining VELO tracks with T tracks, which are found by a standalone track finding algorithm [22].",
            "paragraph_rank": 11,
            "section_rank": 5,
            "ref_spans": [
                {
                    "type": "bibr",
                    "start": 71,
                    "text": "[17,",
                    "end": 75
                },
                {
                    "type": "bibr",
                    "start": 75,
                    "text": "18]",
                    "end": 78
                },
                {
                    "type": "bibr",
                    "ref_id": "b18",
                    "start": 316,
                    "text": "[19]",
                    "end": 320
                },
                {
                    "type": "bibr",
                    "ref_id": "b19",
                    "start": 676,
                    "text": "[20,",
                    "end": 680
                },
                {
                    "type": "bibr",
                    "ref_id": "b20",
                    "start": 680,
                    "text": "21]",
                    "end": 683
                },
                {
                    "type": "bibr",
                    "ref_id": "b21",
                    "start": 799,
                    "text": "[22]",
                    "end": 803
                }
            ]
        },
        {
            "section": "Track reconstruction at LHCb",
            "text": "If hits compatible with the long track trajectory are found in TT, they are added to the track to improve the momentum resolution and as discrimination against fake tracks. This procedure is identical for the forward tracking and the track matching.",
            "paragraph_rank": 12,
            "section_rank": 5
        },
        {
            "section": "Track reconstruction at LHCb",
            "text": "Most analyses use long tracks because they provide the best momentum and spatial resolution among all track types. Unless otherwise stated, track reconstruction at LHCb refers to the reconstruction of long tracks. In a typical signal triggered event in 2011 or 2012, around 60 long tracks are reconstructed. Other track types, such as downstream tracks [23], are used for the reconstruction of decay products of long-lived particles such as K 0 S mesons, or for internal alignment of the tracking detectors. They are reconstructed from T tracks, which are propagated back through the magnetic field to find corresponding hits in the TT stations.",
            "paragraph_rank": 13,
            "section_rank": 5,
            "ref_spans": [
                {
                    "type": "bibr",
                    "ref_id": "b22",
                    "start": 353,
                    "text": "[23]",
                    "end": 357
                }
            ]
        },
        {
            "section": "Track reconstruction at LHCb",
            "text": "The efficiency to reconstruct charged particles as long tracks is determined in two approaches. The first approach measures the track reconstruction efficiency in the VELO and in the T stations individually and combines these efficiencies to a single measurement. The second approach determines the efficiency to reconstruct a long track directly.",
            "paragraph_rank": 14,
            "section_rank": 5
        },
        {
            "text": "Tag-and-probe methods",
            "section_rank": 6
        },
        {
            "section": "Tag-and-probe methods",
            "text": "The tag-and-probe method uses two-prong decays, where one of the decay products, the \"tag\", is fully reconstructed as a long track, while the other particle, the \"probe\", is only partially reconstructed. The probe should carry enough momentum information that the invariant mass of the parent particle can be reconstructed with a sufficiently high resolution. The invariant mass of the two-prong decay allows for a discrimination against background. The track reconstruction efficiency for long tracks is then obtained by matching the partially reconstructed probe track to a long track. If a match is found, the probe track is defined as efficient. The three methods described below all use J/\u03c8 \u2192 \u00b5 + \u00b5 \u2212 decays, as the daughter particles have information in the muon system which can be exploited in the reconstruction of the probe track. The approaches, however, use different combinations of tracking detectors for the partial reconstruction of the probe track.",
            "paragraph_rank": 15,
            "section_rank": 6
        },
        {
            "text": "VELO method",
            "section_rank": 7
        },
        {
            "section": "VELO method",
            "text": "The track reconstruction efficiency in the VELO is measured using downstream tracks as probes, as illustrated in figure 2(a). A downstream track and a long track of the same muon do not necessarily -4 -2015 JINST 10 P02007  Figure 2. Illustration of the three tag-and-probe methods: (a) the VELO method, (b) the T-station method, and (c) the long method. The VELO (black rectangle), the two TT layers (short bold lines), the magnet coil, the three T stations (long bold lines), and the five muon stations (thin lines) are shown in all three subfigures. The upper solid blue line indicates the tag track, the lower line indicates the probe with red dots where hits are required and dashes where a detector is probed.",
            "paragraph_rank": 16,
            "section_rank": 7,
            "ref_spans": [
                {
                    "type": "figure",
                    "start": 224,
                    "text": "Figure 2",
                    "end": 232
                }
            ]
        },
        {
            "section": "VELO method",
            "text": "share all hits in the T stations. Therefore, a probe track is considered to be found as a long track if there is a long track with at least 50% common hits in the T stations. In simulated events the fraction of 50% common hits is found to be an appropriate and stable matching criterion.",
            "paragraph_rank": 17,
            "section_rank": 7
        },
        {
            "text": "T-station method",
            "section_rank": 8
        },
        {
            "section": "T-station method",
            "text": "The measurement of the track reconstruction efficiency in the T stations for particles that have VELO and muon segments is illustrated in figure 2(b). A dedicated algorithm reconstructs muons as straight tracks starting from hits in the last muon station, see for example refs. [24,25]. These are subsequently matched to VELO tracks.",
            "paragraph_rank": 18,
            "section_rank": 8,
            "ref_spans": [
                {
                    "type": "bibr",
                    "ref_id": "b23",
                    "start": 278,
                    "text": "[24,",
                    "end": 282
                },
                {
                    "type": "bibr",
                    "ref_id": "b24",
                    "start": 282,
                    "text": "25]",
                    "end": 285
                }
            ]
        },
        {
            "section": "T-station method",
            "text": "A long track is considered to be matched to a probe track if two requirements are met. Firstly, the probe track and the long track have to be reconstructed from the same VELO seed. Secondly, at -5 - Table 1. Settings of the software trigger selection as a function of data taking period. Only the tag muon is required to pass the selection. For more information see refs. [9,[26][27][28].",
            "paragraph_rank": 19,
            "section_rank": 8,
            "ref_spans": [
                {
                    "type": "table",
                    "start": 199,
                    "text": "Table 1",
                    "end": 206
                },
                {
                    "type": "bibr",
                    "ref_id": "b8",
                    "start": 372,
                    "text": "[9,",
                    "end": 375
                },
                {
                    "type": "bibr",
                    "ref_id": "b25",
                    "start": 375,
                    "text": "[26]",
                    "end": 379
                },
                {
                    "type": "bibr",
                    "ref_id": "b26",
                    "start": 379,
                    "text": "[27]",
                    "end": 383
                },
                {
                    "type": "bibr",
                    "ref_id": "b27",
                    "start": 383,
                    "text": "[28]",
                    "end": 387
                }
            ]
        },
        {
            "text": "2010",
            "section_rank": 9
        },
        {
            "section": "2010",
            "text": "2011 2012 2012 (first 0.7 fb \u22121 ) (remaining 1.3 fb \u22121 ) IP > 0.11 mm IP > 0.5 mm IP > 0.5 mm IP > 0.5 mm",
            "paragraph_rank": 20,
            "section_rank": 9
        },
        {
            "section": "2010",
            "text": "least two hits on the probe track in the muon stations have to be compatible with the extrapolation of the long track into the muon stations. It is found in simulated events that requiring two common hits in the muon stations is sufficient to ensure compatible trajectories of the long track and the VELO-muon probe track.",
            "paragraph_rank": 21,
            "section_rank": 9
        },
        {
            "text": "Long method",
            "section_rank": 10
        },
        {
            "section": "Long method",
            "text": "The long method uses probe tracks that have hits in the TT and in the muon stations as illustrated in figure 2(c). This method measures the efficiency to reconstruct long tracks because the longtrack-finding algorithms do not require the presence of TT hits. Therefore, the efficiency to find a long track is, to first order, independent of the efficiency to find such a TT-muon track. These (TT-muon) tracks are found by a dedicated reconstruction of tracks in the muon stations, which are subsequently matched to TT hits. A TT-muon track is considered to be reconstructed as a long track in case more than 70% of the hits in the muon stations are compatible with the extrapolation of the long track into the muon stations. In case the long track has TT hits, it needs to share at least 60% of the TT hits as well. These fractions have been optimised in simulation and the results are stable with respect to small differences in data and simulation.",
            "paragraph_rank": 22,
            "section_rank": 10
        },
        {
            "text": "Trigger and selection requirements",
            "section_rank": 11
        },
        {
            "section": "Trigger and selection requirements",
            "text": "The candidate decays are first required to pass a hardware trigger, which selects muons in the muon system with a transverse momentum, p T > 1.48 GeV/c, or dimuons where the product of the two transverse momenta is greater than p T1 \u00d7 p T2 > (1.296 GeV/c) 2 . In 2012 these thresholds have been raised to p T > 1.76 GeV/c and p T1 \u00d7 p T2 > (1.6 GeV/c) 2 , respectively. The reconstruction of both muons in the hardware trigger does not bias the determination of the track reconstruction efficiency since it does not use information from the tracking system (VELO, TT, and T stations). The subsequent software stage reconstructs the tag muon in the entire tracking system and in the muon system. The tag muon is required to have high p T , high p, large IP and \u03c7 2 IP with respect to all PVs in the event, where \u03c7 2 IP is defined as the difference in \u03c7 2 of a given PV reconstructed with and without the considered track. Furthermore, a good \u03c7 2 per degree of freedom (\u03c7 2 /ndf) of the trigger track fit is required. Different selection criteria are used during data taking as listed in table 1 to fit different data taking conditions. The IP and \u03c7 2 IP requirements restrict the sample to J/\u03c8 originating from b hadron decays. Only the tag muon is required to be reconstructed in the -6 - Table 2. Selection requirements on the tag and probe tracks and on the combination into a J/\u03c8 candidate for the three different methods. Long  method  method  method  Tag Long track used in single muon trigger",
            "paragraph_rank": 23,
            "section_rank": 11,
            "ref_spans": [
                {
                    "type": "bibr",
                    "ref_id": "b1",
                    "start": 256,
                    "text": "2",
                    "end": 257
                },
                {
                    "type": "bibr",
                    "ref_id": "b1",
                    "start": 352,
                    "text": "2",
                    "end": 353
                },
                {
                    "type": "bibr",
                    "ref_id": "b1",
                    "start": 762,
                    "text": "2",
                    "end": 763
                },
                {
                    "type": "table",
                    "start": 1289,
                    "text": "Table 2",
                    "end": 1296
                },
                {
                    "type": "table",
                    "start": 1426,
                    "text": "Long  method  method  method  Tag",
                    "end": 1459
                }
            ]
        },
        {
            "text": "VELO T-station",
            "section_rank": 12
        },
        {
            "section": "VELO T-station",
            "text": "software trigger in order to avoid any bias on the track reconstruction efficiency, caused by fully reconstructing the two-prong decay with two long tracks. Further selection criteria are applied as listed in table 2: the \u03c7 2 /ndf from the track fit of the tag tracks must be small to reduce the number of fake tracks. Tag tracks have to fulfil the standard muon selection, which requires hits in the muon stations in a search window around the track extrapolation as explained in ref. [29]. Both the tag and probe tracks have minimal p and p T requirements to remove badly reconstructed tracks and combinatorial background. In order to remove contamination from hadrons, the particle identification system is used. The differences between the logarithm of the likelihood of the tag to be a muon and to be a pion, DLL \u00b5\u03c0 , is computed and only tag tracks with a high DLL \u00b5\u03c0 are used. The range of the invariant mass of the \u00b5 + \u00b5 \u2212 combination, M \u00b5 \u00b5 , is chosen sufficiently large to estimate the background contribution from the mass sidebands. Finally, the \u03c7 2 /ndf from the vertex fit of the tag-and the probe-track has to be small, in order to remove combinatorial background; and the number of J/\u03c8 decays per event (N J/\u03c8 ) must be one, to simplify the association procedure described in the preceding subsections. Additionally, the T-station method only considers J/\u03c8 candidates with a momentum greater than 7 GeV/c, and the long method only J/\u03c8 candidates with an IP smaller than 0.8 mm, as both selections are effective in reducing background contamination without biasing the efficiency determination. After the full selection chain the sample amounts to about 6 000 decays for 2010 for the long and the T method, while for the VELO method 12 000 decays are selected. The 2011 and 2012 data samples comprise more than 300 000 decays in total for all methods and data taking periods.",
            "paragraph_rank": 24,
            "section_rank": 12,
            "ref_spans": [
                {
                    "type": "bibr",
                    "start": 486,
                    "text": "[29]",
                    "end": 490
                }
            ]
        },
        {
            "text": "Mass resolution",
            "section_rank": 13
        },
        {
            "section": "Mass resolution",
            "text": "To illustrate the mass resolutions that can be achieved, the dimuon invariant mass distributions from J/\u03c8 candidates in the three methods are shown in figure 3 using the 2011 data sample. The  ",
            "paragraph_rank": 25,
            "section_rank": 13
        },
        {
            "text": "Calculation of efficiency",
            "section_rank": 14
        },
        {
            "section": "Calculation of efficiency",
            "text": "The track reconstruction efficiency is calculated as the fraction of reconstructed J/\u03c8 decays where the probe track can be matched to a long track. To estimate the number of J/\u03c8 decays, an unbinned extended maximum likelihood fit is performed to the mass distributions. For the VELO and T-station methods the mass distributions are described by a single Gaussian function for the signal and an exponential function for the combinatorial background. This model is preferred over the aforementioned sum of two Gaussian functions to improve the fit stability when measuring the dependence of the track reconstruction efficiency on kinematic variables and other event parameters. For the long method, a Crystal Ball function [30] is used for the signal, to take the tail on the lefthand side of the mass peak into account. Since the number of decays in the 2010 data is relatively -8 -low, in this case a simple sideband subtraction is applied for the VELO and T-station methods. All shape parameters were allowed to vary in the fit for the denominator of the efficiency; they were constrained to the found values for the numerator of the efficiency. This procedure was performed to stabilise the fit, as no difference in the shape of the numerator and denominator could be observed. It has been checked that the choice of the model for the mass distribution has a negligible effect on the efficiency determination.",
            "paragraph_rank": 26,
            "section_rank": 14,
            "ref_spans": [
                {
                    "type": "bibr",
                    "ref_id": "b29",
                    "start": 721,
                    "text": "[30]",
                    "end": 725
                }
            ]
        },
        {
            "section": "Calculation of efficiency",
            "text": "The efficiencies obtained from the VELO and T-station methods are assumed to be uncorrelated, aside from effects due to dependencies on the track kinematics and the event multiplicity. The data sample is binned in kinematic variables and N track to combine the VELO and T-station efficiencies. The efficiencies obtained with the VELO and T-station methods can be multiplied in each bin to obtain the efficiency for finding long tracks. This combined efficiency can be compared with the efficiency found by the long method, giving two independent methods to probe the long track reconstruction efficiency.",
            "paragraph_rank": 27,
            "section_rank": 14
        },
        {
            "section": "Calculation of efficiency",
            "text": "There are, however, small differences between these two approaches. The long method measures the efficiency for tracks that pass through TT. In the combined method, only the VELO method requires this. Furthermore, both the VELO method and T-station method include the efficiency that, given that both the VELO and the T-station segment tracks are reconstructed, the corresponding long track is found. Therefore, in the combined efficiency, this so-called matching efficiency is counted twice. All these effects can lead to small differences in the measured longtrack efficiency. For this reason, the ratio between the efficiencies in data and simulation is used to compare the methods, as these uncertainties are common for simulated and real decays and cancel when the ratio of efficiencies is formed.",
            "paragraph_rank": 28,
            "section_rank": 14
        },
        {
            "section": "Calculation of efficiency",
            "text": "On simulated events the track reconstruction efficiency is commonly defined as the fraction of simulated charged particles with sufficient hits in the VELO and T stations that can be associated to a track that shares at least 70% of the hits in each participating subdetector with this particle. For all methods, this so-called hit-based efficiency in simulation agrees within 1% with the efficiency measured with the tag-and-probe methods. Furthermore the matching efficiency was determined to be very close to 100%. The very small matching inefficiency does not affect the agreement between the hit-based efficiency and the tag-and-probe based efficiency in simulation. By taking the ratio between the efficiencies on data and simulation, these discrepancies are reduced to a negligible level.",
            "paragraph_rank": 29,
            "section_rank": 14
        },
        {
            "text": "Efficiency dependencies",
            "section_rank": 15
        },
        {
            "section": "Efficiency dependencies",
            "text": "Using the momentum spectrum of the J/\u03c8 decay products obtained with the VELO method from data as a benchmark, the average track reconstruction efficiency for long tracks is measured to be (95.4 \u00b1 0.7)% for 2010 data, (97.78 \u00b1 0.07)% for 2011 data and (96.99 \u00b1 0.05)% for 2012 data. All results confirm the good performance of the LHCb tracking system. The uncertainties on these numbers are statistical only; they are binomial errors with additional terms to account for the statistical uncertainty on the number of background events. Systematic uncertainties are discussed in section 8. The difference in the efficiencies between the three years is a consequence of changes in the track reconstruction and the higher centre-of-mass energy, leading to a higher track multiplicity and hence lower reconstruction efficiency for the 2012 running period. Dependencies -9 - Table 3. Track reconstruction efficiencies in % for the individual running periods using the long method for positive and negative muons and different magnetic field polarities (statistical uncertainties only).",
            "paragraph_rank": 30,
            "section_rank": 15,
            "ref_spans": [
                {
                    "type": "table",
                    "start": 869,
                    "text": "Table 3",
                    "end": 876
                }
            ]
        },
        {
            "text": "Magnet up",
            "section_rank": 16
        },
        {
            "section": "Magnet up",
            "text": "Magnet on the polarity of the dipole magnet, the charge of the muons, and kinematic properties as well as the agreement with the simulation are investigated in further detail in the following subsections.",
            "paragraph_rank": 31,
            "section_rank": 16
        },
        {
            "text": "Comparison of magnetic field polarities",
            "section_rank": 17
        },
        {
            "section": "Comparison of magnetic field polarities",
            "text": "The track reconstruction efficiencies determined from the long method are split up into positively and negatively charged muons and into the two different magnetic field polarities (named up and down). The results are summarised in table 3. They show compatible numbers for magnetic field up and down and for positive and negative muons.",
            "paragraph_rank": 32,
            "section_rank": 17
        },
        {
            "section": "Comparison of magnetic field polarities",
            "text": "For data from 2011 and 2012 there is no difference between positive and negative muons or between the different magnet polarities. In 2010 data, a 2.3 \u03c3 difference between the different magnet polarities is observed for positive muons. No unambiguous source of the difference is found.",
            "paragraph_rank": 33,
            "section_rank": 17
        },
        {
            "text": "Dependencies of track reconstruction efficiency",
            "section_rank": 18
        },
        {
            "section": "Dependencies of track reconstruction efficiency",
            "text": "The efficiency to reconstruct long tracks mainly depends on the particle kinematics and the number of charged particles in an event. As a parametrisation p, \u03b7 and N track are chosen, as the track reconstruction efficiency shows the largest dependence on these three observables. The simulated events are weighted according to the N track distribution observed in data. The track reconstruction efficiencies for the combination of the VELO and T-station methods and for the long method are shown for the different data-taking periods in figures 4-6 as a function of p, \u03b7, N track , and as a function of the number of reconstructed primary vertices, N PV . The efficiency coming from the combination of the VELO and the T-station method is calculated by multiplying the individual efficiencies. Overall, a reasonable agreement is found between simulated and real data for all datataking periods. As the agreement between the tag-and-probe based track reconstruction efficiency and the true track reconstruction efficiency (based on hit information) is within 1%, the results shown in figures 4-6 give an accurate description of the efficiency in simulation.",
            "paragraph_rank": 34,
            "section_rank": 18
        },
        {
            "text": "Efficiency ratios",
            "section_rank": 19
        },
        {
            "section": "Efficiency ratios",
            "text": "The efficiency ratio is defined as the efficiency measured in data divided by the efficiency measured in simulation, ratio = \u03b5 data \u03b5 sim . (7.1)",
            "paragraph_rank": 35,
            "section_rank": 19
        },
        {
            "section": "Efficiency ratios",
            "text": "The efficiency dependence versus N track and N PV is reasonably well described in the simulation, see figures 4-6: when fitting a first-order polynomial to the efficiency distributions in simulation and real data, the slopes agree with each other within 2 standard deviations, except for the efficiency -10 -        as a function of the number of tracks in the combination of the VELO and T-station method in 2012. It is therefore sufficient to weight the simulated events to establish agreement in N track while the efficiency ratio is determined in bins of p and \u03b7. The number of bins is chosen to keep the statistical uncertainty in each bin sufficiently small. For the final result, the weighted average of the combined and long method is taken in each bin of p and \u03b7. Figure 7 shows the efficiency ratio versus p for run I, weighted by the event track multiplicity observed in data; the data are split into two ranges of \u03b7. Overall a good agreement of the track finding efficiency is found between events in simulation and in data for all data taking periods and most momenta and pseudorapidity regions. The difference between the track finding efficiencies is generally smaller than 1% between events from simulation and data and no trend can be observed for the 2011 and 2012 dataset, with the number of events being too low to draw conclusions from the 2010 dataset. The agreement is worse for tracks with momentum below 10 GeV/c, which might point to a less accurate modelling of multiple scattering effects in the simulation.",
            "paragraph_rank": 36,
            "section_rank": 19,
            "ref_spans": [
                {
                    "type": "figure",
                    "ref_id": "fig_7",
                    "start": 773,
                    "text": "Figure 7",
                    "end": 781
                }
            ]
        },
        {
            "section": "Efficiency ratios",
            "text": "The overall efficiency ratio and its uncertainty depend on the particle distribution of the data in terms of p and \u03b7. Using the momentum spectrum of the J/\u03c8 decay products obtained with the VELO method from data, an average efficiency ratio is found of 0.994 \u00b1 0.007 for 2010 data, 0.9983 \u00b1 0.0009 for 2011 data and 1.0053 \u00b1 0.0008 for 2012 data. The uncertainties represent the statistical uncertainties only. The ratio is close to one in all three cases as different features seen in the efficiency distributions in simulation and data average out when integrating over the full momentum spectrum or pseudorapidity range.",
            "paragraph_rank": 37,
            "section_rank": 19
        },
        {
            "section": "Efficiency ratios",
            "text": "-14 -",
            "paragraph_rank": 38,
            "section_rank": 19
        },
        {
            "text": "JINST 10 P02007",
            "section_rank": 20
        },
        {
            "section": "JINST 10 P02007",
            "text": "8 Systematic uncertainties Small differences in the ratio of efficiencies are seen when reweighting the simulated samples in different parameters such as the number of primary vertices, or the number of hits or tracks in the different subdetectors. The largest of these differences is taken as a systematic uncertainty and amounts to 0.4%. No systematic uncertainty is assigned for the agreement of the track reconstruction efficiency determined by the tag-and-probe method and the hit-based method (which is on the order of 1%), as the differences cancel when forming the efficiency ratio. Accordingly, no systematic uncertainties are assigned for the fit model as these cancel when forming the fraction of reconstructed J/\u03c8 decays where the probe can be matched to a long track. It has been checked that this is true for a range of fit models, the largest variation being 0.2%. Furthermore, no systematic uncertainty is assigned to the possible matching of a correctly reconstructed probe track to a fake long track, as the requirement for a large overlap in the subdetectors ensure that both reconstructed tracks are either real tracks or fake tracks, where the latter would not peak at the J/\u03c8 mass. No systematic uncertainty is assigned for the fact that the VELO + T-station method and the long method show slightly different results in figures 4-6, as both methods probe different momentum spectra and any residual difference will cancel when forming the ratio with simulation. No systematic uncertainty is assigned for the double-counting of the matching efficiency in the combined method, as this efficiency is very close to 100%, and any uncertainty would get further reduced when forming the ratio with simulation. No systematic uncertainty is assigned for the large difference for the VELO + T efficiency between simulation and data at low momenta in 2011 and 2012, as this is automatically taken into account when forming the ratio of efficiencies. Despite this difference, the integrated track reconstruction efficiencies between simulation and data are in agreement due to compensation of this effect for high momenta, where the efficiency is higher in simulation than in data.",
            "paragraph_rank": 39,
            "section_rank": 20
        },
        {
            "text": "Hadronic interactions",
            "section_rank": 21
        },
        {
            "section": "Hadronic interactions",
            "text": "The methods presented in this paper are based on muons and require that they reach the muon stations. Thus, these methods are not sensitive to the effects from hadronic interactions and largeangle scatterings with the detector material. For hadrons, the largest effect is due to hadronic interactions. The cross section depends on the particle type, charge and the momentum. A simulation of B 0 \u2192 J/\u03c8 K * 0 decays (where K * 0 \u2192 K + \u03c0 \u2212 ) shows that about 11% of the kaons (averaged over positive and negative kaons) and about 14% of the pions cannot be reconstructed due to hadronic interactions that occur before the last T station. This number depends primarily on the momentum of the particle. Due to the uncertainty on the material budget and consequently on the interaction with the detector material, the reconstruction efficiency obtained from simulation has an intrinsic uncertainty, which is not accounted for in the track reconstruction efficiencies measured with muons. When assuming that the total material budget in the simulation has an uncertainty of 10%, the systematic uncertainty due to hadronic interactions is between 1.1-1.4%. The 10% uncertainty is used as a conservative upper limit and is composed as follows: for the VELO a calculation in ref. [4] shows an uncertainty on the material budget of 6%. No direct measurements exist for the T and TT stations. However, weight measurements for the Inner Tracker for the silicon sensors -15 -and the detector boxes give an accuracy of 2%, while an agreement of 5% is reached for the cables and the support structure [31,32]. The Outer Tracker modules have been weighted and this measurement is precise to about 1% [33]. Furthermore, the sum of the weights of the individual components of a module adds up to the total weight of a module within the uncertainties. Taking into account that some level of detail is missing in the detector description in the simulation, an uncertainty of 5% is assumed for the outer tracker. Weight measurements for the sensor modules and the insulation material of TT have been performed. Given the detail of the detector description [34] an uncertainty of 5% on the material budget is well justified. The beam-pipe was implemented in the software following the design drawings, where a precision better than 10% for all pieces was confirmed following measurements after production. The solid radiator (aerogel) and the gas radiator (C 4 F 10 ) contribute more than two-third of the material budget for the RICH1 detector [35]. The amount of aerogel is known up to 2% and the differences between 2011 and 2012 are accounted for in the simulation. The density of the C 4 F 10 was monitored, with the RMS of the distribution being about 1%. The other components of RICH1 have a smaller contribution to the interaction length. The overall uncertainty of 10% for the full material budget was then chosen to also take uncertainties on the GEANT4 cross-sections and additional uncertainties, coming from simplified descriptions of the detector elements in the simulation, into account.",
            "paragraph_rank": 40,
            "section_rank": 21,
            "ref_spans": [
                {
                    "type": "bibr",
                    "ref_id": "b3",
                    "start": 1270,
                    "text": "[4]",
                    "end": 1273
                },
                {
                    "type": "bibr",
                    "ref_id": "b30",
                    "start": 1585,
                    "text": "[31,",
                    "end": 1589
                },
                {
                    "type": "bibr",
                    "ref_id": "b31",
                    "start": 1589,
                    "text": "32]",
                    "end": 1592
                },
                {
                    "type": "bibr",
                    "ref_id": "b32",
                    "start": 1683,
                    "text": "[33]",
                    "end": 1687
                },
                {
                    "type": "bibr",
                    "start": 2134,
                    "text": "[34]",
                    "end": 2138
                },
                {
                    "type": "bibr",
                    "ref_id": "b34",
                    "start": 2522,
                    "text": "[35]",
                    "end": 2526
                }
            ]
        },
        {
            "text": "Conclusion",
            "section_rank": 22
        },
        {
            "section": "Conclusion",
            "text": "Track reconstruction efficiencies at LHCb have been measured using a tag-and-probe method with J/\u03c8 \u2192 \u00b5 + \u00b5 \u2212 decays. The average efficiency is better than 95% in the momentum region 5 GeV/c < p < 200 GeV/c and in the pseudorapidity region 2 < \u03b7 < 5, which covers the phase space of LHCb. The uncertainty per track is below 0.5% for muons and below 1.5% for pions and kaons, where the larger uncertainty takes the uncertainty on hadronic interactions into account. All uncertainties have been added in quadrature. Furthermore, the ratio of the track reconstruction efficiency of muons in data and simulation is measured, where an uncertainty of 0.8 % for data collected in 2010 and an uncertainty of 0.4 % for data collected in 2011 and 2012 is achieved. The integrated efficiency ratios for all three years of data taking are compatible with unity. This result presents a significant improvement over the uncertainties determined with previous methods ranging from 3 to 4%.",
            "paragraph_rank": 41,
            "section_rank": 22
        },
        {
            "text": "Figure 1 .",
            "section_rank": 23
        },
        {
            "section": "Figure 1 .",
            "text": "Figure 1. Tracking detectors and track types reconstructed by the track finding algorithms at LHCb.",
            "paragraph_rank": 42,
            "section_rank": 23
        },
        {
            "text": "Figure 3 .",
            "section_rank": 24
        },
        {
            "section": "Figure 3 .",
            "text": "Figure 3. Invariant mass distributions for reconstructed J/\u03c8 candidates from the 2011 dataset. The solid line shows the fitted distribution for signal and background, the dotted line is the signal component. The subfigures are (a) the VELO method, (b) the T-station method, (c) the long method. For comparison of resolution and signal purity (d) shows the invariant mass distribution of J/\u03c8 candidates obtained with the standard reconstruction at LHCb.",
            "paragraph_rank": 43,
            "section_rank": 24
        },
        {
            "text": "Figure 4 .",
            "section_rank": 25
        },
        {
            "section": "Figure 4 .",
            "text": "Figure 4. Track reconstruction efficiencies for the 2010 data and for weighted simulation. The left-hand column shows the results of the combined method while the right-hand column shows the results of the long method. The efficiency is shown as a function of p (first row), \u03b7 (second row), N track (third row), and N PV (fourth row). The error bars indicate the statistical uncertainties.",
            "paragraph_rank": 44,
            "section_rank": 25
        },
        {
            "text": "Figure 5 .",
            "section_rank": 26
        },
        {
            "section": "Figure 5 .",
            "text": "Figure 5. Track reconstruction efficiencies for the 2011 data and for weighted simulation. The left-hand column shows the results of the combined method while the right-hand column shows the results of the long method. The efficiency is shown as a function of p (first row), \u03b7 (second row), N track (third row), and N PV (fourth row). The error bars indicate the statistical uncertainties.",
            "paragraph_rank": 45,
            "section_rank": 26
        },
        {
            "text": "Figure 6 .",
            "section_rank": 27
        },
        {
            "section": "Figure 6 .",
            "text": "Figure 6. Track reconstruction efficiencies for the 2012 data and for weighted simulation. The left-hand column shows the results of the combined method while the right-hand column shows the results of the long method. The efficiency is shown as a function of p (first row), \u03b7 (second row), N track (third row), and N PV (fourth row). The error bars indicate the statistical uncertainties.",
            "paragraph_rank": 46,
            "section_rank": 27
        },
        {
            "text": "Figure 7 .",
            "section_rank": 28
        },
        {
            "section": "Figure 7 .",
            "text": "Figure 7. Track reconstruction efficiency ratios as a function of p between data and simulation for (left) 2010 data, (right) 2011 data, and (bottom) 2012 data.",
            "paragraph_rank": 47,
            "section_rank": 28
        },
        {
            "text": "\u00b1 0.3 97.3 \u00b1 0.3 97.2 \u00b1 0.3 97.4 \u00b1 0.3 2012 96.2 \u00b1 0.2 96.2 \u00b1 0.2 96.2 \u00b1 0.2 96.3 \u00b1 0.2",
            "paragraph_rank": 48,
            "section_rank": 29
        },
        {
            "text": "Acknowledgments",
            "section_rank": 31
        },
        {
            "section": "Acknowledgments",
            "text": "We express our gratitude to our colleagues in the CERN accelerator departments for the excellent performance of the LHC. We thank the technical and administrative staff at the LHCb institutes. We acknowledge support from CERN and from the national agencies: CAPES, CNPq, ",
            "paragraph_rank": 49,
            "section_rank": 31
        },
        {
            "text": "JINST 10 P02007",
            "section_rank": 32
        },
        {
            "section": "JINST 10 P02007",
            "text": "communities behind the multiple open source software packages on which we depend. We are also thankful for the computing resources and the access to software R&D tools provided by Yandex LLC (Russia). Individual groups or members have received support from EPLANET, Marie Sk\u0142odowska-Curie Actions, and ERC (European Union), Conseil g\u00e9n\u00e9ral de Haute-Savoie, Labex ENIGMASS, and OCEVU, R\u00e9gion Auvergne (France), RFBR (Russia), XuntaGal, and GENCAT (Spain), Royal Society and Royal Commission for the Exhibition of 1851 (United Kingdom).",
            "paragraph_rank": 50,
            "section_rank": 32
        }
    ]
}