{
    "level": "paragraph",
    "abstract": [
        {
            "text": "The full event interpretation is presented: a new exclusive tagging algorithm used by the high-energy physics experiment Belle II. The experimental setup of Belle II allows the precise measurement of otherwise inaccessible B meson decay modes. The Full Event Interpretation algorithm enables many of these measurements. The algorithm relies on machine learning to automatically identify plausible B meson decay chains based on the data recorded by the detector. Compared to similar algorithms employed by previous experiments, the Full Event Interpretation provides a greater efficiency, yielding a larger effective sample size usable in the measurement.",
            "paragraph_rank": 2,
            "section_rank": 1
        }
    ],
    "body_text": [
        {
            "text": "Introduction",
            "section_rank": 2
        },
        {
            "section": "Introduction",
            "text": "The Belle II experiment is located at the SuperKEKB electron-positron collider in Tsukuba, Japan, and was commissioned in 2018. The experiment is designed to perform a wide range of high-precision measurements in all fields of heavy flavor physics, in particular it will investigate the decay of B mesons [1]. For this purpose, the experiment is expected to record about 40 billion collision events each containing an \u03a5(4S) resonance, which at least 96% of the time decays into exactly two B mesons (a BB pair). Each B meson decays via various intermediate states into a set of final-state particles, which are considered stable in the Belle II detector. In general, charged final-state particles are reconstructed as tracks in the central drift chamber and in the inner silicon-based vertex detectors, whereas neutral final-state particles are reconstructed as energy depositions (called clusters) in the electromagnetic calorimeter. The entire experimental setup of the detector and the collider is described in more detail in Dole\u017eal and Uno [1].",
            "paragraph_rank": 3,
            "section_rank": 2,
            "ref_spans": [
                {
                    "type": "bibr",
                    "ref_id": "b0",
                    "start": 305,
                    "text": "[1]",
                    "end": 308
                },
                {
                    "type": "bibr",
                    "ref_id": "b0",
                    "start": 1045,
                    "text": "[1]",
                    "end": 1048
                }
            ]
        },
        {
            "section": "Introduction",
            "text": "The measurement of the branching fraction of rare decays like B \u2192 , B \u2192 K or B \u2192 l , with undetectable neutrinos in their final states, is challenging. However, the second B meson in each event can be used to constrain the allowed decay chains. This general idea is known as tagging. Conceptually, each \u03a5(4S) event is divided into two sides: the signal-side containing the tracks and clusters compatible with the assumed signal B sig decay the physicist is interested in, e.g., a rare decay like B \u2192 ; and the tag-side containing the remaining tracks and clusters compatible with an arbitrary B tag meson decay. Figure 1 depicts this situation.",
            "paragraph_rank": 4,
            "section_rank": 2,
            "ref_spans": [
                {
                    "type": "figure",
                    "ref_id": "fig_0",
                    "start": 612,
                    "text": "Figure 1",
                    "end": 620
                }
            ]
        },
        {
            "section": "Introduction",
            "text": "The initial four momentum of the produced \u03a5(4S) resonance is precisely known and no additional particles are produced in this primary interaction. Therefore, because of the relevant quantum numbers conservation, knowledge about the properties of the tag-side B tag meson allows one to recover information about the signal-side B sig meson which would otherwise be inaccessible. Most importantly, all reconstructed tracks and clusters which are not assigned to the B tag mesons must be compatible with the signal decay of interest.",
            "paragraph_rank": 5,
            "section_rank": 2
        },
        {
            "section": "Introduction",
            "text": "Ideally, a full reconstruction of the entire event has to take all reconstructed tracks and clusters into account to attain a correct interpretation of the measured data. The Full Event Interpretation (FEI) algorithm presented in this article is a new exclusive tagging algorithm developed for the Belle II experiment, embedded in the Belle II Analysis Software Framework (basf2) [2]. The FEI automatically constructs plausible B tag meson decay chains compatible with the observed tracks and clusters, and calculates for each decay chain the probability of it correctly describing the true process using gradient-boosted decision trees. \"Exclusive\" refers to the reconstruction of a particle (here the B tag ) assuming an explicit decay channel.",
            "paragraph_rank": 6,
            "section_rank": 2,
            "ref_spans": [
                {
                    "type": "bibr",
                    "ref_id": "b1",
                    "start": 380,
                    "text": "[2]",
                    "end": 383
                }
            ]
        },
        {
            "section": "Introduction",
            "text": "Consequently, exclusive tagging reconstructs the B tag independently of the B sig using either hadronic or semileptonic B meson decay channels. The decay chain of the B tag is explicitly reconstructed and therefore the assignment of tracks and clusters to the tag-side and signal-side is known.",
            "paragraph_rank": 7,
            "section_rank": 2
        },
        {
            "section": "Introduction",
            "text": "In the case of a measurement of an exclusive branching fraction like B sig \u2192 , the entire decay chain of the \u03a5(4S) is known. As a consequence, all tracks and clusters measured by the detector should be already accounted for. In particular, the requirement of no additional tracks, besides the ones used for the reconstruction of the \u03a5(4S) , is an extremely powerful and efficient way to remove most reducible 1 backgrounds. This requirement is called the completeness constraint throughout this text.",
            "paragraph_rank": 8,
            "section_rank": 2
        },
        {
            "section": "Introduction",
            "text": "In the case of a measurement of an inclusive branching fraction like B sig \u2192 X u l , all remaining tracks and clusters, besides the ones used for the lepton l and the B tag meson, are identified with the X u system. Hence, the branching fraction can be determined without explicitly assuming a decay chain for the X u system.",
            "paragraph_rank": 9,
            "section_rank": 2
        },
        {
            "section": "Introduction",
            "text": "The performance of an exclusive tagging algorithm depends on the tagging efficiency (i.e., the fraction of \u03a5(4S) events which can be tagged), the tag-side efficiency (i.e., the fraction of \u03a5(4S) events with a correct tag) and on the quality of the recovered information, which determines the tag-side purity (i.e., the fraction of the tagged \u03a5(4S) events with a correct tag) of the tagged events.",
            "paragraph_rank": 10,
            "section_rank": 2
        },
        {
            "section": "Introduction",
            "text": "The exclusive tag typically provides a pure sample (i.e., purities up to 90% are possible). But, this approach suffers from a low tag-side efficiency, just a few percent, since only a tiny fraction of the B decays can be explicitly reconstructed due to the large amount of possible decay channels and their high multiplicity. The imperfect reconstruction efficiency of tracks and clusters further degrades the efficiency.",
            "paragraph_rank": 11,
            "section_rank": 2
        },
        {
            "section": "Introduction",
            "text": "Both the quality of the recovered information and the systematic uncertainties depend on the decay channel of the B tag , therefore we distinguish further between hadronic and semileptonic exclusive tagging.",
            "paragraph_rank": 12,
            "section_rank": 2
        },
        {
            "section": "Introduction",
            "text": "Hadronic tagging considers only hadronic B decay chains for the tag-side [3, Section 7.4.1]. Hence, the four momentum of the B tag is well-known and the tagged sample is very pure. A typical hadronic B decay has a branching fraction of \ue23b(10 \u22123 ) . As a consequence, hadronic tagging suffers from a low tag-side efficiency and can only be applied to a tiny fraction of the recorded events. Large combinatorics of high-multiplicity decay channels further complicate the reconstruction and require tight selection criteria.",
            "paragraph_rank": 13,
            "section_rank": 2
        },
        {
            "section": "Introduction",
            "text": "Semileptonic tagging considers only semileptonic B \u2192 Dl and B \u2192 D * l decay channels [3,Section 7.4.2]. Due to the presence of a high-momentum lepton, these decay channels can be easily identified and the semileptonic tagging usually yields a higher tag-side efficiency compared to hadronic tagging due to the large semileptonic branching fractions. On the other hand, the semileptonic tag will miss kinematic information due to the neutrino in the final state of the decay. Hence, the sample is not as pure as in the hadronic case.",
            "paragraph_rank": 14,
            "section_rank": 2,
            "ref_spans": [
                {
                    "type": "bibr",
                    "ref_id": "b2",
                    "start": 85,
                    "text": "[3,",
                    "end": 88
                },
                {
                    "type": "bibr",
                    "start": 88,
                    "text": "Section 7.4.2]",
                    "end": 102
                }
            ]
        },
        {
            "section": "Introduction",
            "text": "To conclude, the FEI provides a hadronic and semileptonic tag for B \u00b1 and B 0 mesons. This enables the measurement of exclusive decays with several neutrinos and . The two sides overlap spatially in the detector, therefore the assignment of a measured track to one of the sides is not known a priori inclusive decays. In both cases, the FEI provides an explicit tag-side decay chain with an associated probability.",
            "paragraph_rank": 15,
            "section_rank": 2
        },
        {
            "text": "Methods",
            "section_rank": 3
        },
        {
            "section": "Methods",
            "text": "The FEI algorithm follows a hierarchical approach with six stages, visualized in Fig. 2. Final-state particle candidates are constructed using the reconstructed tracks and clusters, and combined to intermediate particles until the final B candidates are formed. The probability of each candidate to be correct is estimated by a multivariate classifier. A multivariate classifier maps a set of input features (e.g., the four momentum or the vertex position) to a real-valued output, which can be interpreted as a probability estimate. The multivariate classifiers are constructed by optimizing a loss function (e.g., the misclassification rate) on Monte Carlo simulated \u03a5(4S) events and are described later in detail.",
            "paragraph_rank": 16,
            "section_rank": 3,
            "ref_spans": [
                {
                    "type": "figure",
                    "start": 81,
                    "text": "Fig. 2",
                    "end": 87
                }
            ]
        },
        {
            "section": "Methods",
            "text": "All steps in the algorithm are configurable. Therefore, the decay channels used, the cuts employed, the choice of the input features, and hyper-parameters of the multivariate classifiers depend on the configuration. A more detailed description of the algorithm and the default configuration can be found in Keck [4] and in the following we give a brief overview over the key aspects of the algorithm.",
            "paragraph_rank": 17,
            "section_rank": 3,
            "ref_spans": [
                {
                    "type": "bibr",
                    "start": 307,
                    "text": "Keck [4]",
                    "end": 315
                }
            ]
        },
        {
            "text": "Combination of Candidates",
            "section_rank": 4
        },
        {
            "section": "Combination of Candidates",
            "text": "Charged final-state particle candidates are created from tracks assuming different particle hypotheses. Neutral finalstate particle candidates are created from clusters and displaced vertices constructed by oppositely charged tracks.",
            "paragraph_rank": 18,
            "section_rank": 4
        },
        {
            "section": "Combination of Candidates",
            "text": "Each candidate can be correct (signal) or wrong (background). For instance, a track used to create a + candidate can originate from a pion traversing the detector (signal), from a kaon traversing the detector (background) or originates from a random combination of hits from beam background (also background).",
            "paragraph_rank": 19,
            "section_rank": 4
        },
        {
            "section": "Combination of Candidates",
            "text": "All candidates available at this stage are combined to intermediate particle candidates in the subsequent stages, until candidates for the desired B mesons are created. Each intermediate particle has multiple possible decay channels, which can be used to create valid candidates. For instance, a B \u2212 candidate can be created by combining a D 0 and a \u2212 candidate, or by combining a D 0 , a \u2212 and a 0 candidate. The D 0 candidate could be created from a K \u2212 and a + , or from a K 0 s and a 0 . The FEI reconstructs more than 100 explicit decay channels, leading to \ue23b(10000) distinct decay chains.",
            "paragraph_rank": 20,
            "section_rank": 4
        },
        {
            "text": "Multivariate Classification",
            "section_rank": 5
        },
        {
            "section": "Multivariate Classification",
            "text": "The FEI employs multivariate classifiers to estimate the probability of each candidate to be correct, which can be used to discriminate correctly identified candidates from background. For each final-state particle and for each decay channel of an intermediate particle, a multivariate classifier is trained which estimates the signal probability that the candidate is correct. To use all available information at each stage, a network of multivariate classifiers is built, following the hierarchical structure in Fig. 2.",
            "paragraph_rank": 21,
            "section_rank": 5,
            "ref_spans": [
                {
                    "type": "figure",
                    "start": 514,
                    "text": "Fig. 2",
                    "end": 520
                }
            ]
        },
        {
            "section": "Multivariate Classification",
            "text": "For instance, the classifier for the decay of B \u2212 \u2192 D 0 \u2212 would use the signal probability of the D 0 and \u2212 candidates, as input features to estimate the signal probability of the B \u2212 candidate created by combining the aforementioned D 0 and \u2212 candidates. Additional input features of the classifiers are the kinematic and vertex fit information of the candidate and its daughters. The multivariate classifiers used by the FEI are trained on Monte Carlo simulated events. The training is fully automatized and distributed using a map reduce approach [5]. Monte Carlo simulated data used to train the FEI is partitioned. At each reconstruction stage, the partitioned data is distributed to nodes where the reconstruction is performed and training datasets are produced (the mapping stage). The reduction stage consists of merging the training datasets and training multivariate classifiers with these training datasets.",
            "paragraph_rank": 22,
            "section_rank": 5,
            "ref_spans": [
                {
                    "type": "bibr",
                    "ref_id": "b4",
                    "start": 550,
                    "text": "[5]",
                    "end": 553
                }
            ]
        },
        {
            "section": "Multivariate Classification",
            "text": "The available information flows from the data provided by the detector through the intermediate candidates into the final B meson candidates, yielding a single number which can be used to distinguish correctly from incorrectly identified B tag mesons. The process is visualized in Fig. 2. This allows one to tune the trade-off between tag-side efficiency and tag-side purity of the algorithm by requiring a minimal",
            "paragraph_rank": 23,
            "section_rank": 5,
            "ref_spans": [
                {
                    "type": "figure",
                    "start": 281,
                    "text": "Fig. 2",
                    "end": 287
                }
            ]
        },
        {
            "section": "Multivariate Classification",
            "text": "Schematic overview of the FEI. The algorithm operates on objects identified by the reconstruction software of the Belle II detectors: charged tracks, neutral clusters and displaced vertices. In six distinct stages, these basics objects are interpreted as final-state particles ( e + , + ,",
            "paragraph_rank": 24,
            "section_rank": 5
        },
        {
            "section": "Multivariate Classification",
            "text": "and finally form the tag-side B mesons signal probability. By contrast, most exclusive measurements by Belle, which used the previous FRalgorithm, chose a working point near the maximum tag-side efficiency as described in \"Previous work\" section.",
            "paragraph_rank": 25,
            "section_rank": 5
        },
        {
            "text": "Combinatorics",
            "section_rank": 6
        },
        {
            "section": "Combinatorics",
            "text": "It is not feasible to consider all possible B meson candidates created by all possible combinations. The amount of possible combinations scales with the factorial in the number of tracks and clusters. This problem is known as combinatorics in high-energy physics. Furthermore, it is not worthwhile to consider all possible B meson candidates, because all of them are wrong except for two in the best-case scenario.",
            "paragraph_rank": 26,
            "section_rank": 6
        },
        {
            "section": "Combinatorics",
            "text": "The FEI uses two sets of the so-called cuts. A cut is a criterion that a candidate has to fulfill to be considered further. For instance, one could demand that the beam-constrained mass of the B meson candidate is near the nominal mass 5.28 GeV of a B meson particle, or that a + candidate has a high muon particle identification likelihood, which combines sub-detector information to identify muons.",
            "paragraph_rank": 27,
            "section_rank": 6
        },
        {
            "section": "Combinatorics",
            "text": "Directly after the creation of the candidate (either from a track/cluster, or by combining other candidates), but before the application of the multivariate classifier, the FEI uses loose and fast pre-cuts to remove wrongly identified candidates (background), without losing signal. The main purpose of these cuts is to save computing time and to reduce the memory consumption. These pre-cuts are applied separately for each decay channel.",
            "paragraph_rank": 28,
            "section_rank": 6
        },
        {
            "section": "Combinatorics",
            "text": "At first, a very loose fixed cut is applied on a quantity which is fast to calculate, e.g., the energy for photons, the invariant mass for D mesons, the energy released in the decay for D * mesons, or the beam-constrained mass for hadronic B mesons. Second, the remaining candidates are ranked according to a quantity, which is fast to calculate (usually the same quantity as above is used here). Only the n (usually between 10 and 20) best candidates in each decay channel are further considered, the others are discarded. This best candidate selection ensures that each decay channel and each event receives roughly the same amount of computing time.",
            "paragraph_rank": 29,
            "section_rank": 6
        },
        {
            "section": "Combinatorics",
            "text": "Next, the computationally expensive parts of the reconstruction are performed on each candidate: the matching of the reconstructed candidates to the generated particles (in case of simulated events), the vertex fitting, and the multivariate classification.",
            "paragraph_rank": 30,
            "section_rank": 6
        },
        {
            "section": "Combinatorics",
            "text": "After the multivariate classifiers have estimated the signal probability of each candidate, the candidates of different decay channels can be compared. Here the FEI uses tighter post-cuts to aggressively remove incorrectly reconstructed candidates using all the available information. The main purpose of these cuts is to restrict the number of candidates per particle to a manageable number.",
            "paragraph_rank": 31,
            "section_rank": 6
        },
        {
            "section": "Combinatorics",
            "text": "At first, there is a loose fixed cut on the signal probability, to remove unreasonable candidates. Second, the remaining candidates are ranked according to their signal probability. Only the m (usually between 10 and 20) best candidates of the particle (i.e., over all decay channels) are further considered, the others are discarded. This best candidate selection ensures that the amount of candidates produced in the next stage is reasonably low and can be handled by the computing system.",
            "paragraph_rank": 32,
            "section_rank": 6
        },
        {
            "text": "Performance",
            "section_rank": 7
        },
        {
            "section": "Performance",
            "text": "Applying the FEI to \ue23b(1 billion) events is a CPU-intensive task. An optimized runtime and a small memory footprint are key for a practical application and to save computing resources. The FEI spends most CPU time on vertex fitting (38%), particle combination (27%), and classifier inference (15%). All three tasks have been carefully optimized.",
            "paragraph_rank": 33,
            "section_rank": 7
        },
        {
            "section": "Performance",
            "text": "The FEI uses only a fast and simple unconstrained vertex fit during the reconstruction, and feeds the calculated information into its multivariate classifiers. The user can refit the whole decay chain of the final B candidates, including mass and/or interaction point profile constraints if desired. A dedicated fitter (called FastFit) based on a Kalman Filter [6] was implemented for the FEI, which requires drastically less computing time than the default implementation used by Belle II and yields very similar results. Due to this fitter, an overall speedup of the FEI of 2.74 was observed. The FastFit code is licensed under GPLv3 and available on GitHub [7].",
            "paragraph_rank": 34,
            "section_rank": 7,
            "ref_spans": [
                {
                    "type": "bibr",
                    "ref_id": "b5",
                    "start": 361,
                    "text": "[6]",
                    "end": 364
                }
            ]
        },
        {
            "section": "Performance",
            "text": "As explained in \"Combinatorics\" section, the number of candidates which have to be processed scales as the factorial of the multiplicity of the channel. In previous approaches, the runtime and the maximum memory consumption was dominated by a few high-multiplicity events and tight cuts had to be applied to high-multiplicity channels. By contrast, the FEI addresses the combinatorics problem by performing best candidate selections during the reconstruction of the decay chain instead of fixed cuts. As a consequence, for each event and each decay channel, the FEI processes the same number of candidates in vertex fitting and classifier inference, i.e., consumes similar amounts of CPU time. Moreover, the maximum memory consumption is limited due to the fixed number of best candidates per event, which is a key requirement for using the computing infrastructure.",
            "paragraph_rank": 35,
            "section_rank": 7
        },
        {
            "section": "Performance",
            "text": "Finally, the FEI uses FastBDT [8], a gradient-boosted decision tree (BDT) implementation, as its default multivariate classification algorithm. The algorithm was originally designed for the FEI to speed up the training and application phase. Compared to other popular BDT implementations such as those provided by TMVA [9], SKLearn [10] and XGBoost [11], it originally improved the execution time by more than one order of magnitude, both in training and application. In addition, an improved classification quality was observed. Most of the time when using FastBDT is spent during the extraction of the necessary features, therefore no further significant speedups can be achieved by employing a different method.",
            "paragraph_rank": 36,
            "section_rank": 7,
            "ref_spans": [
                {
                    "type": "bibr",
                    "ref_id": "b6",
                    "start": 30,
                    "text": "[8]",
                    "end": 33
                },
                {
                    "type": "bibr",
                    "ref_id": "b7",
                    "start": 319,
                    "text": "[9]",
                    "end": 322
                },
                {
                    "type": "bibr",
                    "ref_id": "b8",
                    "start": 332,
                    "text": "[10]",
                    "end": 336
                },
                {
                    "type": "bibr",
                    "ref_id": "b9",
                    "start": 349,
                    "text": "[11]",
                    "end": 353
                }
            ]
        },
        {
            "text": "Automatic Reporting",
            "section_rank": 8
        },
        {
            "section": "Automatic Reporting",
            "text": "The FEI includes an automatic reporting system called Full Event Interpretation Report (FEIR).",
            "paragraph_rank": 37,
            "section_rank": 8
        },
        {
            "section": "Automatic Reporting",
            "text": "The FEIR contains efficiencies and purities for all particles and decay channels at different points during the reconstruction. Individual reports containing control plots for each multivariate classifier and input variables are also automatically created. Control plots include receiver operating characteristics (ROC) curves, which show the tag-side efficiency against purity. Additionally, for each classifier, the purity is plotted as a function of classifier output, to check for a linear relationship as this confirms the classifier output can be treated as a probability. This built-in monitoring capability upgrades the FEI from a black-box to a white-box algorithm, which the user can understand and inspect on all levels of reconstruction.",
            "paragraph_rank": 38,
            "section_rank": 8
        },
        {
            "text": "Previous Work",
            "section_rank": 9
        },
        {
            "section": "Previous Work",
            "text": "Previous experiments have already developed and successfully employed tagging algorithms. To compare the algorithms, the maximal achievable tag-side efficiency is of particular interest, because it is directly related to the signal selection efficiency of the measurement. On the other hand, the achievable tag-side purity is only of limited use, because the achievable final purity of the final selection used for the measurement is dominated by the completeness constraint. Hence, most of the incorrect tags can be easily discarded and the final purity depends strongly on the considered signal decay channel. Moreover, signal-side independent ROC curves are not available for most of the previously employed algorithms. The area under the ROC curve allows one to compare the performance of the tagging algorithms.",
            "paragraph_rank": 39,
            "section_rank": 9
        },
        {
            "section": "Previous Work",
            "text": "The BaBar experiment [12] used the Semi-Exclusive B reconstruction (SER) algorithm for hadronic tagging [3, Section 7.4.1.1]. The algorithm used exclusive D and D * mesons candidates as a seed, and combined those with up to five charmless hadrons to form a B tag without assuming an exclusive B decay mode. The tag-side efficiency and tag-side purity of each B decay chain was extracted by fitting the beam-constrained mass [3, Section 7.1.1.2] spectrum of the constructed B tag meson candidates. The beamconstrained mass is defined as M bc = \u221a E 2 beam \u2215c 4 \u2212 p 2 B \u2215c 2 where p B denotes the three momentum of the reconstructed B meson candidate and E beam denotes half of the centre-ofmass energy of the colliding electron-positron pair. The maximum hadronic tag-side efficiency achieved by this algorithm was 0.2% for B 0B0 and 0.4% for B + B \u2212 , with a tag-side purity around 30%. The tag-side purity could be further increased by rejecting B meson candidates from low-purity decay chains. The semileptonic tag was usually constructed by combining an exclusive D or D * meson with a lepton. The maximum semileptonic tag-side efficiency was typically 0.3% for B 0B0 and 0.6% for B + B \u2212 with an unknown tag-side purity.",
            "paragraph_rank": 40,
            "section_rank": 9,
            "ref_spans": [
                {
                    "type": "bibr",
                    "ref_id": "b10",
                    "start": 21,
                    "text": "[12]",
                    "end": 25
                }
            ]
        },
        {
            "section": "Previous Work",
            "text": "The Belle experiment [13] used the so-called Full Reconstruction (FR) algorithm [14] for hadronic tagging [3, Section 7.4.1.2]. The FRintroduced an hierarchical approach, which is still used by its successor and is presented in this article (see \"Methods\" section). The tagside efficiency and tag-side purity was extracted by fitting the beam-constrained mass spectrum of the constructed B tag meson candidates. The maximum hadronic tag-side efficiency achieved by this algorithm was 0.18% for B 0B0 and 0.28% for B + B \u2212 , with a tag-side purity around 10%. Multivariate classifiers [15] were used to estimate the signal probability of each candidate. The tag-side purity could be further increased by requiring a minimal signal probability. Variants of the FR were used for semileptonic tagging (see [16,17]). The maximum semileptonic tag-side efficiency was 0.31% for B 0B0 and 0.34% for B + B \u2212 , with a typical tagside purity of 5%.",
            "paragraph_rank": 41,
            "section_rank": 9,
            "ref_spans": [
                {
                    "type": "bibr",
                    "ref_id": "b11",
                    "start": 21,
                    "text": "[13]",
                    "end": 25
                },
                {
                    "type": "bibr",
                    "ref_id": "b12",
                    "start": 80,
                    "text": "[14]",
                    "end": 84
                },
                {
                    "type": "bibr",
                    "ref_id": "b13",
                    "start": 584,
                    "text": "[15]",
                    "end": 588
                },
                {
                    "type": "bibr",
                    "ref_id": "b14",
                    "start": 802,
                    "text": "[16,",
                    "end": 806
                },
                {
                    "type": "bibr",
                    "ref_id": "b15",
                    "start": 806,
                    "text": "17]",
                    "end": 809
                }
            ]
        },
        {
            "section": "Previous Work",
            "text": "Compared to the previously employed algorithms, the FEI provides a greater tagging and tag-side efficiency, with a equal or better tag-side purity. The improvements with respect to the FR can be attributed equally to the additional decay channels and the new candidate selection criteria. The reported maximum tag-side efficiencies for the previously used exclusive tagging algorithms are summarized in \"Results\" section, Table 1. The stated efficiencies are not directly comparable due to different selection criteria, e.g., a threshold on the beam-constrained mass or the deviation of the nominal energy from the reconstructed energy E = E beam \u2212 E B with E B denoting the energy of the B candidate, best candidate selections, or cuts on the event shape used to suppress background from non-\u03a5(4S) events.",
            "paragraph_rank": 42,
            "section_rank": 9,
            "ref_spans": [
                {
                    "type": "table",
                    "ref_id": "tab_0",
                    "start": 422,
                    "text": "Table 1",
                    "end": 429
                }
            ]
        },
        {
            "text": "Results",
            "section_rank": 10
        },
        {
            "section": "Results",
            "text": "The FEI algorithm was developed for the Belle II experiment. To quantify the improvements with respect to the previously used FR algorithm, the FEI is applied to data recorded by the Belle experiment. Simulated events and recorded data from the Belle experiment are converted into the new Belle II data format [4,Chapter 2]. This conversion tool was used to validate the entire Belle II analysis software and will be described in a separate publication [18]. The remainder of this article focuses on the results obtained for the hadronic tag on data recorded by the Belle experiment. The results for the semileptonic tag and for Belle II are based on simulated events and are only summarized briefly. A detailed validation of the entire algorithm can be found in Keck [4,Chapter 4].",
            "paragraph_rank": 43,
            "section_rank": 10,
            "ref_spans": [
                {
                    "type": "bibr",
                    "ref_id": "b3",
                    "start": 310,
                    "text": "[4,",
                    "end": 313
                },
                {
                    "type": "bibr",
                    "start": 313,
                    "text": "Chapter 2]",
                    "end": 323
                },
                {
                    "type": "bibr",
                    "ref_id": "b16",
                    "start": 453,
                    "text": "[18]",
                    "end": 457
                },
                {
                    "type": "bibr",
                    "start": 763,
                    "text": "Keck [4,",
                    "end": 771
                },
                {
                    "type": "bibr",
                    "start": 771,
                    "text": "Chapter 4]",
                    "end": 781
                }
            ]
        },
        {
            "text": "Hadronic Tag",
            "section_rank": 11
        },
        {
            "section": "Hadronic Tag",
            "text": "The performance of the hadronic tag provided by the FEI using simulated and recorded Belle events is studied and compared to the previously used FRalgorithm.",
            "paragraph_rank": 44,
            "section_rank": 11
        },
        {
            "section": "Hadronic Tag",
            "text": "At first, the considered decay channels of the FEI are restricted to the set of hadronic decay channels used by the FR. The performance of the FEI to the FR are compared using the same hardware and the same simulated charged (neutral) BB Belle events. The FEI required 33% less computing time and achieved a maximum tag-side efficiency of 0.53% (0.33%) on simulated events, which is significantly higher than the previously reported tag-side efficiencies (see \"Previous work\" section ). The increase in the maximum tag-side efficiency is due to the improved candidate selection criteria, in particular the best candidate selections.",
            "paragraph_rank": 45,
            "section_rank": 11
        },
        {
            "section": "Hadronic Tag",
            "text": "Second, all decay channels of the FEI are used, including the 38 additional hadronic decay channels. The performance of the FEI to the FR using the same hardware and the same simulated charged (neutral) Belle events are then compared. The FEI required 48% more computing time and achieved a maximum tag-side efficiency of 0.76% (0.46%) on simulated events. The further increase in the maximum tag-side efficiency is due to the additional decay channels.",
            "paragraph_rank": 46,
            "section_rank": 11
        },
        {
            "section": "Hadronic Tag",
            "text": "As mentioned before, the maximum tag-side efficiency is an important performance indicator for exclusive measurements, which can employ the completeness constraint to achieve a high final purity. The achieved maximum tag-side efficiencies are summarized in Table 1.",
            "paragraph_rank": 47,
            "section_rank": 11,
            "ref_spans": [
                {
                    "type": "table",
                    "ref_id": "tab_0",
                    "start": 257,
                    "text": "Table 1",
                    "end": 264
                }
            ]
        },
        {
            "section": "Hadronic Tag",
            "text": "To validate the results for the hadronic tag obtained from the simulation study, we conducted exclusive measurements of ten different semileptonic B decay channels using the full \u03a5(4S) dataset recorded by Belle. The branching fractions of the considered semileptonic decay channels are well-known from independent untagged measurements. The branching fraction of those well-known decay channels is measured using the hadronic tag, taking into account all known disagreements between simulation and data, e.g., in the particle identification performance and the track reconstruction efficiency. We assume that the remaining disagreement between simulation and data is caused by the tag-side. Therefore, the ratio of the measured and the expected branching fraction is proportional to the ratio of the tag-side efficiency on recorded data and simulated events. Our assumption is supported by the compatibility of the extracted ratios within their uncertainties. Figure 3 summarizes the results for the ten decay channels. The ratios averaged over all control channels for the charged and neutral B tag mesons are where the first uncertainty is statistical and the second systematic. The systematic uncertainties arises from the signalside, e.g., through uncertainties on the particle identification performance or the track reconstruction efficiency.",
            "paragraph_rank": 48,
            "section_rank": 11,
            "ref_spans": [
                {
                    "type": "figure",
                    "start": 960,
                    "text": "Figure 3",
                    "end": 968
                }
            ]
        },
        {
            "section": "Hadronic Tag",
            "text": "A detailed description of the control measurements, including results for each tag and control channel, can be found in Schwab [19]. A similar study was conducted in the past for the FR by Sibidanov et al. [20], yielding a similar overall ratio of comb. = 0.75 \u00b1 0.03 . The rather large discrepancy between simulated events and recorded data is caused by the uncertainty on the branching fractions and decay models of the simulated B decay channels used for the tag-side and the large number of multivariate classifiers involved in the process.",
            "paragraph_rank": 49,
            "section_rank": 11,
            "ref_spans": [
                {
                    "type": "bibr",
                    "ref_id": "b17",
                    "start": 127,
                    "text": "[19]",
                    "end": 131
                },
                {
                    "type": "bibr",
                    "ref_id": "b18",
                    "start": 206,
                    "text": "[20]",
                    "end": 210
                }
            ]
        },
        {
            "section": "Hadronic Tag",
            "text": "The uncertainty on the tag-side efficiency of the FEI is one of the most important systematic uncertainties in the measurement of branching fractions of rare decays. The tag-side efficiency can be corrected using the extracted ratios. It is possible to apply this correction as a function of the tag-side decay channel and signal probability. A measurement which uses the ratios to correct the tag-side efficiency is performed relative to the considered calibration decay channels. The systematic uncertainty of the correction is given by the uncertainty of the ratios. To compare the hadronic tag provided by the FEI and the FRin a well-defined manner, which is independent of the signal-side, both algorithms are applied to the same set of ten million events. These events are randomly sampled from the full \u03a5(4S) dataset of 772 million events recorded by the Belle experiment. After the tag-side reconstruction, only B meson candidates are kept, which fulfill cuts on the beam-constrained mass of M bc > 5.24 GeV and on the deviation of the reconstructed energy from the nominal energy of \u22120.15 GeV < E < 0.1 GeV calculated on the candidate. In addition, a best candidate selection is performed, taking the B meson candidate with the highest signal probability in each event.",
            "paragraph_rank": 50,
            "section_rank": 11
        },
        {
            "section": "Hadronic Tag",
            "text": "The same cuts on the beam-constrained mass M bc > 5.24 GeV and the deviation of the reconstructed energy from the nominal energy \u22120.15 GeV < E < 0.1 GeV were applied and only the best (i.e., the highest signal probability) B meson candidate in each event was used.",
            "paragraph_rank": 51,
            "section_rank": 11
        },
        {
            "section": "Hadronic Tag",
            "text": "From this dataset, we determined the tag-side efficiency and tag-side purity for different cuts on the signal probability. We followed the procedure established in previous publications [3,Chapter 7.1]. For different cuts on the signal probability, extended unbinned maximum likelihood fits of the beam-constrained mass spectrum are performed. The signal peak consisting of correct B tag mesons is modeled with a Crystal Ball function [21], whereas the background is described using an ARGUS function [22]. The Gaussian mean of the Crystal Ball function was fixed to the B meson mass and its power law exponent was fixed to m = 4 based on the expected shape obtained from Monte Carlo simulations. The location and the width of the ARGUS were fixed using the known kinematic end point of the spectrum. All other parameters: the normalization of both functions, the width of the Crystal Ball, and the remaining shape parameters of both functions were adjusted by the fit. The tag-side efficiency and tag-side purity are determined in a window of 5.27 GeV < M bc < 5.29 GeV using the fitted yields of the signal and background component.",
            "paragraph_rank": 52,
            "section_rank": 11,
            "ref_spans": [
                {
                    "type": "bibr",
                    "ref_id": "b2",
                    "start": 186,
                    "text": "[3,",
                    "end": 189
                },
                {
                    "type": "bibr",
                    "start": 189,
                    "text": "Chapter 7.1]",
                    "end": 201
                },
                {
                    "type": "bibr",
                    "ref_id": "b19",
                    "start": 435,
                    "text": "[21]",
                    "end": 439
                },
                {
                    "type": "bibr",
                    "ref_id": "b20",
                    "start": 501,
                    "text": "[22]",
                    "end": 505
                }
            ]
        },
        {
            "section": "Hadronic Tag",
            "text": "In addition, we checked for a potential peaking combinatorial background component, which would bias the results. This test was done using ten million events recorded 60 MeV below the \u03a5(4S) resonance. This dataset does not contain B mesons, hence no signal is expected. The fitted signal yields were compatible with zero.",
            "paragraph_rank": 53,
            "section_rank": 11
        },
        {
            "section": "Hadronic Tag",
            "text": "The resulting ROC curves are shown in Figs. 4 and 5 for charged and neutral B tag mesons, respectively. The FEI exhibits a larger overall tag-side efficiency compared to the FR. We observe a slightly better performance for the FR than reported in Feindt et al. [14]. Both algorithms perform equally well when requiring a high tag-side purity. We suspect this is because there are only a finite number of cleanly identifiable B tag meson candidates and both algorithms identify them with similar performance. The results for tag-side purities above 70% cannot be extracted reliably and depend strongly on the chosen signal or background fit model. For practical applications, the low tag-side purity regions is of particular interest for exclusive measurements. The beam-constrained mass distributions corresponding to the low-purity region with about 15% tag-side purity and the high-purity region with approximatively 80% tag-side purity are shown in Figs. 6 and 7, respectively, for the charged B tag .",
            "paragraph_rank": 54,
            "section_rank": 11,
            "ref_spans": [
                {
                    "type": "bibr",
                    "ref_id": "b12",
                    "start": 261,
                    "text": "[14]",
                    "end": 265
                }
            ]
        },
        {
            "section": "Hadronic Tag",
            "text": "The maximum tag-side efficiency on recorded data is not determinable by this method, as the fits are restricted to the best B tag candidates. However, a significant contribution to the improvement of the FEI compared to the FRis the increased number of provided candidates per event. A physics measurement will benefit from these additional tag-side candidates by first combining them with potential signalside candidates, applying the completeness constraint (i.e., = Ndata/Nmc Fig. 3 The ratios calculated by measuring ten semileptonic decay channels on converted Belle data using the hadronic tag. The procedure is described in Schwab [19]  requiring no additional tracks in the event), and performing the best B tag candidate selection as the final step of the selection procedure. This procedure was successfully used by several measurements to validate the expected improvements on recorded data: [4,19,23].",
            "paragraph_rank": 55,
            "section_rank": 11,
            "ref_spans": [
                {
                    "type": "figure",
                    "start": 479,
                    "text": "Fig. 3",
                    "end": 485
                },
                {
                    "type": "bibr",
                    "ref_id": "b17",
                    "start": 638,
                    "text": "[19]",
                    "end": 642
                },
                {
                    "type": "bibr",
                    "ref_id": "b3",
                    "start": 903,
                    "text": "[4,",
                    "end": 906
                },
                {
                    "type": "bibr",
                    "ref_id": "b17",
                    "start": 906,
                    "text": "19,",
                    "end": 909
                },
                {
                    "type": "bibr",
                    "start": 909,
                    "text": "23]",
                    "end": 912
                }
            ]
        },
        {
            "text": "Semileptonic Tag",
            "section_rank": 12
        },
        {
            "section": "Semileptonic Tag",
            "text": "The performance of the semileptonic tag provided by the FEI is studied using simulated Belle events. The maximum tag-side efficiencies are summarized in Table 1. Receiver operating characteristics extracted from simulated events can be found in Keck [4]. The results obtained from simulated events, and the fact that the hadronic and semileptonic tag only share five out of six reconstruction stages, indicate a significant increase in the maximum tag-side efficiency. The semileptonic tag was successfully used by Keck [4] to determine the branching fraction of B \u2192 on the full \u03a5(4S) dataset recorded by the Belle experiment, with a smaller relative statistical uncertainty than obtained previously. However, no studies with well-known calibration channels as described in Kronenbitter [24] and no signal-side independent determination of the ROCs as described in Kirchgessner [16], are available yet.",
            "paragraph_rank": 56,
            "section_rank": 12,
            "ref_spans": [
                {
                    "type": "table",
                    "ref_id": "tab_0",
                    "start": 153,
                    "text": "Table 1",
                    "end": 160
                },
                {
                    "type": "bibr",
                    "ref_id": "b3",
                    "start": 250,
                    "text": "[4]",
                    "end": 253
                },
                {
                    "type": "bibr",
                    "start": 515,
                    "text": "Keck [4]",
                    "end": 523
                },
                {
                    "type": "bibr",
                    "ref_id": "b21",
                    "start": 787,
                    "text": "[24]",
                    "end": 791
                },
                {
                    "type": "bibr",
                    "ref_id": "b14",
                    "start": 878,
                    "text": "[16]",
                    "end": 882
                }
            ]
        },
        {
            "text": "Outlook for Belle II",
            "section_rank": 13
        },
        {
            "section": "Outlook for Belle II",
            "text": "As the Belle II reconstruction software is still being optimized and no large recorded experimental data set was available at the time of writing, hence the final tag-side efficiency cannot be determined reliably for Belle II at this point. Preliminary results can be found in [4] which indicate a worse overall performance. This is likely due to the increased beam background caused by the higher luminosity of the collider, which does lead to additional tracks and neutral energy depositions. This additional detector activity is not yet fully rejected by the Belle II reconstruction algorithms [4] and future improvements are likely possible.",
            "paragraph_rank": 57,
            "section_rank": 13,
            "ref_spans": [
                {
                    "type": "bibr",
                    "ref_id": "b3",
                    "start": 277,
                    "text": "[4]",
                    "end": 280
                },
                {
                    "type": "bibr",
                    "ref_id": "b3",
                    "start": 597,
                    "text": "[4]",
                    "end": 600
                }
            ]
        },
        {
            "text": "Discussion",
            "section_rank": 14
        },
        {
            "section": "Discussion",
            "text": "The multivariate classifiers used by the FEI are trained on Monte Carlo simulated events. Depending on the training procedure and the type of events provided to the training, the multivariate classifiers of the FEI are optimized for different objectives.",
            "paragraph_rank": 58,
            "section_rank": 14
        },
        {
            "section": "Discussion",
            "text": "In this article, we presented a so-called generic adaption of the FEI. The generic refers to that the FEI was trained independently of any specific signal-side using 180 million simulated \u03a5(4S) events. This setup optimizes the tag-side efficiency of a \"generic\" \u03a5(4S). Other versions of the FEI exist which optimize the tagside efficiency of specific signal events like B \u2192 . The so-called specific FEI is trained on the remaining tracks and clusters after a potential signal B meson was already identified. The training uses simulated \u03a5(4S) events and simulated signal events. As a consequence, the classifiers can be specifically trained to identify correctly reconstructed B tag mesons for signal events and can focus on reducing non-trivial background which is not discarded by the completeness constraint. The specific FEI was first introduced as a proof of concept by Keck [25] and used in Metzner [23].",
            "paragraph_rank": 59,
            "section_rank": 14,
            "ref_spans": [
                {
                    "type": "bibr",
                    "ref_id": "b22",
                    "start": 879,
                    "text": "[25]",
                    "end": 883
                },
                {
                    "type": "bibr",
                    "start": 904,
                    "text": "[23]",
                    "end": 908
                }
            ]
        },
        {
            "section": "Discussion",
            "text": "Roughly half of the improvements with respect to the previous algorithm can be attributed to the additionally considered decay channels. Future extensions are currently investigated which use semileptonic D meson decays, baryonic decays and decays including K 0 L particles. It should also be noted that the FEI algorithm can be applied, with little modification, to the \u03a5(4S) resonance. This resonance decays into a pair of B mesons. The powerful completeness constraint can still be applied in this situation.",
            "paragraph_rank": 60,
            "section_rank": 14
        },
        {
            "text": "Conclusion",
            "section_rank": 15
        },
        {
            "section": "Conclusion",
            "text": "The Full Event Interpretation is a new exclusive tagging algorithm developed for the Belle II experiment that will be used to measure a wide range of decays with a minimum of detectable information. The algorithm exploits the unique setup of B factories and significantly improves the tag-side efficiency compared to its predecessor algorithms.",
            "paragraph_rank": 61,
            "section_rank": 15
        },
        {
            "section": "Conclusion",
            "text": "The tag-side efficiency for hadronically tagged B mesons was validated and calibrated using Belle data. Furthermore, the hadronic and the semileptonic tag provided by FEI have already been used in several validation measurements [4,19,26] using the full \u03a5(4S) dataset recorded by the Belle experiment. Similar studies and measurements for Belle II are anticipated as soon as the experiment records a sufficient amount of collision events.",
            "paragraph_rank": 62,
            "section_rank": 15,
            "ref_spans": [
                {
                    "type": "bibr",
                    "ref_id": "b3",
                    "start": 229,
                    "text": "[4,",
                    "end": 232
                },
                {
                    "type": "bibr",
                    "ref_id": "b17",
                    "start": 232,
                    "text": "19,",
                    "end": 235
                },
                {
                    "type": "bibr",
                    "ref_id": "b23",
                    "start": 235,
                    "text": "26]",
                    "end": 238
                }
            ]
        },
        {
            "section": "Conclusion",
            "text": "There are several ways that the FEI algorithm could be further refined and applied to so far unexplored applications. These will provide an exciting and fruitful area of future research.",
            "paragraph_rank": 63,
            "section_rank": 15
        },
        {
            "text": "Fig. 1",
            "section_rank": 16
        },
        {
            "section": "Fig. 1",
            "text": "Fig. 1Schematic overview of a \u03a5(4S) decay: (Left) a common tagside decay B \u2212 tag \u2192 D 0 (\u2192 K 0 s (\u2192 \u2212 + ) \u2212 + ) \u2212 and (right) a typical signal-side decay B + sig \u2192 + (\u2192 +\u0304) . The two sides overlap spatially in the detector, therefore the assignment of a measured track to one of the sides is not known a priori",
            "paragraph_rank": 64,
            "section_rank": 16
        },
        {
            "text": "charged = 0.74 +0.014 \u22120.013 \u00b1 0.050 neutral = 0.86 +0.045 \u22120.050 \u00b1 0.054,",
            "paragraph_rank": 65,
            "section_rank": 17
        },
        {
            "text": "Fig. 4",
            "section_rank": 18
        },
        {
            "section": "Fig. 4",
            "text": "Fig. 4Receiver operating characteristic of charged B tag mesons extracted from a fit of the beam-constrained mass on converted Belle data. The FEI outperforms the FR algorithms performance at low and high purity",
            "paragraph_rank": 66,
            "section_rank": 18
        },
        {
            "text": "Fig. 5 Fig. 6 Fig. 7",
            "section_rank": 19
        },
        {
            "section": "Fig. 5 Fig. 6 Fig. 7",
            "text": "Fig. 5 Receiver operating characteristic of neutral B tag mesons extracted from a fit of the beam-constrained mass on converted Belle data. The FEI outperforms the FR algorithms performance at low and intermediate purity. At high purity, the tag-side efficiency cannot be extracted reliably",
            "paragraph_rank": 67,
            "section_rank": 19
        },
        {
            "text": "(",
            "section_rank": 20
        },
        {
            "section": "(",
            "text": "( * ) B ( * ) and B 0 s",
            "paragraph_rank": 68,
            "section_rank": 20
        },
        {
            "text": "Table 1",
            "section_rank": 21
        },
        {
            "section": "Table 1",
            "text": "Summary of the maximum tag-side efficiency of the Full Event Interpretation and for the previously used exclusive tagging algorithmsFor the FEI simulated data from the last official Monte Carlo campaign of the Belle experiment were used. The maximum tag-side efficiency on recorded data is lower (see \"Hadronic tag\" section). The numbers for the older algorithms (see \"Previous work\" section), are not directly comparable due to different selection criteria, like best candidate selections and selections to suppress non-\u03a5(4S) events",
            "paragraph_rank": 69,
            "section_rank": 21
        },
        {
            "section": "Table 1",
            "text": "Page 2 of 10",
            "paragraph_rank": 70,
            "section_rank": 21
        },
        {
            "section": "Table 1",
            "text": "Reducible background has distinct final-state products from the signal.",
            "paragraph_rank": 71,
            "section_rank": 21
        },
        {
            "text": "Acknowledgements",
            "section_rank": 23
        },
        {
            "section": "Acknowledgements",
            "text": "We thank the KEKB accelerator group, the Belle collaboration, and the Belle II collaboration for the provided data and infrastructure. This research was supported by: the Federal Ministry of Education and Research of Germany (BMBF), the German Research Foundation (DFG), the Doctoral School \"Karlsruhe School of Elementary and Astroparticle Physics: Science and Technology\" funded by the German Research Foundation (DFG), and the DFG-funded Research Training Group \"GRK 1694: Elementary Particle Physics at Highest Energy and highest Precision\". F.B. and W.S. are supported by DFG Emmy-Noether Grant No. BE 6075/1-1",
            "paragraph_rank": 72,
            "section_rank": 23
        },
        {
            "section": "Acknowledgements",
            "text": "Open Access This article is distributed under the terms of the Creative Commons Attribution 4.0 International License (http://creat iveco mmons .org/licen ses/by/4.0/), which permits unrestricted use, distribution, and reproduction in any medium, provided you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made.",
            "paragraph_rank": 73,
            "section_rank": 23
        }
    ]
}