{
    "level": "paragraph",
    "abstract": [
        {
            "text": "Using variational autoencoders trained on known physics processes, we develop a one-sided threshold test to isolate previously unseen processes as outlier events. Since the autoencoder training does not depend on any specific new physics signature, the proposed procedure doesn't make specific assumptions on the nature of new physics. An event selection based on this algorithm would be complementary to classic LHC searches, typically based on model-dependent hypothesis testing. Such an algorithm would deliver a list of anomalous events, that the experimental collaborations could further scrutinize and even release as a catalog, similarly to what is typically done in other scientific domains. Event topologies repeating in this dataset could inspire new-physics model building and new experimental searches. Running in the trigger system of the LHC experiments, such an application could identify anomalous events that would be otherwise lost, extending the scientific reach of the LHC.",
            "paragraph_rank": 2,
            "section_rank": 1
        }
    ],
    "body_text": [
        {
            "text": "Introduction",
            "section_rank": 2
        },
        {
            "section": "Introduction",
            "text": "One of the main motivations behind the construction of the CERN Large Hadron Collider (LHC) is the exploration of the high-energy frontier in search for new physics phenomena.",
            "paragraph_rank": 3,
            "section_rank": 2
        },
        {
            "section": "Introduction",
            "text": "New physics could answer some of the standing fundamental questions in particle physics, e.g., the nature of dark matter or the origin of electroweak symmetry breaking. In LHC experiments, searches for physics beyond the Standard Model (BSM) are typically carried on as fully-supervised data analyses: assuming a new physics scenario of some kind, a search is structured as a hypothesis test, based on a profiled-likelihood ratio [1]. These searches are said to be model dependent, since they depend on considering a specific new physics model.",
            "paragraph_rank": 4,
            "section_rank": 2,
            "ref_spans": [
                {
                    "type": "bibr",
                    "ref_id": "b0",
                    "start": 430,
                    "text": "[1]",
                    "end": 433
                }
            ]
        },
        {
            "section": "Introduction",
            "text": "Assuming that one is testing the right model, this approach is very effective in discovering a signal, as demonstrated by the discovery of the Standard Model (SM) Higgs boson [2,3] at the LHC. On the other hand, given the (so far) negative outcome of many BSM searches at particle-physics experiments, it is possible that a future BSM model, if any, is not among those typically tested. The problem is more profound if analyzed in the context of the LHC big-data problem: at the LHC, 40 million proton-beam collisions are produced every second, but only \u223c1000 collision events/sec can be stored by the AT-LAS and CMS experiments, due to limited bandwidth, processing, and storage resources. It is possible to imagine BSM scenarios that would escape detection, simply because the corresponding new physics events would be rejected by a typical set of online selection algorithms.",
            "paragraph_rank": 5,
            "section_rank": 2,
            "ref_spans": [
                {
                    "type": "bibr",
                    "ref_id": "b1",
                    "start": 175,
                    "text": "[2,",
                    "end": 178
                },
                {
                    "type": "bibr",
                    "ref_id": "b2",
                    "start": 178,
                    "text": "3]",
                    "end": 180
                }
            ]
        },
        {
            "text": "JHEP05(2019)036",
            "section_rank": 3
        },
        {
            "section": "JHEP05(2019)036",
            "text": "Establishing alternative search methodologies with reduced model dependence is an important aspect of future LHC runs. Traditionally, this issue was addressed with socalled model-independent searches, performed at the Tevatron [4,5], at HERA [6], and at the LHC [7,8], as discussed in section 2.",
            "paragraph_rank": 6,
            "section_rank": 3,
            "ref_spans": [
                {
                    "type": "bibr",
                    "ref_id": "b3",
                    "start": 227,
                    "text": "[4,",
                    "end": 230
                },
                {
                    "type": "bibr",
                    "ref_id": "b4",
                    "start": 230,
                    "text": "5]",
                    "end": 232
                },
                {
                    "type": "bibr",
                    "ref_id": "b5",
                    "start": 242,
                    "text": "[6]",
                    "end": 245
                },
                {
                    "type": "bibr",
                    "ref_id": "b6",
                    "start": 262,
                    "text": "[7,",
                    "end": 265
                },
                {
                    "type": "bibr",
                    "ref_id": "b7",
                    "start": 265,
                    "text": "8]",
                    "end": 267
                }
            ]
        },
        {
            "section": "JHEP05(2019)036",
            "text": "In this paper, we propose to address this need by deploying an unsupervised algorithm in the online selection system (trigger) of the LHC experiments. 1 This algorithm would be trained on known SM processes and could be able to identify BSM events as anomalies. The selected events could be stored in a special stream, scrutinized by experts (e.g., to exclude the occurrence of detector malfunctions that could explain the anomalies), and even released outside the experimental collaborations, in the form of an open-access catalog. The final goal of this application is to identify anomalous event topologies and inspire future supervised searches on data collected afterwards.",
            "paragraph_rank": 7,
            "section_rank": 3,
            "ref_spans": [
                {
                    "type": "bibr",
                    "ref_id": "b0",
                    "start": 151,
                    "text": "1",
                    "end": 152
                }
            ]
        },
        {
            "section": "JHEP05(2019)036",
            "text": "As an example, we consider the case of a typical single-lepton data stream, selected by a hardware-based Level-1 (L1) trigger system. In normal conditions, the L1 trigger is the first of a two-steps selection stage. After a coarse (and often local) reconstruction and loose selection at L1, events are fully reconstructed in the High Lever Trigger (HLT), where a much tighter selection is applied. The selection is usually done having in mind specific signal topologies, eg., specific BSM models. In this study, we imagine to replace this model-dependent selection with a variational autoencoder (VAE) [11,12] looking for anomalous events in the incoming single-lepton stream. The VAE is trained to compress the input event representation into a lower-dimension latent space and then decompress it, returning the shape parameters describing the probability density function (pdf) of each input quantity given a point in the compressed space. In addition, a VAE allows a stochastic modeling of the latent space, a feature which is missing in a simple AE architecture. The highlighted procedure is not specific of the considered single-lepton stream and could be easily extended to other data streams.",
            "paragraph_rank": 8,
            "section_rank": 3,
            "ref_spans": [
                {
                    "type": "bibr",
                    "ref_id": "b10",
                    "start": 602,
                    "text": "[11,",
                    "end": 606
                },
                {
                    "type": "bibr",
                    "ref_id": "b11",
                    "start": 606,
                    "text": "12]",
                    "end": 609
                }
            ]
        },
        {
            "section": "JHEP05(2019)036",
            "text": "The distribution of the VAE's reconstruction loss on a validation sample is used to define a threshold, corresponding to a desired acceptance rate for SM events. All the events with loss larger than the threshold are considered as potential anomalies and could be stored in a low-rate anomalous-event data stream. In this work, we set the threshold such that \u223c 1000 SM events would be collected every month under typical LHC operation conditions. In particular, we took as a reference 8 months of data taking per year, with an integrated luminosity of \u223c 40 fb \u22121 . Assuming an LHC duty cycle of 2/3, this corresponds to an average instantaneous luminosity of \u223c 2.9 \u00d7 10 33 cm \u22122 s \u22121 .",
            "paragraph_rank": 9,
            "section_rank": 3
        },
        {
            "section": "JHEP05(2019)036",
            "text": "We then evaluate the BSM production cross section that would correspond to a signal excess of 100 BSM events selected per month, as well as the one that would give a signal yield \u223c 1/3 of the SM yield. For this, we consider a set of low-mass BSM resonances, decaying to one or more leptons and light enough to be challenging for the currently employed LHC trigger algorithms.",
            "paragraph_rank": 10,
            "section_rank": 3
        },
        {
            "text": "JHEP05(2019)036",
            "section_rank": 4
        },
        {
            "section": "JHEP05(2019)036",
            "text": "This paper is structured as follows: we discuss related works in section 2. Section 3 gives a brief description of the dataset used. Section 4 describes the VAE model used in the study, as well as a set of fully-supervised classifiers used for performance comparison. Results are discussed in section 5. In section 6 we discuss how such a procedure could be deployed in a typical LHC experiment while relying exclusively on data. Conclusions are given in section 7. Appendix A provides a brief comparison between VAEs and plain autoencoders (AEs).",
            "paragraph_rank": 11,
            "section_rank": 4
        },
        {
            "text": "Related work",
            "section_rank": 5
        },
        {
            "section": "Related work",
            "text": "Model-independent searches for new physics have been performed at the Tevatron [4,5], HERA [6], and the LHC [7,8]. These searches are based on the comparison of a large set of binned distributions to the prediction from Monte Carlo (MC) simulations, in search for bins exhibiting a deviation larger than some predefined threshold. While the effectiveness of this strategy in establishing a discovery has been a matter of discussion, a recent study by the ATLAS collaboration [8] rephrased this model-independent search strategy into a tool to identify interesting excesses, on which traditional analysis techniques could be performed on independent datasets (e.g., the data collected after running the model-independent analysis). This change of scope has the advantage of reducing the trial factor (i.e., the so-called look-elsewhere effect [13,14]), which would otherwise wash out the significance of an observed excess.",
            "paragraph_rank": 12,
            "section_rank": 5,
            "ref_spans": [
                {
                    "type": "bibr",
                    "ref_id": "b3",
                    "start": 79,
                    "text": "[4,",
                    "end": 82
                },
                {
                    "type": "bibr",
                    "ref_id": "b4",
                    "start": 82,
                    "text": "5]",
                    "end": 84
                },
                {
                    "type": "bibr",
                    "ref_id": "b5",
                    "start": 91,
                    "text": "[6]",
                    "end": 94
                },
                {
                    "type": "bibr",
                    "ref_id": "b6",
                    "start": 108,
                    "text": "[7,",
                    "end": 111
                },
                {
                    "type": "bibr",
                    "ref_id": "b7",
                    "start": 111,
                    "text": "8]",
                    "end": 113
                },
                {
                    "type": "bibr",
                    "ref_id": "b7",
                    "start": 475,
                    "text": "[8]",
                    "end": 478
                },
                {
                    "type": "bibr",
                    "ref_id": "b12",
                    "start": 842,
                    "text": "[13,",
                    "end": 846
                },
                {
                    "type": "bibr",
                    "ref_id": "b13",
                    "start": 846,
                    "text": "14]",
                    "end": 849
                }
            ]
        },
        {
            "section": "Related work",
            "text": "Our strategy is similar to what is proposed in ref. [8], with two substantial differences: (i) we aim to process also those events that could be discarded by the online selection, by running the algorithm as part of the trigger process; (ii) we do so exploiting deep-learningbased anomaly detection techniques.",
            "paragraph_rank": 13,
            "section_rank": 5,
            "ref_spans": [
                {
                    "type": "bibr",
                    "ref_id": "b7",
                    "start": 52,
                    "text": "[8]",
                    "end": 55
                }
            ]
        },
        {
            "section": "Related work",
            "text": "Applying deep learning at the trigger level has been proposed in ref. [15]. Recent works [16][17][18][19] have investigated the use of machine-learning techniques to setup new strategies for BSM searches with minimal or no assumption on the specific new-physics scenario under investigation. In this work, we use VAEs [11,12] based on high-level features as a baseline. Previously, autoencoders have been used in collider physics for detector monitoring [20,21] and event generation [22]. Autoencoders have also been explored to define a jet tagger that would identify new physics events with anomalous jets [23,24], with a strategy similar to what we apply to the full event in this work.",
            "paragraph_rank": 14,
            "section_rank": 5,
            "ref_spans": [
                {
                    "type": "bibr",
                    "ref_id": "b14",
                    "start": 70,
                    "text": "[15]",
                    "end": 74
                },
                {
                    "type": "bibr",
                    "ref_id": "b16",
                    "start": 89,
                    "text": "[16]",
                    "end": 93
                },
                {
                    "type": "bibr",
                    "ref_id": "b17",
                    "start": 93,
                    "text": "[17]",
                    "end": 97
                },
                {
                    "type": "bibr",
                    "ref_id": "b18",
                    "start": 97,
                    "text": "[18]",
                    "end": 101
                },
                {
                    "type": "bibr",
                    "ref_id": "b19",
                    "start": 101,
                    "text": "[19]",
                    "end": 105
                },
                {
                    "type": "bibr",
                    "ref_id": "b10",
                    "start": 318,
                    "text": "[11,",
                    "end": 322
                },
                {
                    "type": "bibr",
                    "ref_id": "b11",
                    "start": 322,
                    "text": "12]",
                    "end": 325
                },
                {
                    "type": "bibr",
                    "ref_id": "b20",
                    "start": 454,
                    "text": "[20,",
                    "end": 458
                },
                {
                    "type": "bibr",
                    "ref_id": "b21",
                    "start": 458,
                    "text": "21]",
                    "end": 461
                },
                {
                    "type": "bibr",
                    "ref_id": "b22",
                    "start": 483,
                    "text": "[22]",
                    "end": 487
                },
                {
                    "type": "bibr",
                    "ref_id": "b23",
                    "start": 608,
                    "text": "[23,",
                    "end": 612
                },
                {
                    "type": "bibr",
                    "ref_id": "b24",
                    "start": 612,
                    "text": "24]",
                    "end": 615
                }
            ]
        },
        {
            "section": "Related work",
            "text": "Anomaly detection has been a traditional use case for one-class machine learning methods, such as one-class Support Vector Machine [25] or Isolation Forest [26,27]. A review of proposed methods can be found in ref. [28]. Variational methods have been shown to be effective for novelty detection, as for instance is discussed in ref. [29]. In particular, VAEs [11] have been proposed as an effective method for anomaly detection [12].",
            "paragraph_rank": 15,
            "section_rank": 5,
            "ref_spans": [
                {
                    "type": "bibr",
                    "ref_id": "b25",
                    "start": 131,
                    "text": "[25]",
                    "end": 135
                },
                {
                    "type": "bibr",
                    "ref_id": "b26",
                    "start": 156,
                    "text": "[26,",
                    "end": 160
                },
                {
                    "type": "bibr",
                    "ref_id": "b27",
                    "start": 160,
                    "text": "27]",
                    "end": 163
                },
                {
                    "type": "bibr",
                    "ref_id": "b28",
                    "start": 215,
                    "text": "[28]",
                    "end": 219
                },
                {
                    "type": "bibr",
                    "ref_id": "b29",
                    "start": 333,
                    "text": "[29]",
                    "end": 337
                },
                {
                    "type": "bibr",
                    "ref_id": "b10",
                    "start": 359,
                    "text": "[11]",
                    "end": 363
                },
                {
                    "type": "bibr",
                    "ref_id": "b11",
                    "start": 428,
                    "text": "[12]",
                    "end": 432
                }
            ]
        },
        {
            "text": "Data samples",
            "section_rank": 6
        },
        {
            "section": "Data samples",
            "text": "The dataset used for this study is a refined version of the high-level-feature (HLF) dataset used in ref. [15]. Proton-proton collisions are generated using the PYTHIA8 event-generation library [30], fixing the center-of-mass energy to the LHC Run-II value (13 TeV) and the",
            "paragraph_rank": 16,
            "section_rank": 6,
            "ref_spans": [
                {
                    "type": "bibr",
                    "ref_id": "b14",
                    "start": 106,
                    "text": "[15]",
                    "end": 110
                },
                {
                    "type": "bibr",
                    "ref_id": "b30",
                    "start": 194,
                    "text": "[30]",
                    "end": 198
                },
                {
                    "type": "bibr",
                    "start": 257,
                    "text": "(13 TeV)",
                    "end": 265
                }
            ]
        },
        {
            "text": "JHEP05(2019)036",
            "section_rank": 7
        },
        {
            "section": "JHEP05(2019)036",
            "text": "average number of overlapping collisions per beam crossing (pileup) to 20. These beam conditions loosely correspond to the LHC operating conditions in 2016.",
            "paragraph_rank": 17,
            "section_rank": 7
        },
        {
            "section": "JHEP05(2019)036",
            "text": "Events generated by PYTHIA8 are processed with the DELPHES library [31], to emulate detector efficiency and resolution effects. We take as a benchmark detector description the upgraded design of the CMS detector, foreseen for the High-Luminosity LHC phase [32]. In particular, we use the CMS HL-LHC detector card distributed with DELPHES. We run the DELPHES particle-flow (PF) algorithm, which combines the information from different detector components to derive a list of reconstructed particles, the so-called PF candidates. For each particle, the algorithm returns the measured energy and flight direction. Each particle is associated to one of three classes: charged particles, photons, and neutral hadrons. In addition, lists of reconstructed electrons and muons are given.",
            "paragraph_rank": 18,
            "section_rank": 7,
            "ref_spans": [
                {
                    "type": "bibr",
                    "ref_id": "b31",
                    "start": 67,
                    "text": "[31]",
                    "end": 71
                },
                {
                    "type": "bibr",
                    "ref_id": "b32",
                    "start": 256,
                    "text": "[32]",
                    "end": 260
                }
            ]
        },
        {
            "section": "JHEP05(2019)036",
            "text": "Many SM processes would contribute to the considered single-lepton dataset. For simplicity, we restrict the list of relevant SM processes to the four with the highest production cross sections, namely:",
            "paragraph_rank": 19,
            "section_rank": 7
        },
        {
            "section": "JHEP05(2019)036",
            "text": "\u2022 Inclusive W production, with W \u2192 \u03bd ( = e, \u00b5, \u03c4 ).",
            "paragraph_rank": 20,
            "section_rank": 7
        },
        {
            "section": "JHEP05(2019)036",
            "text": "\u2022 Inclusive Z production, with Z \u2192 ( = e, \u00b5, \u03c4 ).",
            "paragraph_rank": 21,
            "section_rank": 7
        },
        {
            "section": "JHEP05(2019)036",
            "text": "\u2022 tt production.",
            "paragraph_rank": 22,
            "section_rank": 7
        },
        {
            "section": "JHEP05(2019)036",
            "text": "\u2022 QCD multijet production. 2 These samples are mixed to provide a SM cocktail dataset, which is then used to train autoencoder models and to tune the threshold requirement that defines what we consider an anomaly. The cocktail is built scaling down the high-statistics samples (tt, W , and Z) to the lowest-statistics one (QCD, whose generation is the most computing-expensive), according to their production cross-section values (estimated at leading order with PYTHIA) and selection efficiencies, shown in table 1.",
            "paragraph_rank": 23,
            "section_rank": 7,
            "ref_spans": [
                {
                    "type": "bibr",
                    "ref_id": "b1",
                    "start": 27,
                    "text": "2",
                    "end": 28
                }
            ]
        },
        {
            "section": "JHEP05(2019)036",
            "text": "Events are filtered at generation requiring an electron, muon, or tau lepton with p T > 22 GeV. Once detector effects are taken into account through the DELPHES simulation, events are further selected requiring the presence of one reconstructed lepton (electron or muon) with transverse momentum p T > 23 GeV and a loose isolation requirement Iso < 0.45. If more than one reconstructed lepton is present, the highest p T one is considered. The isolation for the considered lepton is computed as:",
            "paragraph_rank": 24,
            "section_rank": 7
        },
        {
            "section": "JHEP05(2019)036",
            "text": "where the index p runs over all the photons, charged particles, and neutral hadrons within a cone of size \u2206R = \u2206\u03b7 2 + \u2206\u03c6 2 < 0.3 from . 3",
            "paragraph_rank": 25,
            "section_rank": 7
        },
        {
            "section": "JHEP05(2019)036",
            "text": "2 To speed up the generation process for QCD events, we require \u221a\u015d > 10 GeV, the fraction of QCD events with \u221a\u015d < 10 GeV and producing a lepton within acceptance being negligible but computationally expensive.",
            "paragraph_rank": 26,
            "section_rank": 7
        },
        {
            "section": "JHEP05(2019)036",
            "text": "3 As common for collider physics, we use a Cartesian coordinate system with the z axis oriented along the beam axis, the x axis on the horizontal plane, and the y axis oriented upward. The x and y axes define the transverse plane, while the z axis identifies the longitudinal direction. The azimuth angle \u03c6 is computed from the x axis. The polar angle \u03b8 is used to compute the pseudorapidity \u03b7 = \u2212 log(tan(\u03b8/2)). We fix units such that c = = 1.  Table 1. Acceptance and L1 trigger (i.e. p T and Iso requirement) efficiency for the four studied SM processes and corresponding values for the BSM benchmark models. For SM processes, we quote the total cross section before the trigger, the expected number of events per month and the fraction in the SM cocktail. For BSM models, we compute the production cross section corresponding to an average of 100 BSM events per month passing the acceptance and L1 trigger requirements. The monthly event yield is computed assuming an average luminosity per month of 5 fb \u22121 , corresponding to the running conditions discussed in section 1.",
            "paragraph_rank": 27,
            "section_rank": 7,
            "ref_spans": [
                {
                    "type": "table",
                    "start": 446,
                    "text": "Table 1",
                    "end": 453
                }
            ]
        },
        {
            "text": "JHEP05(2019)036",
            "section_rank": 8
        },
        {
            "section": "JHEP05(2019)036",
            "text": "The 21 considered HLF quantities are:",
            "paragraph_rank": 28,
            "section_rank": 8
        },
        {
            "section": "JHEP05(2019)036",
            "text": "\u2022 The absolute value of the isolated-lepton transverse momentum p T .",
            "paragraph_rank": 29,
            "section_rank": 8
        },
        {
            "section": "JHEP05(2019)036",
            "text": "\u2022 The three isolation quantities (ChPFIso, NeuPFIso, GammaPFIso) for the isolated lepton, computed with respect to charged particles, neutral hadrons and photons, respectively.",
            "paragraph_rank": 30,
            "section_rank": 8
        },
        {
            "section": "JHEP05(2019)036",
            "text": "\u2022 The lepton charge.",
            "paragraph_rank": 31,
            "section_rank": 8
        },
        {
            "section": "JHEP05(2019)036",
            "text": "\u2022 A Boolean flag (isEle) set to 1 when the trigger lepton is an electron, 0 otherwise.",
            "paragraph_rank": 32,
            "section_rank": 8
        },
        {
            "section": "JHEP05(2019)036",
            "text": "\u2022 S T , i.e. the scalar sum of the p T of all the jets, leptons, and photons in the event with p T > 30 GeV and |\u03b7| < 2.6. Jets are clustered from the reconstructed PF candidates, using the FASTJET [33] implementation of the anti-k T jet algorithm [34], with a jet-size parameter R=0.4.",
            "paragraph_rank": 33,
            "section_rank": 8,
            "ref_spans": [
                {
                    "type": "bibr",
                    "ref_id": "b33",
                    "start": 198,
                    "text": "[33]",
                    "end": 202
                },
                {
                    "type": "bibr",
                    "ref_id": "b34",
                    "start": 248,
                    "text": "[34]",
                    "end": 252
                }
            ]
        },
        {
            "section": "JHEP05(2019)036",
            "text": "\u2022 The number of jets entering the S T sum (N J ).",
            "paragraph_rank": 34,
            "section_rank": 8
        },
        {
            "section": "JHEP05(2019)036",
            "text": "\u2022 The invariant mass of the set of jets entering the S T sum (M J ).",
            "paragraph_rank": 35,
            "section_rank": 8
        },
        {
            "section": "JHEP05(2019)036",
            "text": "\u2022 The number of these jets being identified as originating from a b quark (N b ).",
            "paragraph_rank": 36,
            "section_rank": 8
        },
        {
            "text": "JHEP05(2019)036",
            "section_rank": 9
        },
        {
            "section": "JHEP05(2019)036",
            "text": "\u2022 The missing transverse momentum, decomposed into its parallel (p miss T, ) and orthogonal (p miss T,\u22a5 ) components with respect to the lepton direction. The missing transverse momentum is defined as the negative sum of the PF-candidate p T vectors:",
            "paragraph_rank": 37,
            "section_rank": 9
        },
        {
            "section": "JHEP05(2019)036",
            "text": "\u2022 The transverse mass, M T , of the isolated lepton and the p miss T system, defined as:",
            "paragraph_rank": 38,
            "section_rank": 9
        },
        {
            "section": "JHEP05(2019)036",
            "text": "with \u2206\u03c6 the azimuth separation between the p T and p miss T vectors, and E miss T the magnitude of p miss T .",
            "paragraph_rank": 39,
            "section_rank": 9
        },
        {
            "section": "JHEP05(2019)036",
            "text": "\u2022 The number of selected muons (N \u00b5 ).",
            "paragraph_rank": 40,
            "section_rank": 9
        },
        {
            "section": "JHEP05(2019)036",
            "text": "\u2022 The invariant mass of this set of muons (M \u00b5 ).",
            "paragraph_rank": 41,
            "section_rank": 9
        },
        {
            "section": "JHEP05(2019)036",
            "text": "\u2022 The absolute value of the total transverse momentum of these muons (p \u00b5 T,TOT ).",
            "paragraph_rank": 42,
            "section_rank": 9
        },
        {
            "section": "JHEP05(2019)036",
            "text": "\u2022 The number of selected electrons (N e ).",
            "paragraph_rank": 43,
            "section_rank": 9
        },
        {
            "section": "JHEP05(2019)036",
            "text": "\u2022 The invariant mass of this set of electrons (M e ).",
            "paragraph_rank": 44,
            "section_rank": 9
        },
        {
            "section": "JHEP05(2019)036",
            "text": "\u2022 The absolute value of the total transverse momentum of these electrons (p e T,TOT ).",
            "paragraph_rank": 45,
            "section_rank": 9
        },
        {
            "section": "JHEP05(2019)036",
            "text": "\u2022 The number of reconstructed charged hadrons.",
            "paragraph_rank": 46,
            "section_rank": 9
        },
        {
            "section": "JHEP05(2019)036",
            "text": "\u2022 The number of reconstructed neutral hadrons.",
            "paragraph_rank": 47,
            "section_rank": 9
        },
        {
            "section": "JHEP05(2019)036",
            "text": "This list of HLF quantities is not defined having in mind a specific BSM scenario. Instead, it is conceived to include relevant information to discriminate the various SM processes populating the single-lepton data stream. On the other hand, it is generic enough to allow (at least in principle) the identification of a large set of new physics scenarios. In addition to the four SM processes listed above, we consider the following BSM models to benchmark anomaly-detection capabilities:",
            "paragraph_rank": 48,
            "section_rank": 9
        },
        {
            "section": "JHEP05(2019)036",
            "text": "\u2022 A leptoquark LQ with mass 80 GeV, decaying to a b quark and a \u03c4 lepton.",
            "paragraph_rank": 49,
            "section_rank": 9
        },
        {
            "section": "JHEP05(2019)036",
            "text": "\u2022 A neutral scalar boson with mass 50 GeV, decaying to two off-shell Z bosons, each forced to decay to two leptons: A \u2192 4 .",
            "paragraph_rank": 50,
            "section_rank": 9
        },
        {
            "section": "JHEP05(2019)036",
            "text": "\u2022 A scalar boson with mass 60 GeV, decaying to two tau leptons: h 0 \u2192 \u03c4 \u03c4 .",
            "paragraph_rank": 51,
            "section_rank": 9
        },
        {
            "section": "JHEP05(2019)036",
            "text": "\u2022 A charged scalar boson with mass 60 GeV, decaying to a tau lepton and a neutrino:",
            "paragraph_rank": 52,
            "section_rank": 9
        },
        {
            "section": "JHEP05(2019)036",
            "text": "For each BSM scenario, we consider any direct production mechanism implemented in PYTHIA8, including associate jet production. We list in table 1 the leading-order production cross section and selection efficiency for each model. Figures 1 and 2 show the distribution of HLF quantities for the SM processes and the BSM benchmark models, respectively.  ",
            "paragraph_rank": 53,
            "section_rank": 9,
            "ref_spans": [
                {
                    "type": "figure",
                    "ref_id": "fig_0",
                    "start": 230,
                    "text": "Figures 1 and 2",
                    "end": 245
                }
            ]
        },
        {
            "text": "JHEP05(2019)036",
            "section_rank": 10
        },
        {
            "text": "JHEP05(2019)036 4 Model description",
            "section_rank": 11
        },
        {
            "section": "JHEP05(2019)036 4 Model description",
            "text": "We train VAEs on the SM cocktail sample described in section 3, taking as input the 21 HLF quantities listed there. The use of HLF quantities to represent events limits the model independence of the anomaly detection procedure. While the list of features is chosen to represent the main physics aspects of the considered SM processes and is in no way tailored to specific BSM models, it is true that such a list might be more suitable for certain models than for others. In this respect, one cannot guarantee that the anomaly-detection performance observed on a given BSM model would generalize to any BSM scenario. We will address in a future work a possible solution to reduce the residual model dependence implied by the input event representation.",
            "paragraph_rank": 54,
            "section_rank": 11
        },
        {
            "section": "JHEP05(2019)036 4 Model description",
            "text": "In this section, we present both the best-performing autoencoder model, trained to encode and decode the SM training sample, and a set of four supervised classifiers, each trained to distinguish one of the four BSM benchmark models from SM events. We use the classification performance of these supervised algorithms as an estimate of the best performance that the VAE could get to.",
            "paragraph_rank": 55,
            "section_rank": 11
        },
        {
            "text": "Autoencoders",
            "section_rank": 12
        },
        {
            "section": "Autoencoders",
            "text": "Autoencoders are algorithms that compress a given set of inputs variables in a latent space (encoding) and then, starting from the latent space, reconstruct the HLF input values (decoding). The loss distribution of an AE is used in the context of anomaly detection to isolate potential anomalies. Since the compression capability learned on a given sample doesn't typically generalize to other samples, the tails of the loss distribution could be enriched by new kinds of events, different than those used to train the model. In the specific case considered in this study, the tail of the loss distribution for an AE trained on SM data might be enriched with BSM events.",
            "paragraph_rank": 56,
            "section_rank": 12
        },
        {
            "section": "Autoencoders",
            "text": "In this work we focus on VAEs [11]. For each event, a plain AE predicts an encoded point in the latent space and a decoded point in the original space. In other words, AEs are point-estimate algorithms. VAEs, instead, associate to each input event an estimated probability distributions in the latent space and in the original space. Doing so, VAEs provide both a best-point estimate and an estimate of the associated statistical noise. Besides this conceptual difference, VAEs have been shown to provide competitive performances for novelty [29] and anomaly [12] detection.",
            "paragraph_rank": 57,
            "section_rank": 12,
            "ref_spans": [
                {
                    "type": "bibr",
                    "ref_id": "b10",
                    "start": 30,
                    "text": "[11]",
                    "end": 34
                },
                {
                    "type": "bibr",
                    "ref_id": "b29",
                    "start": 542,
                    "text": "[29]",
                    "end": 546
                },
                {
                    "type": "bibr",
                    "ref_id": "b11",
                    "start": 559,
                    "text": "[12]",
                    "end": 563
                }
            ]
        },
        {
            "section": "Autoencoders",
            "text": "We consider the VAE architecture shown in figure 3, characterized by a fourdimensional latent space. Each latent dimension is associated to a Gaussian pdf and its two degrees of freedom (mean \u00b5 z and RMS \u03c3 z ). The input layer consists of 21 nodes, corresponding to the 21 HLF quantities described in section 3. This layer is connected to the latent space through a stack of two fully connected layers, each consisting of 50 nodes with ReLU activation functions. Two four-node layers are fully connected to the second 50-node layer. Linear activation functions are used for the first of these four-node layers, interpreted as the set of four \u00b5 z of the four-dimension Gaussian pdf p(z). The nodes of the JHEP05(2019)036",
            "paragraph_rank": 58,
            "section_rank": 12
        },
        {
            "section": "Autoencoders",
            "text": "Encoder h2 (50)",
            "paragraph_rank": 59,
            "section_rank": 12
        },
        {
            "section": "Autoencoders",
            "text": "Decoder h1 (50)",
            "paragraph_rank": 60,
            "section_rank": 12
        },
        {
            "section": "Autoencoders",
            "text": "Decoder h2 (50) ",
            "paragraph_rank": 61,
            "section_rank": 12
        },
        {
            "text": "JHEP05(2019)036",
            "section_rank": 13
        },
        {
            "section": "JHEP05(2019)036",
            "text": "second layer are activated by the functions:",
            "paragraph_rank": 62,
            "section_rank": 13
        },
        {
            "section": "JHEP05(2019)036",
            "text": "This activation allows to improve the training stability, being strictly positive defined, non linear, and with no exponentially growing term (which might have created instabilities in the early epochs of the training). The four nodes of this layer are interpreted as the \u03c3 z parameters of p(z). After several trials, the dimension of the latent space has been set to 4 in order to keep a good training stability without impacting the VAE performances. The decoding step originates from a point in the latent space, sampled according to the predicted pdf (green oval in figure 3). The coordinates of this point in the latent space are fed into a sequence of two hidden dense layers, each consisting of 50 neurons with ReLU activation functions. The last of these layers is connected to three dense layers of 21, 17, and 10 neurons, activated by linear, p-ISRLu and clipped-tanh functions, respectively. The clipped-tanh function if written as:",
            "paragraph_rank": 63,
            "section_rank": 13,
            "ref_spans": [
                {
                    "type": "figure",
                    "ref_id": "fig_2",
                    "start": 570,
                    "text": "figure 3",
                    "end": 578
                }
            ]
        },
        {
            "section": "JHEP05(2019)036",
            "text": "Given the latent-space representation, the 48 output nodes represent the parameters of the pdfs describing the input HLF probability, i.e., the \u03b1 parameters of eq. (4.5).",
            "paragraph_rank": 64,
            "section_rank": 13
        },
        {
            "section": "JHEP05(2019)036",
            "text": "The total VAE loss function Loss Tot is a weighted sum of two pieces [35]: a term related to the reconstruction likelihood (Loss reco ) and the Kullback-Leibler divergence (D KL ) between the latent space pdf and the prior:",
            "paragraph_rank": 65,
            "section_rank": 13,
            "ref_spans": [
                {
                    "type": "bibr",
                    "ref_id": "b35",
                    "start": 69,
                    "text": "[35]",
                    "end": 73
                }
            ]
        },
        {
            "section": "JHEP05(2019)036",
            "text": "where \u03b2 is a free parameter. We fix \u03b2 = 0.3, for which we obtained good reconstruction performances. 4 The prior p(z) chosen for the latent space is a four-dimension Gaussian with a diagonal covariance matrix. The means (\u00b5 P ) and the diagonal terms of the covariance matrix (\u03c3 P ) are free parameters of the algorithm and are optimized during the backpropagation. The Kullback-Leibler divergence between two Gaussian distributions has an analytic form. Hence, for each batch, D KL can be expressed as:",
            "paragraph_rank": 66,
            "section_rank": 13,
            "ref_spans": [
                {
                    "type": "bibr",
                    "ref_id": "b3",
                    "start": 101,
                    "text": "4",
                    "end": 102
                }
            ]
        },
        {
            "section": "JHEP05(2019)036",
            "text": "where k is the batch size, i runs over the samples and j over the latent space dimensions. Similarly, Loss reco is the average negative-log-likelihood of the inputs given the predicted \u03b1 values: ",
            "paragraph_rank": 67,
            "section_rank": 13
        },
        {
            "text": "JHEP05(2019)036",
            "section_rank": 14
        },
        {
            "section": "JHEP05(2019)036",
            "text": "In the equation, j runs over the input space dimensions, f j is the functional form chose to describe the pdf of the j-th input variable and \u03b1 i,j m are the parameter of the function. Different functional forms have been chosen for f j , to properly describe different classes of HLF distributions:",
            "paragraph_rank": 68,
            "section_rank": 14
        },
        {
            "section": "JHEP05(2019)036",
            "text": "e , p T , ChPFIso, NeuPFIso and GammaPFIso:",
            "paragraph_rank": 69,
            "section_rank": 14
        },
        {
            "section": "JHEP05(2019)036",
            "text": "\u2022 Gaussian: used for p miss",
            "paragraph_rank": 70,
            "section_rank": 14
        },
        {
            "text": "T,",
            "section_rank": 15
        },
        {
            "section": "T,",
            "text": "and p miss T,\u22a5 :",
            "paragraph_rank": 71,
            "section_rank": 15
        },
        {
            "section": "T,",
            "text": "(4.7)",
            "paragraph_rank": 72,
            "section_rank": 15
        },
        {
            "section": "T,",
            "text": "\u2022 Truncated Gaussian: a Gaussian function truncated for negative values and normalized to unit area for X > 0. Used to model M T :",
            "paragraph_rank": 73,
            "section_rank": 15
        },
        {
            "section": "T,",
            "text": "\u2022 Discrete truncated Gaussian: like the truncated Gaussian, but normalized to be evaluated on integers (i.e. \u221e n=0 P (n) = 1). This function is used to describe N \u00b5 , N e , N b and N J . It is written as:",
            "paragraph_rank": 74,
            "section_rank": 15
        },
        {
            "section": "T,",
            "text": "where the normalization factor N is set to:",
            "paragraph_rank": 75,
            "section_rank": 15
        },
        {
            "section": "T,",
            "text": "\u2022 Binomial : used for (isEle) and lepton charge:",
            "paragraph_rank": 76,
            "section_rank": 15
        },
        {
            "section": "T,",
            "text": "where m and l are the two possible values of the variable (0 or 1 for (isEle) and -1 or 1 for lepton charge) and p = C tanh (\u03b1 1 )",
            "paragraph_rank": 77,
            "section_rank": 15
        },
        {
            "section": "T,",
            "text": "\u2022 Poisson: used for charged-particle and neutral-hadron multiplicities:",
            "paragraph_rank": 78,
            "section_rank": 15
        },
        {
            "section": "T,",
            "text": "where \u00b5 = p-ISRLu(\u03b1 1 ). These custom functions provide an improved performance with respect to the standard choice of an MSE loss. When using the MSE loss, one is implicitly writing the likelihood of the input quantities as a product of Gaussian functions with equal variance. This choice is clearly a poor description of the input distributions at hand in this application and it results in a poor representation of the cores and the tails of the input distributions. Instead, the use of these tailored functions allows to correctly describe the distribution cores and to improve the description of the tails.",
            "paragraph_rank": 79,
            "section_rank": 15
        },
        {
            "text": "JHEP05(2019)036",
            "section_rank": 16
        },
        {
            "section": "JHEP05(2019)036",
            "text": "We point out that the final performance depends on the choice of the p(x-z) functional form (i.e., on the modeled dependence of the observed features on the latent variables) and the p(z) prior function. The former was tuned looking at the distributions for SM events. The latter is arbitrary. We explored techniques to optimize the choice of p(z), learning it from the data [36]. In this case, no practical advantage in terms of anomaly detection was observed. An improved choice of p(x-z) and the possibility of learning p(z) during the train could potentially further boost the performances of this algorithm and will be the subject of future studies with real LHC collision data.",
            "paragraph_rank": 80,
            "section_rank": 16,
            "ref_spans": [
                {
                    "type": "bibr",
                    "ref_id": "b36",
                    "start": 375,
                    "text": "[36]",
                    "end": 379
                }
            ]
        },
        {
            "section": "JHEP05(2019)036",
            "text": "The model shown in figure 3 is implemented in KERAS+TENSORFLOW [37,38], trained with the Adam optimizer [39] on a SM dataset of 3.45M events, equivalent to an integrated luminosity of \u223c 100 pb \u22121 . The SM validation dataset is made of 3.45M of statistically independent examples. Such a sample would be collected in about ten hours of continuous run, under the assumptions made in this study (see section 1). In training, we fix the batch size to 1000. We use early stopping with patience set to 20 and \u03b4 min = 0.005, and we progressively reduce the learning rate on plateau, with patience set to 8 and \u03b4 min = 0.01.  Table 2. Classification performance of the four BDT classifiers described in the text, each trained on one of the four BSM benchmark models. The two set of values correspond to the area under ROC curve (AUC), and to the true positive rate (TPR) for a SM false positive rate SM = 5.4\u202210 \u22126 , i.e., to \u223c 1000 SM events accepted every month.",
            "paragraph_rank": 81,
            "section_rank": 16,
            "ref_spans": [
                {
                    "type": "bibr",
                    "ref_id": "b37",
                    "start": 63,
                    "text": "[37,",
                    "end": 67
                },
                {
                    "type": "bibr",
                    "ref_id": "b38",
                    "start": 67,
                    "text": "38]",
                    "end": 70
                },
                {
                    "type": "bibr",
                    "ref_id": "b39",
                    "start": 104,
                    "text": "[39]",
                    "end": 108
                },
                {
                    "type": "table",
                    "start": 618,
                    "text": "Table 2",
                    "end": 625
                }
            ]
        },
        {
            "section": "JHEP05(2019)036",
            "text": "the distributions are not well described on the tails. These discrepancies don't have a sizable impact on the anomaly-detection strategy, as shown in section. 5. Nevertheless, alternative architectures were tested, in order to reduce these discrepancies. For instance, we increased or decreased the dimensionality of the latent space, we changed the value of \u03b2 in eq. (43), we changed the number of neurons in the hidden layers, tried the RMSprop optimizer, and used plain Gaussian functions to describe the 21 input features. Some of these choices improved the encoding-decoding capability of the VAE, with up to a 10% decrease of the loss function at the end of the training. On the other hand, none of these alternative models provided a sizable improvement in the anomaly-detection performance. For simplicity, we decided to limit our study to the architecture in figure 3 and dropped these alternative models.",
            "paragraph_rank": 82,
            "section_rank": 16,
            "ref_spans": [
                {
                    "ref_id": "formula_17",
                    "start": 368,
                    "text": "(4",
                    "end": 370
                }
            ]
        },
        {
            "text": "Supervised classifiers",
            "section_rank": 17
        },
        {
            "section": "Supervised classifiers",
            "text": "For each of the four BSM benchmark models, we train a fully-supervised classifier, based on a Boosted Decision Tree (BDT). Each BDT receives as input the same 21 features used by the VAE and is trained on a labeled dataset consisting of the SM cocktail (the background) and one of the four BSM benchmark models (the signal). The implementation is done through the Gradient Boosted Classifier of the scikit-learn library [40]. The algorithm was tuned with up to 150 estimators, minimum samples per leaf and maximum depth equal to 3, a learning rate of 0.1, and a tolerance of 10 \u22124 on the validation loss function (choose to be the default deviance). Each BDT, tailored to a specific BSM model, is trained on 3.45M SM events and about 0.5M BSM events, consistently up-weighted in order to match the size of the SM sample during the training. We show in table 2 and in figure 6 the classification performance of the four supervised BDTs, which set a qualitative upper limit for VAE's results. Overall, the four models can be discriminated with good accuracy, with some loss of performance for those models sharing similarities with specific SM processes (e.g., h 0 \u2192 \u03c4 \u03c4 exhibiting single-and doublelepton topology with missing transverse energy, typical of tt events). In the table, we also quote the true-positive rate (TPR) for each BSM model corresponding to a working point of SM false positive rate SM = 5.4 \u2022 10 \u22126 , corresponding to an average of \u223c 1000 SM events accepted every month.",
            "paragraph_rank": 83,
            "section_rank": 17,
            "ref_spans": [
                {
                    "type": "bibr",
                    "ref_id": "b40",
                    "start": 420,
                    "text": "[40]",
                    "end": 424
                }
            ]
        },
        {
            "section": "Supervised classifiers",
            "text": "In addition to BDTs, we experimented with fully-connected deep neural networks (DNNs) with two hidden layers. Despite trying different architectures, we didn't find a  configuration in which the DNN classifiers could outperform the BDTs. This is due to the fact that, given the limited complexity of the problem at hand, a simple BDT can extract the maximum discrimination power from the 21 inputs. The limiting factor preventing to reach larger auc values is not to be found in the model complexity but in the discriminating power of the 21 input features. Not being tailored on the benchmark BSM scenarios, these features don't carry all the needed information for an optimal signal-to-background separation. While certainly one could obtain a better performance with more tailored classifiers, the purpose of this exercise was to provide a fair comparison for the VAE. In view of these considerations, we decided to use the BDTs as reference supervised classifiers.",
            "paragraph_rank": 84,
            "section_rank": 17
        },
        {
            "text": "Results with VAE",
            "section_rank": 18
        },
        {
            "section": "Results with VAE",
            "text": "An event is classified as anomalous whenever the associated loss, computed from the VAE output, is above a given threshold. Since no BSM signal has been observed by LHC experiments so far, it is reasonable to expect that a new-physics signal, if any, would be characterized by a low production cross section and/or features very similar to those of a SM process. In view of this, we decided to use a tight threshold value, in order to reduce as much as possible any SM contribution. Figure 7 shows the distribution of the Loss reco and D KL loss components for the validation dataset. In both plots, the vertical line represents a lower threshold such that a fraction SM = 5.4 \u2022 10 \u22126 of the SM events would be retained. This threshold value would JHEP05(2019)036 result in \u223c 1000 SM events to be selected every month, i.e., a daily rate of \u223c 33 SM events, as illustrated in table 3. The acceptance rate is calculated assuming the LHC running conditions listed in section 1. Table 3 also reports the by-process VAE selection efficiency and the relative background composition of the selected sample. Figure 7 also shows the Loss reco and D KL distributions for the four benchmark BSM models. We observe that the discrimination power, loosely quantified by the integral of these distributions above threshold, is better for Loss reco than D KL and that the impact of the D KL term on Loss Tot is negligible. Anomalies are then defined as events laying on the right tail of the expected Loss reco distribution. Due to limited statistics in the training sample, the p-value corresponding to the chosen threshold value could be uncalibrated. This could result in a deviation of the observed rate from the expected value, an issue that one can address tuning the threshold. On the other hand, an uncalibrated p-value would also impact the number of collected BSM events, and the time needed to collect an appreciable amount of these events.",
            "paragraph_rank": 85,
            "section_rank": 18,
            "ref_spans": [
                {
                    "type": "figure",
                    "ref_id": "fig_8",
                    "start": 483,
                    "text": "Figure 7",
                    "end": 491
                },
                {
                    "type": "table",
                    "start": 975,
                    "text": "Table 3",
                    "end": 982
                },
                {
                    "type": "figure",
                    "ref_id": "fig_8",
                    "start": 1100,
                    "text": "Figure 7",
                    "end": 1108
                }
            ]
        },
        {
            "section": "Results with VAE",
            "text": "Once the Loss reco selection is applied, the anomalous events don't cluster on the tails of the distributions of the input features. Instead, they tend to cover the full featuredefinition range. This is an indication of the fact that the VAE does more than a simple selection of feature outliers, which is what is done by traditional single-lepton trigger or by dedicated cross triggers (e.g., triggers that select events with soft leptons and large missing transverse energy, S T , etc.). This is shown in figure 8 for SM events. A similar conclusion can be obtained from figure 9, showing the distribution of the 21 input HLF quantities for the A \u2192 4 benchmark model, before and after applying the threshold requirement on the VAE loss. All data Selected anomalies Figure 8. Comparison between the input distribution for the 21 HLF of the validation dataset (blue histograms) and the distribution of the SM outlier events selected from the same sample by applying the Loss reco threshold (red dots). The outlier events cover a large portion of the HLF definition range and don't cluster on the tails. All data Selected anomalies Figure 9. Comparison between the distribution of the 21 HLF distribution for A \u2192 4 full dataset (blue) and A \u2192 4 events selected by applying the Loss reco threshold (red). The selected events are not trivially sampled from the tail.  Table 3. By-process acceptance rate for the anomaly detection algorithm described in the text, computed applying the threshold on Loss reco shown in figure 7. The threshold is tuned such that a fraction of about SM = 5.4 \u2022 10 \u22126 of SM events would be accepted, corresponding to \u223c 1000 SM events/month, assuming the LHC running conditions listed in section 1. The sample composition refers to the subset of SM events accepted by the anomaly detection algorithm. All quoted uncertainties refer to 95% CL regions. Figure 10. Left: ROC curves for the VAE trained only on SM events (solid), compared to the corresponding curves for the four supervised BDT models (dashed) described in section 4.2. Right: normalized p-value distribution distribution for the SM cocktail events and the four BSM benchmark processes.",
            "paragraph_rank": 86,
            "section_rank": 18,
            "ref_spans": [
                {
                    "type": "figure",
                    "start": 767,
                    "text": "Figure 8",
                    "end": 775
                },
                {
                    "type": "figure",
                    "start": 1131,
                    "text": "Figure 9",
                    "end": 1139
                },
                {
                    "type": "table",
                    "start": 1365,
                    "text": "Table 3",
                    "end": 1372
                },
                {
                    "type": "figure",
                    "ref_id": "fig_8",
                    "start": 1514,
                    "text": "figure 7",
                    "end": 1522
                },
                {
                    "type": "figure",
                    "ref_id": "fig_0",
                    "start": 1876,
                    "text": "Figure 10",
                    "end": 1885
                }
            ]
        },
        {
            "text": "JHEP05(2019)036",
            "section_rank": 19
        },
        {
            "section": "JHEP05(2019)036",
            "text": "outperform the VAE. On the other hand, the VAE can probe at the same time the four scenarios with comparable performances. This is a consequence of the trade off between precision and model independence and an illustration of the complementarity between the approach presented in this work and traditional supervised techniques. The right plot in figure 10 shows the one-sided p-value computed from the cocktail SM distribution, both for the SM events themselves (flat by construction) and for the four BSM processes. As the plot shows, BSM processes tend to concentrate at small p-values, which allows their identification as anomalies. correspond to 100 BSM events selected in a month (assuming an integrated luminosity of 5 fb \u22121 ). Similarly, we quote the cross section that would result in a signal-to-background ratio of 1/3 on the sample of events selected by the VAE. The VAE can probe the four models down to small cross section values, comparable to the existing exclusion bounds for these mass ranges. As an example, ref. [41] excludes a LQ \u2192 \u03c4 b with a mass of 150 GeV and production cross section larger than \u223c 10 pb, using 4.8 fb \u22121 at a center-ofmass energy of 7 TeV, while most recent searches [42] cannot cover such a low mass value, due to trigger limitations. Unlike a traditional trigger strategy, a VAE-based selection is mainly intended to select a high-purity sample of interesting event, at the cost of a typically small selection efficiency. To demonstrate this point, we consider a sample selected with the VAE and one selected using a typical inclusive single lepton trigger (SLT), consisting on a tighter selection than the one described in section 3. In particular, we require p T > 27 GeV and ISO < 0.25. We consider the signal-over-background ratio (SBR) for the VAE's threshold selection and the SLT. While these quantities depend on the production cross section of the considered BSM model, their ratio",
            "paragraph_rank": 87,
            "section_rank": 19,
            "ref_spans": [
                {
                    "type": "figure",
                    "ref_id": "fig_0",
                    "start": 347,
                    "text": "figure 10",
                    "end": 356
                },
                {
                    "type": "bibr",
                    "ref_id": "b41",
                    "start": 1033,
                    "text": "[41]",
                    "end": 1037
                },
                {
                    "type": "bibr",
                    "ref_id": "b42",
                    "start": 1210,
                    "text": "[42]",
                    "end": 1214
                }
            ]
        },
        {
            "section": "JHEP05(2019)036",
            "text": "is only a function of the selection efficiency for the SLT ( SLT ) and the for the VAE VAE for SM and BSM events.  Table 5. Selection efficiencies for a typical single lepton trigger (SLT) and the proposed VAE selection, shown for the four benchmark BSM models and for the SM cocktail. The last row quotes the corresponding BSM-to-SM ratio of signal-over-background ratios (SBRs), quantifying the purity of the selected sample.",
            "paragraph_rank": 88,
            "section_rank": 19,
            "ref_spans": [
                {
                    "type": "table",
                    "ref_id": "tab_3",
                    "start": 115,
                    "text": "Table 5",
                    "end": 122
                }
            ]
        },
        {
            "section": "JHEP05(2019)036",
            "text": "experiment deployed online a set of algorithms (collectively called hot line) to select potentially interesting new-physics candidates. At that time, anomalies were characterized as events with high-p T particles or high particle multiplicities, in line with the kind of early-discovery new physics scenarios considered at that time. The events populating the hot-line stream were immediately processed at the CERN computing center (as opposed to traditional physics streams, that are processed after 48 hours). The hot-line algorithms were tuned to collect O(10) events per day, which were then visually inspected by experts.",
            "paragraph_rank": 89,
            "section_rank": 19
        },
        {
            "section": "JHEP05(2019)036",
            "text": "While the focus of the work presented in this paper is not an early discovery, the spirit of the application we propose would be similar: a set of VAEs deployed online would select a limited number of events every day. These events would be collected in a dedicated dataset and further analyzed. The analysis technique could go from visual inspection of the collisions to detailed studies of reconstructed objects, up to some kind of model-independent analysis of the collected dataset, e.g. a deep-learning implementation of a model-independent hypothesis testing [16] directly on the loss distribution (provided a reliable sample of background-only data).",
            "paragraph_rank": 90,
            "section_rank": 19,
            "ref_spans": [
                {
                    "type": "bibr",
                    "ref_id": "b16",
                    "start": 565,
                    "text": "[16]",
                    "end": 569
                }
            ]
        },
        {
            "section": "JHEP05(2019)036",
            "text": "While a pure SM sample to train VAEs could only be obtained from a MC simulation, the presence of outlier contamination in the training sample has typically a tiny impact on performance. One could then imagine to train the VAE models on so-far collected data and use them on the events entering the HLT system. Such a training could happen offline on a dedicated dataset, e.g., deploying triggers randomly selecting events entering the last stage of the trigger system. The training could even happen online, assuming the availability of sufficient computing resources. As it happens with normal triggers, at the very beginning one would use some MC sample or some control sample from previously collected data to estimate the threshold corresponding to the target SM rate. Then, as it happens normally during HLT operations, the threshold will have to be monitored on real data and adjusted if needed.",
            "paragraph_rank": 91,
            "section_rank": 19
        },
        {
            "section": "JHEP05(2019)036",
            "text": "To demonstrate the feasibility of a train-on-data strategy, we enrich the dataset used in section 4 with a signal contamination of A \u2192 4 events. As a starting point, the amount of injected signal is tuned to a luminosity of 100 pb \u22121 and a cross section of 7.1 pb, corresponding to the value at which the VAE in section 4 would select 100 A \u2192 4 events in one month. This results into about 700 A \u2192 4 events added to the training sample. The VAE is trained following the procedure outlined in section 4 and its performance is JHEP05(2019)036 compared to that obtained on a signal-free dataset of the same size. The comparison of the ROC curves for the two models is shown in figure 11. In the same figure, we show similar results, derived injecting a \u00d710 and \u00d7100 signal contamination. A performance degradation is observed once the signal cross section is set to 710 pb (i.e., 100 times larger than the sensitivity value found in section 4). At that point, the contamination is so large that the signal becomes as abundant as tt events and would have easily detectable consequences. For comparison, at a production cross section of 27 pb a third of the events selected by the VAE in section 4 would come from A \u2192 4 production (see table 4). Such a large yield would still have negligible consequences on the training quality. This test shows that a robust anomaly-detecting VAE could be trained directly on data, even in presence of previously undetected (e.g., at Tevatron, 7 TeV and 8-TeV LHC) BSM signals.",
            "paragraph_rank": 92,
            "section_rank": 19,
            "ref_spans": [
                {
                    "type": "figure",
                    "ref_id": "fig_0",
                    "start": 674,
                    "text": "figure 11",
                    "end": 683
                },
                {
                    "type": "table",
                    "ref_id": "tab_2",
                    "start": 1231,
                    "text": "table 4",
                    "end": 1238
                }
            ]
        },
        {
            "section": "JHEP05(2019)036",
            "text": "The possibility of training the VAE on data would substantially simplify the implementation of the strategy proposed in this work, since any possible systematic bias in the data would be automatically taken into account during the training process. In addition, it would make the procedure robust against other systematic effects (e.g., energy scale, efficiency, etc.) that would affect a MC-based training.",
            "paragraph_rank": 93,
            "section_rank": 19
        },
        {
            "text": "Conclusions and outlook",
            "section_rank": 20
        },
        {
            "section": "Conclusions and outlook",
            "text": "We present a strategy to isolate potential BSM events produced by the LHC, using variational autoencoders trained on a reference SM sample. Such an algorithm could be used in the trigger system of general-purpose LHC experiments to identify recurrent anomalies,",
            "paragraph_rank": 94,
            "section_rank": 20
        },
        {
            "text": "JHEP05(2019)036",
            "section_rank": 21
        },
        {
            "section": "JHEP05(2019)036",
            "text": "which might otherwise escape observation (e.g., being filtered out by a typical trigger selection). Taking as an example a single-lepton data stream, we show how such an algorithm could select datasets enriched with events originating from challenging BSM models. We also discuss how the algorithm could be trained directly on data, with no sizable performance loss, more robustness against systematic uncertainties, and a big simplification of the training and deployment procedure.",
            "paragraph_rank": 95,
            "section_rank": 21
        },
        {
            "section": "JHEP05(2019)036",
            "text": "The main purpose of such an application is not to enhance the signal selection efficiency for BSM models. Indeed, this application is tuned to provide a high-purity sample of potentially interesting events. We showed that events produced by not-yet-excluded BSM models with cross sections in the range of O (10) to O(100) pb could be isolated in a \u223c 30% pure sample of \u223c 43 events selected per day. The price to pay to reach such a purity is a relatively small signal efficiency and a strong bias in the dataset definition, which makes these events marginal and difficult to use in a traditional data-driven and supervised search for new physics.",
            "paragraph_rank": 96,
            "section_rank": 21,
            "ref_spans": [
                {
                    "type": "bibr",
                    "ref_id": "b9",
                    "start": 307,
                    "text": "(10)",
                    "end": 311
                }
            ]
        },
        {
            "section": "JHEP05(2019)036",
            "text": "The final outcome of this application would be a list of anomalous events, that the experimental collaborations could further scrutinize and even release as a catalog, similarly to what is typically done in other scientific domains. Repeated patterns in these events could motivate new scenarios for beyond-the-standard-model physics and inspire new searches, to be performed on future data with traditional supervised approaches.",
            "paragraph_rank": 97,
            "section_rank": 21
        },
        {
            "section": "JHEP05(2019)036",
            "text": "We stress the fact that the power of the proposed approach is in its generality and not in its sensitivity to a particular BSM scenario. We show that a simple BDT could give a better discrimination capability for a given BSM hypothesis. On the other hand, such a supervised algorithm would not generalize to other BSM scenarios. The VAE, instead, comes with little model dependence and therefore generalizes to unforeseen BSM models. On the other hand, the VAE cannot guarantee an optimal performance in any scenario. As typical of autoencoders used for anomaly detection, our VAE model is trained to learn the SM background at best, but there is no guarantee that the best SM-learning model will be the best anomaly detection algorithm. By definition, the anomaly detection capability of the algorithm does not enter the loss function, as well as, by construction, no signal event enters the training sample. This is the price to pay when trading discrimination power for model independence.",
            "paragraph_rank": 98,
            "section_rank": 21
        },
        {
            "section": "JHEP05(2019)036",
            "text": "We believe that such an application could help extending the physics reach of the current and next stages of the CERN LHC. The proposed strategy is demonstrated for a single-lepton data stream coming from a typical L1 selection. On the other hand, this approach could be generalized to any other data stream coming from any L1 selection, so that the full \u223c 100 Hz rate entering the HLT system of ATLAS or CMS could be scrutinized. While the L1 selection still represents a potentially dangerous bias, an algorithm running in the HLT could access 100 times more events than the \u223c 1 kHz stream typically available for offline studies. Moreover, thanks to progresses in the deployment of deep neural networks on FPGA boards [43], it is conceivable that VAEs for anomaly detection could be also deployed in the L1 trigger systems in a near future. In this way, the VAE would access the full L1 input data stream. Figure 12. Left: distribution of the AE loss (MSE) for the validation dataset. The distribution for the SM processes and the four benchmark BSM models are shown. Right: ROC curves for the AE (dashed lines) trained only on SM mix, compared to the corresponding VAE curves from figure 10 (solid). The vertical dotted line represents the SM = 5.4 \u2022 10 \u22126 threshold considered in this study.",
            "paragraph_rank": 99,
            "section_rank": 21,
            "ref_spans": [
                {
                    "type": "bibr",
                    "ref_id": "b43",
                    "start": 721,
                    "text": "[43]",
                    "end": 725
                },
                {
                    "type": "figure",
                    "ref_id": "fig_0",
                    "start": 909,
                    "text": "Figure 12",
                    "end": 918
                }
            ]
        },
        {
            "text": "JHEP05(2019)036",
            "section_rank": 22
        },
        {
            "text": "JHEP05(2019)036",
            "section_rank": 23
        },
        {
            "section": "JHEP05(2019)036",
            "text": "event rate. On the other hand, the VAE usually outperforms a plain AE for the rate considered in this study ( SM = 5.4 \u2022 10 \u22126 ). With the exception of the h \u00b1 \u2192 \u03c4 \u03bd model (for which the AE provides a 30% larger efficiency than the VAE), the VAE provides larger efficiency on the BSM models, with improvements as large as two orders of magnitude (for the A \u2192 4 model).",
            "paragraph_rank": 100,
            "section_rank": 23
        },
        {
            "section": "JHEP05(2019)036",
            "text": "Open Access. This article is distributed under the terms of the Creative Commons Attribution License (CC-BY 4.0), which permits any use, distribution and reproduction in any medium, provided the original author(s) and source are credited.",
            "paragraph_rank": 101,
            "section_rank": 23
        },
        {
            "text": "Figure 1 .",
            "section_rank": 24
        },
        {
            "section": "Figure 1 .",
            "text": "Figure 1. Distribution of the HLF quantities for the four considered SM processes.",
            "paragraph_rank": 102,
            "section_rank": 24
        },
        {
            "text": "Figure 2 .",
            "section_rank": 25
        },
        {
            "section": "Figure 2 .",
            "text": "Figure 2. Distribution of the HLF quantities for the four considered BSM benchmark models.",
            "paragraph_rank": 103,
            "section_rank": 25
        },
        {
            "text": "Figure 3 .",
            "section_rank": 26
        },
        {
            "section": "Figure 3 .",
            "text": "Figure 3. Schematic representation of the VAE architecture presented in the text. The size of each layer is indicated by the value within brackets. The blue rectangle X represents the input layer, which is connected to a stack of two consecutive fully connected layers (black boxes). The last of the two black box is connected to two layers with four nodes each (red boxes), representing the \u00b5 z and \u03c3 z parameters of the encoder pdf p(z|x). The green oval represents the sampling operator, which returns a set of values for the 4-dimensional latent variables z. These values are fed into the decoder, consisting of two consecutive hidden layers of 50 nodes each (black boxes). The last of the decoder hidden layer is connected to the three output layers, whose nodes correspond to the parameters of the predicted distribution in the initial 21-dimension space. The pink ovals represent the computation of the two parts of the loss function: the KL loss and the reconstruction loss (see text). The computation of the KL requires 8 additional learnable parameters (\u00b5 p and \u03c3 p , represented by the orange boxes on the top-left part of the figure), corresponding to the means and RMS of the four-dimensional Gaussian prior p(z). The total loss in computed as described by the formula in the bottom-left black box (see eq. (4.3)).",
            "paragraph_rank": 104,
            "section_rank": 26
        },
        {
            "text": "Figure 4 .",
            "section_rank": 27
        },
        {
            "section": "Figure 4 .",
            "text": "Figure 4. Training history for VAE. Total loss, reconstruction negative-log-likelihood (Loss reoc ) and KL divergence (D KL ) are shown separately for training and validation set though all the training epochs.",
            "paragraph_rank": 105,
            "section_rank": 27
        },
        {
            "text": "The model's training history is shown in figure 4.Figure 5shows the comparison of the input and output distributions for the 21 HLF quantities in the validation dataset. A general good agreement is observed on the bulk of the distributions, even if some of",
            "paragraph_rank": 106,
            "section_rank": 28
        },
        {
            "text": "Figure 5 .",
            "section_rank": 29
        },
        {
            "section": "Figure 5 .",
            "text": "Figure 5. Comparison of input (blue) and output (red) probability distributions for the HLF quantities in the validation sample. The input distributions are normalized to unity. The output distributions are obtained summing over the predicted pdf of each event, normalized to the inverse of the total number of events (so that the total sum is normalized to unity).",
            "paragraph_rank": 107,
            "section_rank": 29
        },
        {
            "text": "Figure 6 .",
            "section_rank": 30
        },
        {
            "section": "Figure 6 .",
            "text": "Figure 6. ROC curves for the fully-supervised BDT classifiers, optimized to separate each of the four BSM benchmark models from the SM cocktail dataset.",
            "paragraph_rank": 108,
            "section_rank": 30
        },
        {
            "text": "Figure 7 .",
            "section_rank": 31
        },
        {
            "section": "Figure 7 .",
            "text": "Figure 7. Distribution of the VAE's loss components, Loss reco (left) and D KL (right), for the validation dataset. For comparison, the corresponding distribution for the four benchmark BSM models are shown. The vertical line represents a lower threshold such that 5.4 \u2022 10 \u22126 of the SM events would be retained, equivalent to \u223c 1000 expected SM events per month.",
            "paragraph_rank": 109,
            "section_rank": 31
        },
        {
            "text": "The left plot infigure 10shows the ROC curves obtained from the Loss reco distribution of the four BSM benchmark models and the SM cocktail, compared to the corresponding BDT curves of section 4.2. As expected, the results obtained with the supervised BDTs",
            "paragraph_rank": 110,
            "section_rank": 32
        },
        {
            "text": "Figure 11 .",
            "section_rank": 33
        },
        {
            "section": "Figure 11 .",
            "text": "Figure 11. ROC curves for the VAE trained on SM contaminated with and without A \u2192 4\u00b5 contamination. Different levels of contamination are reported corresponding to 0.02% (\u03c3 = 7.15 pb -equal to the estimated one to have 100 events per month), 0.19% (\u03c3 = 71.5 pb) and 1.89% (\u03c3 = 715 pb) of the training sample.",
            "paragraph_rank": 111,
            "section_rank": 33
        },
        {
            "text": "Table 4",
            "section_rank": 34
        },
        {
            "section": "Table 4",
            "text": "summarizes the VAE's performance on the four BSM benchmark models. Together with the selection efficiency corresponding to SM = 5.4 \u2022 10 \u22126 , the table reports the effective cross section (cross section after applying the trigger requirements) that would All quoted efficiencies are computed fixing the VAE loss threshold SM = 5.4 \u2022 10 \u22126 .",
            "paragraph_rank": 112,
            "section_rank": 34
        },
        {
            "text": "Table 5",
            "section_rank": 35
        },
        {
            "section": "Table 5",
            "text": "shows how the SBR reached by the VAE is about two order of magnitude larger than what a traditional inclusive SLT could reach.6 How to deploy a VAE for BSM detectionThe work presented in this paper suggests the possibility of deploying a VAE as a trigger algorithms associated to dedicated data streams. This trigger would isolate anomalous events, similarly to what was done by the CMS experiment at the beginning of the first LHC run. With early new physics signal being a possibility at the LHC start, the CMS LQ \u2192 b\u03c4 h 0 \u2192 \u03c4 \u03c4 h \u00b1 \u2192 \u03c4 \u03bdVAE 5.3 \u2022 10 \u22126 2.8 \u2022 10 \u22123 6.7 \u2022 10 \u22124 3.6 \u2022 10 \u22124 1.2 \u2022 10 \u22123",
            "paragraph_rank": 113,
            "section_rank": 35
        },
        {
            "section": "Table 5",
            "text": "A description of the ATLAS and CMS trigger systems can be found in ref.[9] and ref.[10], respectively.In this study, we take the data-taking strategy of these two experiments as a reference. On the other hand, the proposed strategy could be adapted to other use cases.",
            "paragraph_rank": 114,
            "section_rank": 35,
            "ref_spans": [
                {
                    "type": "bibr",
                    "ref_id": "b8",
                    "start": 71,
                    "text": "[9]",
                    "end": 74
                },
                {
                    "type": "bibr",
                    "ref_id": "b9",
                    "start": 83,
                    "text": "[10]",
                    "end": 87
                }
            ]
        },
        {
            "section": "Table 5",
            "text": "Following ref.[35], we tried to increase the value of \u03b2 up to 4 without observing a substantial difference in performance.",
            "paragraph_rank": 115,
            "section_rank": 35,
            "ref_spans": [
                {
                    "type": "bibr",
                    "ref_id": "b35",
                    "start": 14,
                    "text": "[35]",
                    "end": 18
                }
            ]
        },
        {
            "text": "Acknowledgments",
            "section_rank": 37
        },
        {
            "section": "Acknowledgments",
            "text": "We thank D. Rezende for his precious suggestions, which motivated us to explore Variational Autoencoders for this work. This project has received funding from the European Research Council (ERC) under the European Union's Horizon 2020 research and innovation program (grant agreement n o 772369) and the United States Department of Energy, Office of High Energy Physics Research under Caltech Contract No. DE-SC0011925. This work was conducted at \"iBanks\", the AI GPU cluster at Caltech. We acknowledge NVIDIA, SuperMicro and the Kavli Foundation for their support of \"iBanks\".",
            "paragraph_rank": 116,
            "section_rank": 37
        },
        {
            "text": "A Comparison with auto-encoder",
            "section_rank": 39
        },
        {
            "section": "A Comparison with auto-encoder",
            "text": "For sake of completeness, we repeated the strategy presented in this work on a simple AE. The architecture was fixed to be as close as possible to that of the VAE introduced in section 4. The change from VAE to AE imply these two changes: the output layer has the same dimensionality of the input layer; the latent layer includes four neurons (as opposed to 8), corresponding to the four latent variables z (and not to the \u00b5 and \u03c3 parameters of the z distribution). An MSE loss function is used. The optimizer and callbacks used to trained the VAE are are used in this case. Figure 12 shows the loss function distribution and a comparison between the ROC curves of the VAE and AE. These distributions directly compare to the left plots of figures 7 and 10, since in that case only the reconstruction part of the loss was used. For convenience, the VAE ROC curves are also shown here, represented by the dashed lines. When considering the four BSM benchmark models presented in this work, the AE provides competitive performances, for some choice of the SM accepted-",
            "paragraph_rank": 117,
            "section_rank": 39,
            "ref_spans": [
                {
                    "type": "figure",
                    "start": 575,
                    "text": "Figure 12",
                    "end": 584
                }
            ]
        }
    ]
}